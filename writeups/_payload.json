[{"data":1,"prerenderedAt":1912},["Reactive",2],{"all-writeups":3},[4],{"_path":5,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"title":9,"description":8,"published":10,"slug":11,"body":12,"_type":1906,"_id":1907,"_source":1908,"_file":1909,"_stem":1910,"_extension":1911},"/writeups/tryhackme-agent-sudo","writeups",false,"","TryHackMe | Agent Sudo","2025/05/30","tryhackme-agent-sudo",{"type":13,"children":14,"toc":1887},"root",[15,23,36,43,48,108,205,210,258,403,412,418,425,430,436,441,449,454,467,497,553,565,570,633,641,685,693,698,732,799,804,809,815,821,833,838,843,851,857,862,870,923,991,996,1059,1064,1140,1148,1153,1207,1213,1246,1261,1346,1413,1423,1447,1530,1548,1572,1578,1596,1625,1641,1664,1724,1729,1782,1794,1799,1814,1820,1825,1831,1835,1841,1845,1851,1855,1861,1871,1877,1881],{"type":16,"tag":17,"props":18,"children":22},"element","img",{"src":19,"width":20,"heigh":21},"/writeups/tryhackme-agent-sudo/thumbnail.png","200px","200px/",[],{"type":16,"tag":24,"props":25,"children":26},"p",{},[27],{"type":16,"tag":28,"props":29,"children":33},"a",{"href":30,"rel":31},"https://tryhackme.com/room/agentsudoctf",[32],"nofollow",[34],{"type":35,"value":30},"text",{"type":16,"tag":37,"props":38,"children":40},"h2",{"id":39},"escaneo",[41],{"type":35,"value":42},"Escaneo",{"type":16,"tag":24,"props":44,"children":45},{},[46],{"type":35,"value":47},"Escaneamos todos los puertos TCP de la maquina objetivo con Nmap.",{"type":16,"tag":49,"props":50,"children":54},"pre",{"className":51,"code":52,"language":53,"meta":8,"style":8},"language-bash shiki shiki-themes github-dark","sudo nmap -n -Pn -T4 10.10.195.209 -oN nmap.txt\n","bash",[55],{"type":16,"tag":56,"props":57,"children":58},"code",{"__ignoreMap":8},[59],{"type":16,"tag":60,"props":61,"children":64},"span",{"class":62,"line":63},"line",1,[65,71,77,83,88,93,98,103],{"type":16,"tag":60,"props":66,"children":68},{"style":67},"--shiki-default:#B392F0",[69],{"type":35,"value":70},"sudo",{"type":16,"tag":60,"props":72,"children":74},{"style":73},"--shiki-default:#9ECBFF",[75],{"type":35,"value":76}," nmap",{"type":16,"tag":60,"props":78,"children":80},{"style":79},"--shiki-default:#79B8FF",[81],{"type":35,"value":82}," -n",{"type":16,"tag":60,"props":84,"children":85},{"style":79},[86],{"type":35,"value":87}," -Pn",{"type":16,"tag":60,"props":89,"children":90},{"style":79},[91],{"type":35,"value":92}," -T4",{"type":16,"tag":60,"props":94,"children":95},{"style":79},[96],{"type":35,"value":97}," 10.10.195.209",{"type":16,"tag":60,"props":99,"children":100},{"style":79},[101],{"type":35,"value":102}," -oN",{"type":16,"tag":60,"props":104,"children":105},{"style":73},[106],{"type":35,"value":107}," nmap.txt\n",{"type":16,"tag":49,"props":109,"children":112},{"className":110,"code":111,"language":35,"meta":8,"style":8},"language-text shiki shiki-themes github-dark","sudo nmap -n -Pn -T4 10.10.195.209 -oN nmap.txt\n\n# Nmap 7.95 scan initiated Fri May 30 16:11:54 2025 as: /usr/lib/nmap/nmap -p- -n -Pn -T4 -oN nmap.txt 10.10.195.209\nNmap scan report for 10.10.195.209\nHost is up (0.27s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT   STATE SERVICE\n21/tcp open  ftp\n22/tcp open  ssh\n80/tcp open  http\n",[113],{"type":16,"tag":56,"props":114,"children":115},{"__ignoreMap":8},[116,123,133,142,151,160,169,178,187,196],{"type":16,"tag":60,"props":117,"children":118},{"class":62,"line":63},[119],{"type":16,"tag":60,"props":120,"children":121},{},[122],{"type":35,"value":52},{"type":16,"tag":60,"props":124,"children":126},{"class":62,"line":125},2,[127],{"type":16,"tag":60,"props":128,"children":130},{"emptyLinePlaceholder":129},true,[131],{"type":35,"value":132},"\n",{"type":16,"tag":60,"props":134,"children":136},{"class":62,"line":135},3,[137],{"type":16,"tag":60,"props":138,"children":139},{},[140],{"type":35,"value":141},"# Nmap 7.95 scan initiated Fri May 30 16:11:54 2025 as: /usr/lib/nmap/nmap -p- -n -Pn -T4 -oN nmap.txt 10.10.195.209\n",{"type":16,"tag":60,"props":143,"children":145},{"class":62,"line":144},4,[146],{"type":16,"tag":60,"props":147,"children":148},{},[149],{"type":35,"value":150},"Nmap scan report for 10.10.195.209\n",{"type":16,"tag":60,"props":152,"children":154},{"class":62,"line":153},5,[155],{"type":16,"tag":60,"props":156,"children":157},{},[158],{"type":35,"value":159},"Host is up (0.27s latency).\n",{"type":16,"tag":60,"props":161,"children":163},{"class":62,"line":162},6,[164],{"type":16,"tag":60,"props":165,"children":166},{},[167],{"type":35,"value":168},"Not shown: 65532 closed tcp ports (reset)\n",{"type":16,"tag":60,"props":170,"children":172},{"class":62,"line":171},7,[173],{"type":16,"tag":60,"props":174,"children":175},{},[176],{"type":35,"value":177},"PORT   STATE SERVICE\n",{"type":16,"tag":60,"props":179,"children":181},{"class":62,"line":180},8,[182],{"type":16,"tag":60,"props":183,"children":184},{},[185],{"type":35,"value":186},"21/tcp open  ftp\n",{"type":16,"tag":60,"props":188,"children":190},{"class":62,"line":189},9,[191],{"type":16,"tag":60,"props":192,"children":193},{},[194],{"type":35,"value":195},"22/tcp open  ssh\n",{"type":16,"tag":60,"props":197,"children":199},{"class":62,"line":198},10,[200],{"type":16,"tag":60,"props":201,"children":202},{},[203],{"type":35,"value":204},"80/tcp open  http\n",{"type":16,"tag":24,"props":206,"children":207},{},[208],{"type":35,"value":209},"Obtenemos informaci√≥n de los puertos abiertos.",{"type":16,"tag":49,"props":211,"children":213},{"className":51,"code":212,"language":53,"meta":8,"style":8},"sudo nmap -sCV -n -Pn -T4 10.10.195.209 -oN nmap-ports.txt\n",[214],{"type":16,"tag":56,"props":215,"children":216},{"__ignoreMap":8},[217],{"type":16,"tag":60,"props":218,"children":219},{"class":62,"line":63},[220,224,228,233,237,241,245,249,253],{"type":16,"tag":60,"props":221,"children":222},{"style":67},[223],{"type":35,"value":70},{"type":16,"tag":60,"props":225,"children":226},{"style":73},[227],{"type":35,"value":76},{"type":16,"tag":60,"props":229,"children":230},{"style":79},[231],{"type":35,"value":232}," -sCV",{"type":16,"tag":60,"props":234,"children":235},{"style":79},[236],{"type":35,"value":82},{"type":16,"tag":60,"props":238,"children":239},{"style":79},[240],{"type":35,"value":87},{"type":16,"tag":60,"props":242,"children":243},{"style":79},[244],{"type":35,"value":92},{"type":16,"tag":60,"props":246,"children":247},{"style":79},[248],{"type":35,"value":97},{"type":16,"tag":60,"props":250,"children":251},{"style":79},[252],{"type":35,"value":102},{"type":16,"tag":60,"props":254,"children":255},{"style":73},[256],{"type":35,"value":257}," nmap-ports.txt\n",{"type":16,"tag":49,"props":259,"children":261},{"className":110,"code":260,"language":35,"meta":8,"style":8},"sudo nmap -sCV -n -Pn -T4 10.10.195.209 -oN nmap-ports.txt\n\n# Nmap 7.95 scan initiated Fri May 30 16:25:00 2025 as: /usr/lib/nmap/nmap -sCV -p 21,22,80 -n -Pn -T4 -oN nmap-ports.txt 10.10.195.209\nNmap scan report for 10.10.195.209\nHost is up (0.27s latency).\n\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 (RSA)\n|   256 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea (ECDSA)\n|_  256 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 (ED25519)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-title: Annoucement\n|_http-server-header: Apache/2.4.29 (Ubuntu)\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n",[262],{"type":16,"tag":56,"props":263,"children":264},{"__ignoreMap":8},[265,272,279,287,294,301,308,316,324,332,340,349,358,367,376,385,394],{"type":16,"tag":60,"props":266,"children":267},{"class":62,"line":63},[268],{"type":16,"tag":60,"props":269,"children":270},{},[271],{"type":35,"value":212},{"type":16,"tag":60,"props":273,"children":274},{"class":62,"line":125},[275],{"type":16,"tag":60,"props":276,"children":277},{"emptyLinePlaceholder":129},[278],{"type":35,"value":132},{"type":16,"tag":60,"props":280,"children":281},{"class":62,"line":135},[282],{"type":16,"tag":60,"props":283,"children":284},{},[285],{"type":35,"value":286},"# Nmap 7.95 scan initiated Fri May 30 16:25:00 2025 as: /usr/lib/nmap/nmap -sCV -p 21,22,80 -n -Pn -T4 -oN nmap-ports.txt 10.10.195.209\n",{"type":16,"tag":60,"props":288,"children":289},{"class":62,"line":144},[290],{"type":16,"tag":60,"props":291,"children":292},{},[293],{"type":35,"value":150},{"type":16,"tag":60,"props":295,"children":296},{"class":62,"line":153},[297],{"type":16,"tag":60,"props":298,"children":299},{},[300],{"type":35,"value":159},{"type":16,"tag":60,"props":302,"children":303},{"class":62,"line":162},[304],{"type":16,"tag":60,"props":305,"children":306},{"emptyLinePlaceholder":129},[307],{"type":35,"value":132},{"type":16,"tag":60,"props":309,"children":310},{"class":62,"line":171},[311],{"type":16,"tag":60,"props":312,"children":313},{},[314],{"type":35,"value":315},"PORT   STATE SERVICE VERSION\n",{"type":16,"tag":60,"props":317,"children":318},{"class":62,"line":180},[319],{"type":16,"tag":60,"props":320,"children":321},{},[322],{"type":35,"value":323},"21/tcp open  ftp     vsftpd 3.0.3\n",{"type":16,"tag":60,"props":325,"children":326},{"class":62,"line":189},[327],{"type":16,"tag":60,"props":328,"children":329},{},[330],{"type":35,"value":331},"22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n",{"type":16,"tag":60,"props":333,"children":334},{"class":62,"line":198},[335],{"type":16,"tag":60,"props":336,"children":337},{},[338],{"type":35,"value":339},"| ssh-hostkey:\n",{"type":16,"tag":60,"props":341,"children":343},{"class":62,"line":342},11,[344],{"type":16,"tag":60,"props":345,"children":346},{},[347],{"type":35,"value":348},"|   2048 ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 (RSA)\n",{"type":16,"tag":60,"props":350,"children":352},{"class":62,"line":351},12,[353],{"type":16,"tag":60,"props":354,"children":355},{},[356],{"type":35,"value":357},"|   256 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea (ECDSA)\n",{"type":16,"tag":60,"props":359,"children":361},{"class":62,"line":360},13,[362],{"type":16,"tag":60,"props":363,"children":364},{},[365],{"type":35,"value":366},"|_  256 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 (ED25519)\n",{"type":16,"tag":60,"props":368,"children":370},{"class":62,"line":369},14,[371],{"type":16,"tag":60,"props":372,"children":373},{},[374],{"type":35,"value":375},"80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n",{"type":16,"tag":60,"props":377,"children":379},{"class":62,"line":378},15,[380],{"type":16,"tag":60,"props":381,"children":382},{},[383],{"type":35,"value":384},"|_http-title: Annoucement\n",{"type":16,"tag":60,"props":386,"children":388},{"class":62,"line":387},16,[389],{"type":16,"tag":60,"props":390,"children":391},{},[392],{"type":35,"value":393},"|_http-server-header: Apache/2.4.29 (Ubuntu)\n",{"type":16,"tag":60,"props":395,"children":397},{"class":62,"line":396},17,[398],{"type":16,"tag":60,"props":399,"children":400},{},[401],{"type":35,"value":402},"Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n",{"type":16,"tag":404,"props":405,"children":406},"blockquote",{},[407],{"type":16,"tag":24,"props":408,"children":409},{},[410],{"type":35,"value":411},"Para agilizar el proceso de escaneo y enumeraci√≥n, primero encontramos puertos abiertos y luego los escaneamos en busca de banners, versiones y otra informaci√≥n util.",{"type":16,"tag":37,"props":413,"children":415},{"id":414},"enumeraci√≥n-de-servicios",[416],{"type":35,"value":417},"Enumeraci√≥n de servicios",{"type":16,"tag":419,"props":420,"children":422},"h3",{"id":421},"tcp21",[423],{"type":35,"value":424},"TCP/21",{"type":16,"tag":24,"props":426,"children":427},{},[428],{"type":35,"value":429},"No es posible realizar un inicio de sesi√≥n an√≥nimo en el servicio FTP. Por lo que tendremos que revisitar este puerto mas adelante.",{"type":16,"tag":419,"props":431,"children":433},{"id":432},"tcp80",[434],{"type":35,"value":435},"TCP/80",{"type":16,"tag":24,"props":437,"children":438},{},[439],{"type":35,"value":440},"Se nos da la bienvenida con un mensaje cr√≠ptico.",{"type":16,"tag":24,"props":442,"children":443},{},[444],{"type":16,"tag":17,"props":445,"children":448},{"alt":446,"src":447},"image-1","/writeups/tryhackme-agent-sudo/image-1.png",[],{"type":16,"tag":24,"props":450,"children":451},{},[452],{"type":35,"value":453},"\"user-agent\" se refiere a la cabecera HTTP \"User-Agent\", por lo que debemos de cambiarla para poder acceder. ¬øPero que \"c√≥digo nombre\" debemos utilizar? Puesto que el mensaje fue firmado por Agent R, podemos intuir que nuestro c√≥digo nombre corresponde a alguna de las letras del abecedario.",{"type":16,"tag":24,"props":455,"children":456},{},[457,459,465],{"type":35,"value":458},"Creamos una lista de palabras con todas las letras del abecedario en may√∫scula haciendo uso de ",{"type":16,"tag":460,"props":461,"children":462},"strong",{},[463],{"type":35,"value":464},"TTPassGen",{"type":35,"value":466},".",{"type":16,"tag":49,"props":468,"children":470},{"className":51,"code":469,"language":53,"meta":8,"style":8},"ttpassgen -r \"[?u]{1:1}\" wordlist.txt\n",[471],{"type":16,"tag":56,"props":472,"children":473},{"__ignoreMap":8},[474],{"type":16,"tag":60,"props":475,"children":476},{"class":62,"line":63},[477,482,487,492],{"type":16,"tag":60,"props":478,"children":479},{"style":67},[480],{"type":35,"value":481},"ttpassgen",{"type":16,"tag":60,"props":483,"children":484},{"style":79},[485],{"type":35,"value":486}," -r",{"type":16,"tag":60,"props":488,"children":489},{"style":73},[490],{"type":35,"value":491}," \"[?u]{1:1}\"",{"type":16,"tag":60,"props":493,"children":494},{"style":73},[495],{"type":35,"value":496}," wordlist.txt\n",{"type":16,"tag":49,"props":498,"children":501},{"className":110,"code":499,"filename":500,"language":35,"meta":8,"style":8},"A\nB\nC\n\u003CSNIP>\nY\nZ\n","wordlist.txt",[502],{"type":16,"tag":56,"props":503,"children":504},{"__ignoreMap":8},[505,513,521,529,537,545],{"type":16,"tag":60,"props":506,"children":507},{"class":62,"line":63},[508],{"type":16,"tag":60,"props":509,"children":510},{},[511],{"type":35,"value":512},"A\n",{"type":16,"tag":60,"props":514,"children":515},{"class":62,"line":125},[516],{"type":16,"tag":60,"props":517,"children":518},{},[519],{"type":35,"value":520},"B\n",{"type":16,"tag":60,"props":522,"children":523},{"class":62,"line":135},[524],{"type":16,"tag":60,"props":525,"children":526},{},[527],{"type":35,"value":528},"C\n",{"type":16,"tag":60,"props":530,"children":531},{"class":62,"line":144},[532],{"type":16,"tag":60,"props":533,"children":534},{},[535],{"type":35,"value":536},"\u003CSNIP>\n",{"type":16,"tag":60,"props":538,"children":539},{"class":62,"line":153},[540],{"type":16,"tag":60,"props":541,"children":542},{},[543],{"type":35,"value":544},"Y\n",{"type":16,"tag":60,"props":546,"children":547},{"class":62,"line":162},[548],{"type":16,"tag":60,"props":549,"children":550},{},[551],{"type":35,"value":552},"Z\n",{"type":16,"tag":24,"props":554,"children":555},{},[556,558,563],{"type":35,"value":557},"Enviamos solicitudes con ",{"type":16,"tag":460,"props":559,"children":560},{},[561],{"type":35,"value":562},"ffuf",{"type":35,"value":564},". Puesto que la lista de palabras es corta, y no sabemos exactamente que esperar de una respuesta adecuada, podemos optar por no filtrar las respuestas y examinarlas manualmente. Sin embargo, tambi√©n podemos suponer que una respuesta adecuada contendr√° un c√≥digo de respuesta diferente a 200 o tendr√° un tama√±o diferente al usual (218 bytes).",{"type":16,"tag":24,"props":566,"children":567},{},[568],{"type":35,"value":569},"Para prop√≥sitos educativos, elegiremos seguir las redirecciones y filtrar las respuestas basadas en su tama√±o.",{"type":16,"tag":49,"props":571,"children":573},{"className":51,"code":572,"language":53,"meta":8,"style":8},"ffuf -u http://10.10.195.209 -H \"User-Agent: FUZZ\" -w wordlist.txt -c -r -fs 218\n",[574],{"type":16,"tag":56,"props":575,"children":576},{"__ignoreMap":8},[577],{"type":16,"tag":60,"props":578,"children":579},{"class":62,"line":63},[580,584,589,594,599,604,609,614,619,623,628],{"type":16,"tag":60,"props":581,"children":582},{"style":67},[583],{"type":35,"value":562},{"type":16,"tag":60,"props":585,"children":586},{"style":79},[587],{"type":35,"value":588}," -u",{"type":16,"tag":60,"props":590,"children":591},{"style":73},[592],{"type":35,"value":593}," http://10.10.195.209",{"type":16,"tag":60,"props":595,"children":596},{"style":79},[597],{"type":35,"value":598}," -H",{"type":16,"tag":60,"props":600,"children":601},{"style":73},[602],{"type":35,"value":603}," \"User-Agent: FUZZ\"",{"type":16,"tag":60,"props":605,"children":606},{"style":79},[607],{"type":35,"value":608}," -w",{"type":16,"tag":60,"props":610,"children":611},{"style":73},[612],{"type":35,"value":613}," wordlist.txt",{"type":16,"tag":60,"props":615,"children":616},{"style":79},[617],{"type":35,"value":618}," -c",{"type":16,"tag":60,"props":620,"children":621},{"style":79},[622],{"type":35,"value":486},{"type":16,"tag":60,"props":624,"children":625},{"style":79},[626],{"type":35,"value":627}," -fs",{"type":16,"tag":60,"props":629,"children":630},{"style":79},[631],{"type":35,"value":632}," 218\n",{"type":16,"tag":404,"props":634,"children":635},{},[636],{"type":16,"tag":24,"props":637,"children":638},{},[639],{"type":35,"value":640},"¬øFiltrar por c√≥digo de respuesta o por tama√±o? Filtrar por c√≥digo de respuesta nos puede llevar a omitir respuestas no est√°ndares, por lo que seguiremos la redirecciones y filtraremos por tama√±o de respuesta.",{"type":16,"tag":49,"props":642,"children":644},{"className":110,"code":643,"language":35,"meta":8,"style":8},"ffuf -u http://10.10.195.209 -H \"User-Agent: FUZZ\" -w wordlist.txt -c -r -fs 218\n\n\u003CSNIP>\nR                       [Status: 200, Size: 310, Words: 31, Lines: 19, Duration: 267ms]\nC                       [Status: 200, Size: 177, Words: 27, Lines: 8, Duration: 267ms]\n",[645],{"type":16,"tag":56,"props":646,"children":647},{"__ignoreMap":8},[648,655,662,669,677],{"type":16,"tag":60,"props":649,"children":650},{"class":62,"line":63},[651],{"type":16,"tag":60,"props":652,"children":653},{},[654],{"type":35,"value":572},{"type":16,"tag":60,"props":656,"children":657},{"class":62,"line":125},[658],{"type":16,"tag":60,"props":659,"children":660},{"emptyLinePlaceholder":129},[661],{"type":35,"value":132},{"type":16,"tag":60,"props":663,"children":664},{"class":62,"line":135},[665],{"type":16,"tag":60,"props":666,"children":667},{},[668],{"type":35,"value":536},{"type":16,"tag":60,"props":670,"children":671},{"class":62,"line":144},[672],{"type":16,"tag":60,"props":673,"children":674},{},[675],{"type":35,"value":676},"R                       [Status: 200, Size: 310, Words: 31, Lines: 19, Duration: 267ms]\n",{"type":16,"tag":60,"props":678,"children":679},{"class":62,"line":153},[680],{"type":16,"tag":60,"props":681,"children":682},{},[683],{"type":35,"value":684},"C                       [Status: 200, Size: 177, Words: 27, Lines: 8, Duration: 267ms]\n",{"type":16,"tag":404,"props":686,"children":687},{},[688],{"type":16,"tag":24,"props":689,"children":690},{},[691],{"type":35,"value":692},"La letra C originalmente nos redirige a otra pagina, mientras que la letra R nos muestra otro mensaje. Si hubi√©ramos filtrado todas las respuestas con c√≥digo 200, hubi√©ramos omitido esta ultima respuesta.",{"type":16,"tag":24,"props":694,"children":695},{},[696],{"type":35,"value":697},"Al enviar una petici√≥n con el User-Agent \"R\", obtenemos una respuesta ligeramente diferente a la original (pero sin importancia). La letra \"C\" nos revela una respuesta completamente diferente.",{"type":16,"tag":49,"props":699,"children":701},{"className":51,"code":700,"language":53,"meta":8,"style":8},"curl -sL -H \"User-Agent: C\" http://10.10.195.209/\n",[702],{"type":16,"tag":56,"props":703,"children":704},{"__ignoreMap":8},[705],{"type":16,"tag":60,"props":706,"children":707},{"class":62,"line":63},[708,713,718,722,727],{"type":16,"tag":60,"props":709,"children":710},{"style":67},[711],{"type":35,"value":712},"curl",{"type":16,"tag":60,"props":714,"children":715},{"style":79},[716],{"type":35,"value":717}," -sL",{"type":16,"tag":60,"props":719,"children":720},{"style":79},[721],{"type":35,"value":598},{"type":16,"tag":60,"props":723,"children":724},{"style":73},[725],{"type":35,"value":726}," \"User-Agent: C\"",{"type":16,"tag":60,"props":728,"children":729},{"style":73},[730],{"type":35,"value":731}," http://10.10.195.209/\n",{"type":16,"tag":49,"props":733,"children":735},{"className":110,"code":734,"language":35,"meta":8,"style":8},"curl -sL -H \"User-Agent: C\" http://10.10.195.209/\n\nAttention chris, \u003Cbr>\u003Cbr>\n\nDo you still remember our deal? Please tell agent J about the stuff ASAP. Also, change your god damn password, is weak! \u003Cbr>\u003Cbr>\n\nFrom,\u003Cbr>\nAgent R\n",[736],{"type":16,"tag":56,"props":737,"children":738},{"__ignoreMap":8},[739,746,753,761,768,776,783,791],{"type":16,"tag":60,"props":740,"children":741},{"class":62,"line":63},[742],{"type":16,"tag":60,"props":743,"children":744},{},[745],{"type":35,"value":700},{"type":16,"tag":60,"props":747,"children":748},{"class":62,"line":125},[749],{"type":16,"tag":60,"props":750,"children":751},{"emptyLinePlaceholder":129},[752],{"type":35,"value":132},{"type":16,"tag":60,"props":754,"children":755},{"class":62,"line":135},[756],{"type":16,"tag":60,"props":757,"children":758},{},[759],{"type":35,"value":760},"Attention chris, \u003Cbr>\u003Cbr>\n",{"type":16,"tag":60,"props":762,"children":763},{"class":62,"line":144},[764],{"type":16,"tag":60,"props":765,"children":766},{"emptyLinePlaceholder":129},[767],{"type":35,"value":132},{"type":16,"tag":60,"props":769,"children":770},{"class":62,"line":153},[771],{"type":16,"tag":60,"props":772,"children":773},{},[774],{"type":35,"value":775},"Do you still remember our deal? Please tell agent J about the stuff ASAP. Also, change your god damn password, is weak! \u003Cbr>\u003Cbr>\n",{"type":16,"tag":60,"props":777,"children":778},{"class":62,"line":162},[779],{"type":16,"tag":60,"props":780,"children":781},{"emptyLinePlaceholder":129},[782],{"type":35,"value":132},{"type":16,"tag":60,"props":784,"children":785},{"class":62,"line":171},[786],{"type":16,"tag":60,"props":787,"children":788},{},[789],{"type":35,"value":790},"From,\u003Cbr>\n",{"type":16,"tag":60,"props":792,"children":793},{"class":62,"line":180},[794],{"type":16,"tag":60,"props":795,"children":796},{},[797],{"type":35,"value":798},"Agent R\n",{"type":16,"tag":24,"props":800,"children":801},{},[802],{"type":35,"value":803},"Descubrimos el nombre de usuario \"chris\" y que su contrase√±a es d√©bil.",{"type":16,"tag":24,"props":805,"children":806},{},[807],{"type":35,"value":808},"Si intentamos enumerar directorios y paginas web, tales como formularios de inicio de sesi√≥n, no obtendremos resultados.",{"type":16,"tag":37,"props":810,"children":812},{"id":811},"explotaci√≥n",[813],{"type":35,"value":814},"Explotaci√≥n",{"type":16,"tag":419,"props":816,"children":818},{"id":817},"ssh",[819],{"type":35,"value":820},"SSH",{"type":16,"tag":24,"props":822,"children":823},{},[824,826,831],{"type":35,"value":825},"Al no encontrar un vector de explotaci√≥n evidente, usaremos ",{"type":16,"tag":460,"props":827,"children":828},{},[829],{"type":35,"value":830},"hydra",{"type":35,"value":832}," para obtener la contrase√±a del servicio SSH mediante fuerza bruta.",{"type":16,"tag":24,"props":834,"children":835},{},[836],{"type":35,"value":837},"Iniciar sesi√≥n en este servicio corresponde al camino hacia el √©xito mas directo, por tanto tiene sentido probar un ataque de fuerza bruta primero con este servicio. Pero en un entorno real este servicio estar√° fuertemente protegido y monitorizado, por lo que deber√≠amos de probar en otros lugares primero.",{"type":16,"tag":24,"props":839,"children":840},{},[841],{"type":35,"value":842},"Finalmente, este ataque falla en obtener una contrase√±a valida en un intervalo de tiempo aceptable.",{"type":16,"tag":404,"props":844,"children":845},{},[846],{"type":16,"tag":24,"props":847,"children":848},{},[849],{"type":35,"value":850},"Nunca debes realizar un ataque de fuerza bruta, a menos que sea el √∫nico camino disponible o hayan grandes indicios de que este es el camino correcto.",{"type":16,"tag":419,"props":852,"children":854},{"id":853},"ftp",[855],{"type":35,"value":856},"FTP",{"type":16,"tag":24,"props":858,"children":859},{},[860],{"type":35,"value":861},"Al fallar el anterior ataque, esta vez lo intentaremos en el servicio FTP.",{"type":16,"tag":404,"props":863,"children":864},{},[865],{"type":16,"tag":24,"props":866,"children":867},{},[868],{"type":35,"value":869},"Si hay indicios de que una contrase√±a es d√©bil, vale la pena usar listas de palabras conocidas como rockyou.txt (Solo en CTFs).",{"type":16,"tag":49,"props":871,"children":873},{"className":51,"code":872,"language":53,"meta":8,"style":8},"hydra -l \"chris\" -P /usr/share/wordlists/rockyou.txt -f -vV 10.10.195.209 ftp\n",[874],{"type":16,"tag":56,"props":875,"children":876},{"__ignoreMap":8},[877],{"type":16,"tag":60,"props":878,"children":879},{"class":62,"line":63},[880,884,889,894,899,904,909,914,918],{"type":16,"tag":60,"props":881,"children":882},{"style":67},[883],{"type":35,"value":830},{"type":16,"tag":60,"props":885,"children":886},{"style":79},[887],{"type":35,"value":888}," -l",{"type":16,"tag":60,"props":890,"children":891},{"style":73},[892],{"type":35,"value":893}," \"chris\"",{"type":16,"tag":60,"props":895,"children":896},{"style":79},[897],{"type":35,"value":898}," -P",{"type":16,"tag":60,"props":900,"children":901},{"style":73},[902],{"type":35,"value":903}," /usr/share/wordlists/rockyou.txt",{"type":16,"tag":60,"props":905,"children":906},{"style":79},[907],{"type":35,"value":908}," -f",{"type":16,"tag":60,"props":910,"children":911},{"style":79},[912],{"type":35,"value":913}," -vV",{"type":16,"tag":60,"props":915,"children":916},{"style":79},[917],{"type":35,"value":97},{"type":16,"tag":60,"props":919,"children":920},{"style":73},[921],{"type":35,"value":922}," ftp\n",{"type":16,"tag":49,"props":924,"children":926},{"className":110,"code":925,"language":35,"meta":8,"style":8},"hydra -l \"chris\" -P /usr/share/wordlists/rockyou.txt -f -vV 10.10.195.209 ftp\n\n\u003CSNIP>\n[ATTEMPT] target 10.10.195.209 - login \"chris\" - pass \"freedom\" - 256 of 14344399 [child 9] (0/0)\n[21][ftp] host: 10.10.195.209   login: chris   password: crystal\n[STATUS] attack finished for 10.10.195.209 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-05-30 20:05:43\n",[927],{"type":16,"tag":56,"props":928,"children":929},{"__ignoreMap":8},[930,937,944,951,959,967,975,983],{"type":16,"tag":60,"props":931,"children":932},{"class":62,"line":63},[933],{"type":16,"tag":60,"props":934,"children":935},{},[936],{"type":35,"value":872},{"type":16,"tag":60,"props":938,"children":939},{"class":62,"line":125},[940],{"type":16,"tag":60,"props":941,"children":942},{"emptyLinePlaceholder":129},[943],{"type":35,"value":132},{"type":16,"tag":60,"props":945,"children":946},{"class":62,"line":135},[947],{"type":16,"tag":60,"props":948,"children":949},{},[950],{"type":35,"value":536},{"type":16,"tag":60,"props":952,"children":953},{"class":62,"line":144},[954],{"type":16,"tag":60,"props":955,"children":956},{},[957],{"type":35,"value":958},"[ATTEMPT] target 10.10.195.209 - login \"chris\" - pass \"freedom\" - 256 of 14344399 [child 9] (0/0)\n",{"type":16,"tag":60,"props":960,"children":961},{"class":62,"line":153},[962],{"type":16,"tag":60,"props":963,"children":964},{},[965],{"type":35,"value":966},"[21][ftp] host: 10.10.195.209   login: chris   password: crystal\n",{"type":16,"tag":60,"props":968,"children":969},{"class":62,"line":162},[970],{"type":16,"tag":60,"props":971,"children":972},{},[973],{"type":35,"value":974},"[STATUS] attack finished for 10.10.195.209 (valid pair found)\n",{"type":16,"tag":60,"props":976,"children":977},{"class":62,"line":171},[978],{"type":16,"tag":60,"props":979,"children":980},{},[981],{"type":35,"value":982},"1 of 1 target successfully completed, 1 valid password found\n",{"type":16,"tag":60,"props":984,"children":985},{"class":62,"line":180},[986],{"type":16,"tag":60,"props":987,"children":988},{},[989],{"type":35,"value":990},"Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-05-30 20:05:43\n",{"type":16,"tag":24,"props":992,"children":993},{},[994],{"type":35,"value":995},"Ingresamos al servidor FTP con las anteriores credenciales y listamos los archivos.",{"type":16,"tag":49,"props":997,"children":999},{"className":110,"code":998,"language":35,"meta":8,"style":8},"ftp> ls\n229 Entering Extended Passive Mode (|||6987|)\n150 Here comes the directory listing.\n-rw-r--r--    1 0        0             217 Oct 29  2019 To_agentJ.txt\n-rw-r--r--    1 0        0           33143 Oct 29  2019 cute-alien.jpg\n-rw-r--r--    1 0        0           34842 Oct 29  2019 cutie.png\n226 Directory send OK.\n",[1000],{"type":16,"tag":56,"props":1001,"children":1002},{"__ignoreMap":8},[1003,1011,1019,1027,1035,1043,1051],{"type":16,"tag":60,"props":1004,"children":1005},{"class":62,"line":63},[1006],{"type":16,"tag":60,"props":1007,"children":1008},{},[1009],{"type":35,"value":1010},"ftp> ls\n",{"type":16,"tag":60,"props":1012,"children":1013},{"class":62,"line":125},[1014],{"type":16,"tag":60,"props":1015,"children":1016},{},[1017],{"type":35,"value":1018},"229 Entering Extended Passive Mode (|||6987|)\n",{"type":16,"tag":60,"props":1020,"children":1021},{"class":62,"line":135},[1022],{"type":16,"tag":60,"props":1023,"children":1024},{},[1025],{"type":35,"value":1026},"150 Here comes the directory listing.\n",{"type":16,"tag":60,"props":1028,"children":1029},{"class":62,"line":144},[1030],{"type":16,"tag":60,"props":1031,"children":1032},{},[1033],{"type":35,"value":1034},"-rw-r--r--    1 0        0             217 Oct 29  2019 To_agentJ.txt\n",{"type":16,"tag":60,"props":1036,"children":1037},{"class":62,"line":153},[1038],{"type":16,"tag":60,"props":1039,"children":1040},{},[1041],{"type":35,"value":1042},"-rw-r--r--    1 0        0           33143 Oct 29  2019 cute-alien.jpg\n",{"type":16,"tag":60,"props":1044,"children":1045},{"class":62,"line":162},[1046],{"type":16,"tag":60,"props":1047,"children":1048},{},[1049],{"type":35,"value":1050},"-rw-r--r--    1 0        0           34842 Oct 29  2019 cutie.png\n",{"type":16,"tag":60,"props":1052,"children":1053},{"class":62,"line":171},[1054],{"type":16,"tag":60,"props":1055,"children":1056},{},[1057],{"type":35,"value":1058},"226 Directory send OK.\n",{"type":16,"tag":24,"props":1060,"children":1061},{},[1062],{"type":35,"value":1063},"Descargamos los archivos de forma recursiva.",{"type":16,"tag":49,"props":1065,"children":1067},{"className":110,"code":1066,"language":35,"meta":8,"style":8},"ftp> prompt\nInteractive mode off.\nftp> mget .\nlocal: To_agentJ.txt remote: To_agentJ.txt\n\u003CSNIP>\nlocal: cute-alien.jpg remote: cute-alien.jpg\n\u003CSNIP>\nlocal: cutie.png remote: cutie.png\n\u003CSNIP>\n",[1068],{"type":16,"tag":56,"props":1069,"children":1070},{"__ignoreMap":8},[1071,1079,1087,1095,1103,1110,1118,1125,1133],{"type":16,"tag":60,"props":1072,"children":1073},{"class":62,"line":63},[1074],{"type":16,"tag":60,"props":1075,"children":1076},{},[1077],{"type":35,"value":1078},"ftp> prompt\n",{"type":16,"tag":60,"props":1080,"children":1081},{"class":62,"line":125},[1082],{"type":16,"tag":60,"props":1083,"children":1084},{},[1085],{"type":35,"value":1086},"Interactive mode off.\n",{"type":16,"tag":60,"props":1088,"children":1089},{"class":62,"line":135},[1090],{"type":16,"tag":60,"props":1091,"children":1092},{},[1093],{"type":35,"value":1094},"ftp> mget .\n",{"type":16,"tag":60,"props":1096,"children":1097},{"class":62,"line":144},[1098],{"type":16,"tag":60,"props":1099,"children":1100},{},[1101],{"type":35,"value":1102},"local: To_agentJ.txt remote: To_agentJ.txt\n",{"type":16,"tag":60,"props":1104,"children":1105},{"class":62,"line":153},[1106],{"type":16,"tag":60,"props":1107,"children":1108},{},[1109],{"type":35,"value":536},{"type":16,"tag":60,"props":1111,"children":1112},{"class":62,"line":162},[1113],{"type":16,"tag":60,"props":1114,"children":1115},{},[1116],{"type":35,"value":1117},"local: cute-alien.jpg remote: cute-alien.jpg\n",{"type":16,"tag":60,"props":1119,"children":1120},{"class":62,"line":171},[1121],{"type":16,"tag":60,"props":1122,"children":1123},{},[1124],{"type":35,"value":536},{"type":16,"tag":60,"props":1126,"children":1127},{"class":62,"line":180},[1128],{"type":16,"tag":60,"props":1129,"children":1130},{},[1131],{"type":35,"value":1132},"local: cutie.png remote: cutie.png\n",{"type":16,"tag":60,"props":1134,"children":1135},{"class":62,"line":189},[1136],{"type":16,"tag":60,"props":1137,"children":1138},{},[1139],{"type":35,"value":536},{"type":16,"tag":404,"props":1141,"children":1142},{},[1143],{"type":16,"tag":24,"props":1144,"children":1145},{},[1146],{"type":35,"value":1147},"Usamos el comando \"promt\" para evitar tener que confirmar manualmente la descarga de cada archivo.",{"type":16,"tag":24,"props":1149,"children":1150},{},[1151],{"type":35,"value":1152},"A simple vista, no hay nada fuera de lo usual en las im√°genes descargadas. El archivo de texto contiene el siguiente mensaje.",{"type":16,"tag":49,"props":1154,"children":1157},{"className":110,"code":1155,"filename":1156,"language":35,"meta":8,"style":8},"Dear agent J,\n\nAll these alien like photos are fake! Agent R stored the real picture inside your directory. Your login password is somehow stored in the fake picture. It shouldn't be a problem for you.\n\nFrom,\nAgent C\n","To_agentJ.txt",[1158],{"type":16,"tag":56,"props":1159,"children":1160},{"__ignoreMap":8},[1161,1169,1176,1184,1191,1199],{"type":16,"tag":60,"props":1162,"children":1163},{"class":62,"line":63},[1164],{"type":16,"tag":60,"props":1165,"children":1166},{},[1167],{"type":35,"value":1168},"Dear agent J,\n",{"type":16,"tag":60,"props":1170,"children":1171},{"class":62,"line":125},[1172],{"type":16,"tag":60,"props":1173,"children":1174},{"emptyLinePlaceholder":129},[1175],{"type":35,"value":132},{"type":16,"tag":60,"props":1177,"children":1178},{"class":62,"line":135},[1179],{"type":16,"tag":60,"props":1180,"children":1181},{},[1182],{"type":35,"value":1183},"All these alien like photos are fake! Agent R stored the real picture inside your directory. Your login password is somehow stored in the fake picture. It shouldn't be a problem for you.\n",{"type":16,"tag":60,"props":1185,"children":1186},{"class":62,"line":144},[1187],{"type":16,"tag":60,"props":1188,"children":1189},{"emptyLinePlaceholder":129},[1190],{"type":35,"value":132},{"type":16,"tag":60,"props":1192,"children":1193},{"class":62,"line":153},[1194],{"type":16,"tag":60,"props":1195,"children":1196},{},[1197],{"type":35,"value":1198},"From,\n",{"type":16,"tag":60,"props":1200,"children":1201},{"class":62,"line":162},[1202],{"type":16,"tag":60,"props":1203,"children":1204},{},[1205],{"type":35,"value":1206},"Agent C\n",{"type":16,"tag":419,"props":1208,"children":1210},{"id":1209},"esteganograf√≠a",[1211],{"type":35,"value":1212},"Esteganograf√≠a",{"type":16,"tag":24,"props":1214,"children":1215},{},[1216,1218,1224,1226,1231,1232,1237,1239,1244],{"type":35,"value":1217},"Una de las im√°genes contiene la contrase√±a de Agent R. Debemos realizar estegoan√°lisis en busca de un mensaje escondido. Podemos realizar este proceso con muchas herramientas, pero en CTFs usualmente podremos obtener informaci√≥n oculta haciendo uso de ",{"type":16,"tag":1219,"props":1220,"children":1221},"em",{},[1222],{"type":35,"value":1223},"exiftool",{"type":35,"value":1225},", ",{"type":16,"tag":1219,"props":1227,"children":1228},{},[1229],{"type":35,"value":1230},"strings",{"type":35,"value":1225},{"type":16,"tag":1219,"props":1233,"children":1234},{},[1235],{"type":35,"value":1236},"binwalk",{"type":35,"value":1238}," y ",{"type":16,"tag":1219,"props":1240,"children":1241},{},[1242],{"type":35,"value":1243},"steghide",{"type":35,"value":1245}," (No esperes hacer uso de estas herramientas en pruebas de penetraci√≥n reales).",{"type":16,"tag":24,"props":1247,"children":1248},{},[1249,1253,1255,1259],{"type":16,"tag":1219,"props":1250,"children":1251},{},[1252],{"type":35,"value":1223},{"type":35,"value":1254}," no revela nada importante, pero ",{"type":16,"tag":460,"props":1256,"children":1257},{},[1258],{"type":35,"value":1230},{"type":35,"value":1260}," si lo hace.",{"type":16,"tag":49,"props":1262,"children":1264},{"className":51,"code":1263,"language":53,"meta":8,"style":8},"strings cutie.png | head -n 20 && echo \".....\" && strings cutie.png | tail -n 20\n",[1265],{"type":16,"tag":56,"props":1266,"children":1267},{"__ignoreMap":8},[1268],{"type":16,"tag":60,"props":1269,"children":1270},{"class":62,"line":63},[1271,1275,1280,1286,1291,1295,1300,1306,1311,1316,1320,1324,1328,1332,1337,1341],{"type":16,"tag":60,"props":1272,"children":1273},{"style":67},[1274],{"type":35,"value":1230},{"type":16,"tag":60,"props":1276,"children":1277},{"style":73},[1278],{"type":35,"value":1279}," cutie.png",{"type":16,"tag":60,"props":1281,"children":1283},{"style":1282},"--shiki-default:#F97583",[1284],{"type":35,"value":1285}," |",{"type":16,"tag":60,"props":1287,"children":1288},{"style":67},[1289],{"type":35,"value":1290}," head",{"type":16,"tag":60,"props":1292,"children":1293},{"style":79},[1294],{"type":35,"value":82},{"type":16,"tag":60,"props":1296,"children":1297},{"style":79},[1298],{"type":35,"value":1299}," 20",{"type":16,"tag":60,"props":1301,"children":1303},{"style":1302},"--shiki-default:#E1E4E8",[1304],{"type":35,"value":1305}," && ",{"type":16,"tag":60,"props":1307,"children":1308},{"style":79},[1309],{"type":35,"value":1310},"echo",{"type":16,"tag":60,"props":1312,"children":1313},{"style":73},[1314],{"type":35,"value":1315}," \".....\"",{"type":16,"tag":60,"props":1317,"children":1318},{"style":1302},[1319],{"type":35,"value":1305},{"type":16,"tag":60,"props":1321,"children":1322},{"style":67},[1323],{"type":35,"value":1230},{"type":16,"tag":60,"props":1325,"children":1326},{"style":73},[1327],{"type":35,"value":1279},{"type":16,"tag":60,"props":1329,"children":1330},{"style":1282},[1331],{"type":35,"value":1285},{"type":16,"tag":60,"props":1333,"children":1334},{"style":67},[1335],{"type":35,"value":1336}," tail",{"type":16,"tag":60,"props":1338,"children":1339},{"style":79},[1340],{"type":35,"value":82},{"type":16,"tag":60,"props":1342,"children":1343},{"style":79},[1344],{"type":35,"value":1345}," 20\n",{"type":16,"tag":49,"props":1347,"children":1349},{"className":110,"code":1348,"language":35,"meta":8,"style":8},"strings cutie.png | head -n 20 && echo \".....\" && strings cutie.png | tail -n 20\n\n\u003CSNIP>\nTo_agentR.txt\nW\\_z#\n2a>=\nTo_agentR.txt\nEwwT\n",[1350],{"type":16,"tag":56,"props":1351,"children":1352},{"__ignoreMap":8},[1353,1360,1367,1374,1382,1390,1398,1405],{"type":16,"tag":60,"props":1354,"children":1355},{"class":62,"line":63},[1356],{"type":16,"tag":60,"props":1357,"children":1358},{},[1359],{"type":35,"value":1263},{"type":16,"tag":60,"props":1361,"children":1362},{"class":62,"line":125},[1363],{"type":16,"tag":60,"props":1364,"children":1365},{"emptyLinePlaceholder":129},[1366],{"type":35,"value":132},{"type":16,"tag":60,"props":1368,"children":1369},{"class":62,"line":135},[1370],{"type":16,"tag":60,"props":1371,"children":1372},{},[1373],{"type":35,"value":536},{"type":16,"tag":60,"props":1375,"children":1376},{"class":62,"line":144},[1377],{"type":16,"tag":60,"props":1378,"children":1379},{},[1380],{"type":35,"value":1381},"To_agentR.txt\n",{"type":16,"tag":60,"props":1383,"children":1384},{"class":62,"line":153},[1385],{"type":16,"tag":60,"props":1386,"children":1387},{},[1388],{"type":35,"value":1389},"W\\_z#\n",{"type":16,"tag":60,"props":1391,"children":1392},{"class":62,"line":162},[1393],{"type":16,"tag":60,"props":1394,"children":1395},{},[1396],{"type":35,"value":1397},"2a>=\n",{"type":16,"tag":60,"props":1399,"children":1400},{"class":62,"line":171},[1401],{"type":16,"tag":60,"props":1402,"children":1403},{},[1404],{"type":35,"value":1381},{"type":16,"tag":60,"props":1406,"children":1407},{"class":62,"line":180},[1408],{"type":16,"tag":60,"props":1409,"children":1410},{},[1411],{"type":35,"value":1412},"EwwT\n",{"type":16,"tag":24,"props":1414,"children":1415},{},[1416,1418,1422],{"type":35,"value":1417},"Descubrimos que la imagen contiene un archivo de texto oculto. Para extraerlo hacemos uso de ",{"type":16,"tag":460,"props":1419,"children":1420},{},[1421],{"type":35,"value":1236},{"type":35,"value":466},{"type":16,"tag":49,"props":1424,"children":1426},{"className":51,"code":1425,"language":53,"meta":8,"style":8},"binwalk -e cutie.png\n",[1427],{"type":16,"tag":56,"props":1428,"children":1429},{"__ignoreMap":8},[1430],{"type":16,"tag":60,"props":1431,"children":1432},{"class":62,"line":63},[1433,1437,1442],{"type":16,"tag":60,"props":1434,"children":1435},{"style":67},[1436],{"type":35,"value":1236},{"type":16,"tag":60,"props":1438,"children":1439},{"style":79},[1440],{"type":35,"value":1441}," -e",{"type":16,"tag":60,"props":1443,"children":1444},{"style":73},[1445],{"type":35,"value":1446}," cutie.png\n",{"type":16,"tag":49,"props":1448,"children":1450},{"className":110,"code":1449,"language":35,"meta":8,"style":8},"binwalk -e cutie.png\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n869           0x365           Zlib compressed data, best compression\n\nWARNING: Extractor.execute failed to run external extractor 'jar xvf '%e'': [Errno 2] No such file or directory: 'jar', 'jar xvf '%e'' might not be installed correctly\n34562         0x8702          Zip archive data, encrypted compressed size: 98, uncompressed size: 86, name: To_agentR.txt\n\nWARNING: One or more files failed to extract: either no utility was found or it's unimplemented\n",[1451],{"type":16,"tag":56,"props":1452,"children":1453},{"__ignoreMap":8},[1454,1461,1468,1476,1484,1492,1499,1507,1515,1522],{"type":16,"tag":60,"props":1455,"children":1456},{"class":62,"line":63},[1457],{"type":16,"tag":60,"props":1458,"children":1459},{},[1460],{"type":35,"value":1425},{"type":16,"tag":60,"props":1462,"children":1463},{"class":62,"line":125},[1464],{"type":16,"tag":60,"props":1465,"children":1466},{"emptyLinePlaceholder":129},[1467],{"type":35,"value":132},{"type":16,"tag":60,"props":1469,"children":1470},{"class":62,"line":135},[1471],{"type":16,"tag":60,"props":1472,"children":1473},{},[1474],{"type":35,"value":1475},"DECIMAL       HEXADECIMAL     DESCRIPTION\n",{"type":16,"tag":60,"props":1477,"children":1478},{"class":62,"line":144},[1479],{"type":16,"tag":60,"props":1480,"children":1481},{},[1482],{"type":35,"value":1483},"--------------------------------------------------------------------------------\n",{"type":16,"tag":60,"props":1485,"children":1486},{"class":62,"line":153},[1487],{"type":16,"tag":60,"props":1488,"children":1489},{},[1490],{"type":35,"value":1491},"869           0x365           Zlib compressed data, best compression\n",{"type":16,"tag":60,"props":1493,"children":1494},{"class":62,"line":162},[1495],{"type":16,"tag":60,"props":1496,"children":1497},{"emptyLinePlaceholder":129},[1498],{"type":35,"value":132},{"type":16,"tag":60,"props":1500,"children":1501},{"class":62,"line":171},[1502],{"type":16,"tag":60,"props":1503,"children":1504},{},[1505],{"type":35,"value":1506},"WARNING: Extractor.execute failed to run external extractor 'jar xvf '%e'': [Errno 2] No such file or directory: 'jar', 'jar xvf '%e'' might not be installed correctly\n",{"type":16,"tag":60,"props":1508,"children":1509},{"class":62,"line":180},[1510],{"type":16,"tag":60,"props":1511,"children":1512},{},[1513],{"type":35,"value":1514},"34562         0x8702          Zip archive data, encrypted compressed size: 98, uncompressed size: 86, name: To_agentR.txt\n",{"type":16,"tag":60,"props":1516,"children":1517},{"class":62,"line":189},[1518],{"type":16,"tag":60,"props":1519,"children":1520},{"emptyLinePlaceholder":129},[1521],{"type":35,"value":132},{"type":16,"tag":60,"props":1523,"children":1524},{"class":62,"line":198},[1525],{"type":16,"tag":60,"props":1526,"children":1527},{},[1528],{"type":35,"value":1529},"WARNING: One or more files failed to extract: either no utility was found or it's unimplemented\n",{"type":16,"tag":24,"props":1531,"children":1532},{},[1533,1535,1540,1542,1547],{"type":35,"value":1534},"Los archivos fueron extra√≠dos en una nueva carpeta. Dentro de esta encontramos un archivo zip, sin embargo ",{"type":16,"tag":1219,"props":1536,"children":1537},{},[1538],{"type":35,"value":1539},"unzip",{"type":35,"value":1541}," falla en extraer este archivo, por lo que debemos de usar ",{"type":16,"tag":460,"props":1543,"children":1544},{},[1545],{"type":35,"value":1546},"7zip",{"type":35,"value":466},{"type":16,"tag":49,"props":1549,"children":1551},{"className":51,"code":1550,"language":53,"meta":8,"style":8},"7zip x 8702.zip\n",[1552],{"type":16,"tag":56,"props":1553,"children":1554},{"__ignoreMap":8},[1555],{"type":16,"tag":60,"props":1556,"children":1557},{"class":62,"line":63},[1558,1562,1567],{"type":16,"tag":60,"props":1559,"children":1560},{"style":67},[1561],{"type":35,"value":1546},{"type":16,"tag":60,"props":1563,"children":1564},{"style":73},[1565],{"type":35,"value":1566}," x",{"type":16,"tag":60,"props":1568,"children":1569},{"style":73},[1570],{"type":35,"value":1571}," 8702.zip\n",{"type":16,"tag":419,"props":1573,"children":1575},{"id":1574},"crackeo-de-zip",[1576],{"type":35,"value":1577},"Crackeo de zip",{"type":16,"tag":24,"props":1579,"children":1580},{},[1581,1583,1588,1590,1595],{"type":35,"value":1582},"El archivo esta protegido por una contrase√±a. Para ",{"type":16,"tag":1219,"props":1584,"children":1585},{},[1586],{"type":35,"value":1587},"crackearla",{"type":35,"value":1589}," haremos uso de ",{"type":16,"tag":460,"props":1591,"children":1592},{},[1593],{"type":35,"value":1594},"zip2john",{"type":35,"value":466},{"type":16,"tag":49,"props":1597,"children":1599},{"className":51,"code":1598,"language":53,"meta":8,"style":8},"zip2john 8702.zip > zip2john.txt\n",[1600],{"type":16,"tag":56,"props":1601,"children":1602},{"__ignoreMap":8},[1603],{"type":16,"tag":60,"props":1604,"children":1605},{"class":62,"line":63},[1606,1610,1615,1620],{"type":16,"tag":60,"props":1607,"children":1608},{"style":67},[1609],{"type":35,"value":1594},{"type":16,"tag":60,"props":1611,"children":1612},{"style":73},[1613],{"type":35,"value":1614}," 8702.zip",{"type":16,"tag":60,"props":1616,"children":1617},{"style":1282},[1618],{"type":35,"value":1619}," >",{"type":16,"tag":60,"props":1621,"children":1622},{"style":73},[1623],{"type":35,"value":1624}," zip2john.txt\n",{"type":16,"tag":24,"props":1626,"children":1627},{},[1628,1633,1635,1640],{"type":16,"tag":1219,"props":1629,"children":1630},{},[1631],{"type":35,"value":1632},"Crackeamos",{"type":35,"value":1634}," la contrase√±a con ",{"type":16,"tag":460,"props":1636,"children":1637},{},[1638],{"type":35,"value":1639},"john",{"type":35,"value":466},{"type":16,"tag":49,"props":1642,"children":1644},{"className":51,"code":1643,"language":53,"meta":8,"style":8},"john --wordlist=/usr/share/wordlists/rockyou.txt zip2john.txt\n",[1645],{"type":16,"tag":56,"props":1646,"children":1647},{"__ignoreMap":8},[1648],{"type":16,"tag":60,"props":1649,"children":1650},{"class":62,"line":63},[1651,1655,1660],{"type":16,"tag":60,"props":1652,"children":1653},{"style":67},[1654],{"type":35,"value":1639},{"type":16,"tag":60,"props":1656,"children":1657},{"style":79},[1658],{"type":35,"value":1659}," --wordlist=/usr/share/wordlists/rockyou.txt",{"type":16,"tag":60,"props":1661,"children":1662},{"style":73},[1663],{"type":35,"value":1624},{"type":16,"tag":49,"props":1665,"children":1667},{"className":110,"code":1666,"language":35,"meta":8,"style":8},"john --wordlist=/usr/share/wordlists/rockyou.txt zip2john.txt\n\n\u003CSNIP>\nalien            (8702.zip/To_agentR.txt)\n1g 0:00:00:00 DONE (2025-05-30 19:47) 1.351g/s 44281p/s 44281c/s 44281C/s christal..eatme1\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed.\n",[1668],{"type":16,"tag":56,"props":1669,"children":1670},{"__ignoreMap":8},[1671,1678,1685,1692,1700,1708,1716],{"type":16,"tag":60,"props":1672,"children":1673},{"class":62,"line":63},[1674],{"type":16,"tag":60,"props":1675,"children":1676},{},[1677],{"type":35,"value":1643},{"type":16,"tag":60,"props":1679,"children":1680},{"class":62,"line":125},[1681],{"type":16,"tag":60,"props":1682,"children":1683},{"emptyLinePlaceholder":129},[1684],{"type":35,"value":132},{"type":16,"tag":60,"props":1686,"children":1687},{"class":62,"line":135},[1688],{"type":16,"tag":60,"props":1689,"children":1690},{},[1691],{"type":35,"value":536},{"type":16,"tag":60,"props":1693,"children":1694},{"class":62,"line":144},[1695],{"type":16,"tag":60,"props":1696,"children":1697},{},[1698],{"type":35,"value":1699},"alien            (8702.zip/To_agentR.txt)\n",{"type":16,"tag":60,"props":1701,"children":1702},{"class":62,"line":153},[1703],{"type":16,"tag":60,"props":1704,"children":1705},{},[1706],{"type":35,"value":1707},"1g 0:00:00:00 DONE (2025-05-30 19:47) 1.351g/s 44281p/s 44281c/s 44281C/s christal..eatme1\n",{"type":16,"tag":60,"props":1709,"children":1710},{"class":62,"line":162},[1711],{"type":16,"tag":60,"props":1712,"children":1713},{},[1714],{"type":35,"value":1715},"Use the \"--show\" option to display all of the cracked passwords reliably\n",{"type":16,"tag":60,"props":1717,"children":1718},{"class":62,"line":171},[1719],{"type":16,"tag":60,"props":1720,"children":1721},{},[1722],{"type":35,"value":1723},"Session completed.\n",{"type":16,"tag":24,"props":1725,"children":1726},{},[1727],{"type":35,"value":1728},"El archivo descomprimido contiene el siguiente mensaje.",{"type":16,"tag":49,"props":1730,"children":1733},{"className":110,"code":1731,"filename":1732,"language":35,"meta":8,"style":8},"Agent C,\n\nWe need to send the picture to 'QXJlYTUx' as soon as possible!\n\nBy,\nAgent R\n","_cutie.png.extracted/To_agentR.txt",[1734],{"type":16,"tag":56,"props":1735,"children":1736},{"__ignoreMap":8},[1737,1745,1752,1760,1767,1775],{"type":16,"tag":60,"props":1738,"children":1739},{"class":62,"line":63},[1740],{"type":16,"tag":60,"props":1741,"children":1742},{},[1743],{"type":35,"value":1744},"Agent C,\n",{"type":16,"tag":60,"props":1746,"children":1747},{"class":62,"line":125},[1748],{"type":16,"tag":60,"props":1749,"children":1750},{"emptyLinePlaceholder":129},[1751],{"type":35,"value":132},{"type":16,"tag":60,"props":1753,"children":1754},{"class":62,"line":135},[1755],{"type":16,"tag":60,"props":1756,"children":1757},{},[1758],{"type":35,"value":1759},"We need to send the picture to 'QXJlYTUx' as soon as possible!\n",{"type":16,"tag":60,"props":1761,"children":1762},{"class":62,"line":144},[1763],{"type":16,"tag":60,"props":1764,"children":1765},{"emptyLinePlaceholder":129},[1766],{"type":35,"value":132},{"type":16,"tag":60,"props":1768,"children":1769},{"class":62,"line":153},[1770],{"type":16,"tag":60,"props":1771,"children":1772},{},[1773],{"type":35,"value":1774},"By,\n",{"type":16,"tag":60,"props":1776,"children":1777},{"class":62,"line":162},[1778],{"type":16,"tag":60,"props":1779,"children":1780},{},[1781],{"type":35,"value":798},{"type":16,"tag":24,"props":1783,"children":1784},{},[1785,1787,1792],{"type":35,"value":1786},"Al principio esto no parece sernos de utilidad, pero la cadena de texto \"QXJlYTUx\" puede estar codificada. Ingresamos esta cadena de texto en ",{"type":16,"tag":460,"props":1788,"children":1789},{},[1790],{"type":35,"value":1791},"CyberChef",{"type":35,"value":1793},". La pagina autom√°ticamente reconoce que esta cadena de texto esta codificada en Base64. Al decodificarla obtenemos la frase \"Area51\".",{"type":16,"tag":24,"props":1795,"children":1796},{},[1797],{"type":35,"value":1798},"¬øObtuvimos la contrase√±a de SSH? Resulta no ser valida. Si esta imagen contiene un archivo escondido, probablemente la otra imagen tambi√©n.",{"type":16,"tag":24,"props":1800,"children":1801},{},[1802,1806,1808],{"type":16,"tag":460,"props":1803,"children":1804},{},[1805],{"type":35,"value":1230},{"type":35,"value":1807}," revela ",{"type":16,"tag":56,"props":1809,"children":1811},{"className":1810},[],[1812],{"type":35,"value":1813},"12345",{"type":16,"tag":37,"props":1815,"children":1817},{"id":1816},"escalada-de-privilegios",[1818],{"type":35,"value":1819},"Escalada de privilegios",{"type":16,"tag":24,"props":1821,"children":1822},{},[1823],{"type":35,"value":1824},"Descripci√≥n",{"type":16,"tag":37,"props":1826,"children":1828},{"id":1827},"persistencia",[1829],{"type":35,"value":1830},"Persistencia",{"type":16,"tag":24,"props":1832,"children":1833},{},[1834],{"type":35,"value":1824},{"type":16,"tag":37,"props":1836,"children":1838},{"id":1837},"post-root",[1839],{"type":35,"value":1840},"Post-Root",{"type":16,"tag":24,"props":1842,"children":1843},{},[1844],{"type":35,"value":1824},{"type":16,"tag":37,"props":1846,"children":1848},{"id":1847},"resumen-ejecutivo",[1849],{"type":35,"value":1850},"Resumen ejecutivo",{"type":16,"tag":24,"props":1852,"children":1853},{},[1854],{"type":35,"value":1824},{"type":16,"tag":37,"props":1856,"children":1858},{"id":1857},"remediaci√≥n",[1859],{"type":35,"value":1860},"Remediaci√≥n",{"type":16,"tag":1862,"props":1863,"children":1864},"ol",{},[1865],{"type":16,"tag":1866,"props":1867,"children":1868},"li",{},[1869],{"type":35,"value":1870},"Evita el uso de contrase√±as d√©biles.",{"type":16,"tag":37,"props":1872,"children":1874},{"id":1873},"conclusiones",[1875],{"type":35,"value":1876},"Conclusiones",{"type":16,"tag":24,"props":1878,"children":1879},{},[1880],{"type":35,"value":1824},{"type":16,"tag":1882,"props":1883,"children":1884},"style",{},[1885],{"type":35,"value":1886},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}",{"title":8,"searchDepth":125,"depth":125,"links":1888},[1889,1890,1894,1900,1901,1902,1903,1904,1905],{"id":39,"depth":125,"text":42},{"id":414,"depth":125,"text":417,"children":1891},[1892,1893],{"id":421,"depth":135,"text":424},{"id":432,"depth":135,"text":435},{"id":811,"depth":125,"text":814,"children":1895},[1896,1897,1898,1899],{"id":817,"depth":135,"text":820},{"id":853,"depth":135,"text":856},{"id":1209,"depth":135,"text":1212},{"id":1574,"depth":135,"text":1577},{"id":1816,"depth":125,"text":1819},{"id":1827,"depth":125,"text":1830},{"id":1837,"depth":125,"text":1840},{"id":1847,"depth":125,"text":1850},{"id":1857,"depth":125,"text":1860},{"id":1873,"depth":125,"text":1876},"markdown","content:writeups:tryhackme-agent-sudo.md","content","writeups/tryhackme-agent-sudo.md","writeups/tryhackme-agent-sudo","md",1748801181273]